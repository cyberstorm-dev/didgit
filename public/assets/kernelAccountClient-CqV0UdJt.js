import{Z as Ma,c as q,D as re,_ as $a,$ as Ua,n as N,x as j,p as M,a0 as Fa,m as Va,K as Y,j as $,G as be,H as ya,q as _a,i as Ft,I as Vt,a1 as I,a2 as ka,a3 as _t,a4 as Re,a5 as Ba,a6 as tt,a7 as Ha,M as ve,a8 as Ct,k as H,a9 as za,aa as ja,ab as X,g as Ge,ac as Ka,ad as Xa,ae as Wa,af as Ya,ag as qa,ah as Za,N as Qa,ai as kt,aj as Bt,ak as Ht,al as Ja,t as te,X as zt,am as en,an as tn,ao as an,ap as nn,r as rn,aq as sn,f as on,ar as pn,as as un,y as at,C as nt,z as oe,E as rt,at as yn,Y as ln,J as la,s as dn,au as cn,h as mn,l as fn,v as bn,L as gn}from"./index-BOkJ5mb5.js";import{f as hn,C as ge,V as z,O as Tn,d as jt,s as da,E as ca,a as ma,K as fa,g as En,h as vn}from"./constants-BdYsUssb.js";function wn(e){const{source:t}=e,a=new Map,n=new Ma(8192),r=new Map,p=({address:i,chainId:u})=>`${i}.${u}`;return{async consume({address:i,chainId:u,client:s}){const y=p({address:i,chainId:u}),o=this.get({address:i,chainId:u,client:s});this.increment({address:i,chainId:u});const m=await o;return await t.set({address:i,chainId:u},m),n.set(y,m),m},async increment({address:i,chainId:u}){const s=p({address:i,chainId:u}),y=a.get(s)??0;a.set(s,y+1)},async get({address:i,chainId:u,client:s}){const y=p({address:i,chainId:u});let o=r.get(y);return o||(o=(async()=>{try{const w=await t.get({address:i,chainId:u,client:s}),A=n.get(y)??0;return A>0&&w<=A?A+1:(n.delete(y),w)}finally{this.reset({address:i,chainId:u})}})(),r.set(y,o)),(a.get(y)??0)+await o},reset({address:i,chainId:u}){const s=p({address:i,chainId:u});a.delete(s),r.delete(s)}}}const In="0x6492649264926492649264926492649264926492649264926492649264926492";function Xe(e){const{address:t,data:a,signature:n,to:r="hex"}=e,p=q([re([{type:"address"},{type:"bytes"},{type:"bytes"}],[t,a,n]),In]);return r==="hex"?p:$a(p)}function xn(e){const{r:t,s:a}=Ua.Signature.fromCompact(e.slice(2,130)),n=+`0x${e.slice(130)}`,[r,p]=(()=>{if(n===0||n===1)return[void 0,n];if(n===27)return[BigInt(n),0];if(n===28)return[BigInt(n),1];throw new Error("Invalid yParityOrV value")})();return typeof r<"u"?{r:N(t,{size:32}),s:N(a,{size:32}),v:r,yParity:p}:{r:N(t,{size:32}),s:N(a,{size:32}),yParity:p}}function On(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ba={exports:{}},_=ba.exports={},J,ee;function st(){throw new Error("setTimeout has not been defined")}function it(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?J=setTimeout:J=st}catch{J=st}try{typeof clearTimeout=="function"?ee=clearTimeout:ee=it}catch{ee=it}})();function ga(e){if(J===setTimeout)return setTimeout(e,0);if((J===st||!J)&&setTimeout)return J=setTimeout,setTimeout(e,0);try{return J(e,0)}catch{try{return J.call(null,e,0)}catch{return J.call(this,e,0)}}}function Pn(e){if(ee===clearTimeout)return clearTimeout(e);if((ee===it||!ee)&&clearTimeout)return ee=clearTimeout,clearTimeout(e);try{return ee(e)}catch{try{return ee.call(null,e)}catch{return ee.call(this,e)}}}var ae=[],le=!1,ue,Le=-1;function An(){!le||!ue||(le=!1,ue.length?ae=ue.concat(ae):Le=-1,ae.length&&ha())}function ha(){if(!le){var e=ga(An);le=!0;for(var t=ae.length;t;){for(ue=ae,ae=[];++Le<t;)ue&&ue[Le].run();Le=-1,t=ae.length}ue=null,le=!1,Pn(e)}}_.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var a=1;a<arguments.length;a++)t[a-1]=arguments[a];ae.push(new Ta(e,t)),ae.length===1&&!le&&ga(ha)};function Ta(e,t){this.fun=e,this.array=t}Ta.prototype.run=function(){this.fun.apply(null,this.array)};_.title="browser";_.browser=!0;_.env={};_.argv=[];_.version="";_.versions={};function se(){}_.on=se;_.addListener=se;_.once=se;_.off=se;_.removeListener=se;_.removeAllListeners=se;_.emit=se;_.prependListener=se;_.prependOnceListener=se;_.listeners=function(e){return[]};_.binding=function(e){throw new Error("process.binding is not supported")};_.cwd=function(){return"/"};_.chdir=function(e){throw new Error("process.chdir is not supported")};_.umask=function(){return 0};var Dn=ba.exports;const Rn=On(Dn);var ot={exports:{}};const Ln="2.0.0",Ea=256,Gn=Number.MAX_SAFE_INTEGER||9007199254740991,Cn=16,Sn=Ea-6,Nn=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Be={MAX_LENGTH:Ea,MAX_SAFE_COMPONENT_LENGTH:Cn,MAX_SAFE_BUILD_LENGTH:Sn,MAX_SAFE_INTEGER:Gn,RELEASE_TYPES:Nn,SEMVER_SPEC_VERSION:Ln,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},We={};const Mn=typeof Rn=="object"&&We&&We.NODE_DEBUG&&/\bsemver\b/i.test(We.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var He=Mn;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:r}=Be,p=He;t=e.exports={};const i=t.re=[],u=t.safeRe=[],s=t.src=[],y=t.safeSrc=[],o=t.t={};let m=0;const w="[a-zA-Z0-9-]",A=[["\\s",1],["\\d",r],[w,n]],d=b=>{for(const[P,G]of A)b=b.split(`${P}*`).join(`${P}{0,${G}}`).split(`${P}+`).join(`${P}{1,${G}}`);return b},l=(b,P,G)=>{const R=d(P),F=m++;p(b,F,P),o[b]=F,s[F]=P,y[F]=R,i[F]=new RegExp(P,G?"g":void 0),u[F]=new RegExp(R,G?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","\\d+"),l("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${w}*`),l("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${s[o.NONNUMERICIDENTIFIER]}|${s[o.NUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NONNUMERICIDENTIFIER]}|${s[o.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER",`${w}+`),l("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),l("FULL",`^${s[o.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),l("LOOSE",`^${s[o.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),l("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),l("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),l("COERCE",`${s[o.COERCEPLAIN]}(?:$|[^\\d])`),l("COERCEFULL",s[o.COERCEPLAIN]+`(?:${s[o.PRERELEASE]})?(?:${s[o.BUILD]})?(?:$|[^\\d])`),l("COERCERTL",s[o.COERCE],!0),l("COERCERTLFULL",s[o.COERCEFULL],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ot,ot.exports);var we=ot.exports;const $n=Object.freeze({loose:!0}),Un=Object.freeze({}),Fn=e=>e?typeof e!="object"?$n:e:Un;var St=Fn;const Kt=/^[0-9]+$/,va=(e,t)=>{if(typeof e=="number"&&typeof t=="number")return e===t?0:e<t?-1:1;const a=Kt.test(e),n=Kt.test(t);return a&&n&&(e=+e,t=+t),e===t?0:a&&!n?-1:n&&!a?1:e<t?-1:1},Vn=(e,t)=>va(t,e);var wa={compareIdentifiers:va,rcompareIdentifiers:Vn};const xe=He,{MAX_LENGTH:Xt,MAX_SAFE_INTEGER:Oe}=Be,{safeRe:Pe,t:Ae}=we,_n=St,{compareIdentifiers:Ye}=wa;let kn=class Q{constructor(t,a){if(a=_n(a),t instanceof Q){if(t.loose===!!a.loose&&t.includePrerelease===!!a.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Xt)throw new TypeError(`version is longer than ${Xt} characters`);xe("SemVer",t,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const n=t.trim().match(a.loose?Pe[Ae.LOOSE]:Pe[Ae.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>Oe||this.major<0)throw new TypeError("Invalid major version");if(this.minor>Oe||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>Oe||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const p=+r;if(p>=0&&p<Oe)return p}return r}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(xe("SemVer.compare",this.version,this.options,t),!(t instanceof Q)){if(typeof t=="string"&&t===this.version)return 0;t=new Q(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Q||(t=new Q(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof Q||(t=new Q(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let a=0;do{const n=this.prerelease[a],r=t.prerelease[a];if(xe("prerelease compare",a,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Ye(n,r)}while(++a)}compareBuild(t){t instanceof Q||(t=new Q(t,this.options));let a=0;do{const n=this.build[a],r=t.build[a];if(xe("build compare",a,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return Ye(n,r)}while(++a)}inc(t,a,n){if(t.startsWith("pre")){if(!a&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(a){const r=`-${a}`.match(this.options.loose?Pe[Ae.PRERELEASELOOSE]:Pe[Ae.PRERELEASE]);if(!r||r[1]!==a)throw new Error(`invalid identifier: ${a}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",a,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",a,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",a,n),this.inc("pre",a,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",a,n),this.inc("pre",a,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const r=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[r];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(a===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(a){let p=[a,r];n===!1&&(p=[a]),Ye(this.prerelease[0],a)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var Nt=kn;const Wt=Nt,Bn=(e,t,a)=>new Wt(e,a).compare(new Wt(t,a));var he=Bn;const Hn=he,zn=(e,t,a)=>Hn(e,t,a)>0;var jn=zn;const Kn=he,Xn=(e,t,a)=>Kn(e,t,a)<0;var Wn=Xn;const Yn=he,qn=(e,t,a)=>Yn(e,t,a)===0;var Zn=qn;const Qn=he,Jn=(e,t,a)=>Qn(e,t,a)!==0;var er=Jn;const tr=he,ar=(e,t,a)=>tr(e,t,a)>=0;var nr=ar;const rr=he,sr=(e,t,a)=>rr(e,t,a)<=0;var ir=sr;const or=Zn,pr=er,ur=jn,yr=nr,lr=Wn,dr=ir,cr=(e,t,a,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof a=="object"&&(a=a.version),e===a;case"!==":return typeof e=="object"&&(e=e.version),typeof a=="object"&&(a=a.version),e!==a;case"":case"=":case"==":return or(e,a,n);case"!=":return pr(e,a,n);case">":return ur(e,a,n);case">=":return yr(e,a,n);case"<":return lr(e,a,n);case"<=":return dr(e,a,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var mr=cr;const{safeRe:Ts,t:Es}=we;class fr{constructor(){this.max=1e3,this.map=new Map}get(t){const a=this.map.get(t);if(a!==void 0)return this.map.delete(t),this.map.set(t,a),a}delete(t){return this.map.delete(t)}set(t,a){if(!this.delete(t)&&a!==void 0){if(this.map.size>=this.max){const r=this.map.keys().next().value;this.delete(r)}this.map.set(t,a)}return this}}var br=fr,qe,Yt;function Z(){if(Yt)return qe;Yt=1;const e=/\s+/g;class t{constructor(c,E){if(E=r(E),c instanceof t)return c.loose===!!E.loose&&c.includePrerelease===!!E.includePrerelease?c:new t(c.raw,E);if(c instanceof p)return this.raw=c.value,this.set=[[c]],this.formatted=void 0,this;if(this.options=E,this.loose=!!E.loose,this.includePrerelease=!!E.includePrerelease,this.raw=c.trim().replace(e," "),this.set=this.raw.split("||").map(g=>this.parseRange(g.trim())).filter(g=>g.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const g=this.set[0];if(this.set=this.set.filter(v=>!l(v[0])),this.set.length===0)this.set=[g];else if(this.set.length>1){for(const v of this.set)if(v.length===1&&b(v[0])){this.set=[v];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let c=0;c<this.set.length;c++){c>0&&(this.formatted+="||");const E=this.set[c];for(let g=0;g<E.length;g++)g>0&&(this.formatted+=" "),this.formatted+=E[g].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(c){const g=((this.options.includePrerelease&&A)|(this.options.loose&&d))+":"+c,v=n.get(g);if(v)return v;const h=this.options.loose,O=h?s[y.HYPHENRANGELOOSE]:s[y.HYPHENRANGE];c=c.replace(O,Ke(this.options.includePrerelease)),i("hyphen replace",c),c=c.replace(s[y.COMPARATORTRIM],o),i("comparator trim",c),c=c.replace(s[y.TILDETRIM],m),i("tilde trim",c),c=c.replace(s[y.CARETTRIM],w),i("caret trim",c);let C=c.split(" ").map(B=>G(B,this.options)).join(" ").split(/\s+/).map(B=>W(B,this.options));h&&(C=C.filter(B=>(i("loose invalid filter",B,this.options),!!B.match(s[y.COMPARATORLOOSE])))),i("range list",C);const D=new Map,U=C.map(B=>new p(B,this.options));for(const B of U){if(l(B))return[B];D.set(B.value,B)}D.size>1&&D.has("")&&D.delete("");const K=[...D.values()];return n.set(g,K),K}intersects(c,E){if(!(c instanceof t))throw new TypeError("a Range is required");return this.set.some(g=>P(g,E)&&c.set.some(v=>P(v,E)&&g.every(h=>v.every(O=>h.intersects(O,E)))))}test(c){if(!c)return!1;if(typeof c=="string")try{c=new u(c,this.options)}catch{return!1}for(let E=0;E<this.set.length;E++)if(Ie(this.set[E],c,this.options))return!0;return!1}}qe=t;const a=br,n=new a,r=St,p=ze(),i=He,u=Nt,{safeRe:s,t:y,comparatorTrimReplace:o,tildeTrimReplace:m,caretTrimReplace:w}=we,{FLAG_INCLUDE_PRERELEASE:A,FLAG_LOOSE:d}=Be,l=f=>f.value==="<0.0.0-0",b=f=>f.value==="",P=(f,c)=>{let E=!0;const g=f.slice();let v=g.pop();for(;E&&g.length;)E=g.every(h=>v.intersects(h,c)),v=g.pop();return E},G=(f,c)=>(f=f.replace(s[y.BUILD],""),i("comp",f,c),f=S(f,c),i("caret",f),f=F(f,c),i("tildes",f),f=k(f,c),i("xrange",f),f=L(f,c),i("stars",f),f),R=f=>!f||f.toLowerCase()==="x"||f==="*",F=(f,c)=>f.trim().split(/\s+/).map(E=>T(E,c)).join(" "),T=(f,c)=>{const E=c.loose?s[y.TILDELOOSE]:s[y.TILDE];return f.replace(E,(g,v,h,O,C)=>{i("tilde",f,g,v,h,O,C);let D;return R(v)?D="":R(h)?D=`>=${v}.0.0 <${+v+1}.0.0-0`:R(O)?D=`>=${v}.${h}.0 <${v}.${+h+1}.0-0`:C?(i("replaceTilde pr",C),D=`>=${v}.${h}.${O}-${C} <${v}.${+h+1}.0-0`):D=`>=${v}.${h}.${O} <${v}.${+h+1}.0-0`,i("tilde return",D),D})},S=(f,c)=>f.trim().split(/\s+/).map(E=>V(E,c)).join(" "),V=(f,c)=>{i("caret",f,c);const E=c.loose?s[y.CARETLOOSE]:s[y.CARET],g=c.includePrerelease?"-0":"";return f.replace(E,(v,h,O,C,D)=>{i("caret",f,v,h,O,C,D);let U;return R(h)?U="":R(O)?U=`>=${h}.0.0${g} <${+h+1}.0.0-0`:R(C)?h==="0"?U=`>=${h}.${O}.0${g} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.0${g} <${+h+1}.0.0-0`:D?(i("replaceCaret pr",D),h==="0"?O==="0"?U=`>=${h}.${O}.${C}-${D} <${h}.${O}.${+C+1}-0`:U=`>=${h}.${O}.${C}-${D} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.${C}-${D} <${+h+1}.0.0-0`):(i("no pr"),h==="0"?O==="0"?U=`>=${h}.${O}.${C}${g} <${h}.${O}.${+C+1}-0`:U=`>=${h}.${O}.${C}${g} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.${C} <${+h+1}.0.0-0`),i("caret return",U),U})},k=(f,c)=>(i("replaceXRanges",f,c),f.split(/\s+/).map(E=>x(E,c)).join(" ")),x=(f,c)=>{f=f.trim();const E=c.loose?s[y.XRANGELOOSE]:s[y.XRANGE];return f.replace(E,(g,v,h,O,C,D)=>{i("xRange",f,g,v,h,O,C,D);const U=R(h),K=U||R(O),B=K||R(C),Ee=B;return v==="="&&Ee&&(v=""),D=c.includePrerelease?"-0":"",U?v===">"||v==="<"?g="<0.0.0-0":g="*":v&&Ee?(K&&(O=0),C=0,v===">"?(v=">=",K?(h=+h+1,O=0,C=0):(O=+O+1,C=0)):v==="<="&&(v="<",K?h=+h+1:O=+O+1),v==="<"&&(D="-0"),g=`${v+h}.${O}.${C}${D}`):K?g=`>=${h}.0.0${D} <${+h+1}.0.0-0`:B&&(g=`>=${h}.${O}.0${D} <${h}.${+O+1}.0-0`),i("xRange return",g),g})},L=(f,c)=>(i("replaceStars",f,c),f.trim().replace(s[y.STAR],"")),W=(f,c)=>(i("replaceGTE0",f,c),f.trim().replace(s[c.includePrerelease?y.GTE0PRE:y.GTE0],"")),Ke=f=>(c,E,g,v,h,O,C,D,U,K,B,Ee)=>(R(g)?E="":R(v)?E=`>=${g}.0.0${f?"-0":""}`:R(h)?E=`>=${g}.${v}.0${f?"-0":""}`:O?E=`>=${E}`:E=`>=${E}${f?"-0":""}`,R(U)?D="":R(K)?D=`<${+U+1}.0.0-0`:R(B)?D=`<${U}.${+K+1}.0-0`:Ee?D=`<=${U}.${K}.${B}-${Ee}`:f?D=`<${U}.${K}.${+B+1}-0`:D=`<=${D}`,`${E} ${D}`.trim()),Ie=(f,c,E)=>{for(let g=0;g<f.length;g++)if(!f[g].test(c))return!1;if(c.prerelease.length&&!E.includePrerelease){for(let g=0;g<f.length;g++)if(i(f[g].semver),f[g].semver!==p.ANY&&f[g].semver.prerelease.length>0){const v=f[g].semver;if(v.major===c.major&&v.minor===c.minor&&v.patch===c.patch)return!0}return!1}return!0};return qe}var Ze,qt;function ze(){if(qt)return Ze;qt=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(o,m){if(m=a(m),o instanceof t){if(o.loose===!!m.loose)return o;o=o.value}o=o.trim().split(/\s+/).join(" "),i("comparator",o,m),this.options=m,this.loose=!!m.loose,this.parse(o),this.semver===e?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(o){const m=this.options.loose?n[r.COMPARATORLOOSE]:n[r.COMPARATOR],w=o.match(m);if(!w)throw new TypeError(`Invalid comparator: ${o}`);this.operator=w[1]!==void 0?w[1]:"",this.operator==="="&&(this.operator=""),w[2]?this.semver=new u(w[2],this.options.loose):this.semver=e}toString(){return this.value}test(o){if(i("Comparator.test",o,this.options.loose),this.semver===e||o===e)return!0;if(typeof o=="string")try{o=new u(o,this.options)}catch{return!1}return p(o,this.operator,this.semver,this.options)}intersects(o,m){if(!(o instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new s(o.value,m).test(this.value):o.operator===""?o.value===""?!0:new s(this.value,m).test(o.semver):(m=a(m),m.includePrerelease&&(this.value==="<0.0.0-0"||o.value==="<0.0.0-0")||!m.includePrerelease&&(this.value.startsWith("<0.0.0")||o.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&o.operator.startsWith(">")||this.operator.startsWith("<")&&o.operator.startsWith("<")||this.semver.version===o.semver.version&&this.operator.includes("=")&&o.operator.includes("=")||p(this.semver,"<",o.semver,m)&&this.operator.startsWith(">")&&o.operator.startsWith("<")||p(this.semver,">",o.semver,m)&&this.operator.startsWith("<")&&o.operator.startsWith(">")))}}Ze=t;const a=St,{safeRe:n,t:r}=we,p=mr,i=He,u=Nt,s=Z();return Ze}const gr=Z(),hr=(e,t,a)=>{try{t=new gr(t,a)}catch{return!1}return t.test(e)};var Tr=hr;Z();Z();Z();Z();Z();const Er=ze(),{ANY:vs}=Er;Z();Z();Z();const Mt=ze(),{ANY:ws}=Mt;new Mt(">=0.0.0-0");new Mt(">=0.0.0");const Qe=we,Zt=Be,Qt=wa;ze();Z();const vr=Tr;var ce={satisfies:vr,re:Qe.re,src:Qe.src,tokens:Qe.t,SEMVER_SPEC_VERSION:Zt.SEMVER_SPEC_VERSION,RELEASE_TYPES:Zt.RELEASE_TYPES,compareIdentifiers:Qt.compareIdentifiers,rcompareIdentifiers:Qt.rcompareIdentifiers};const Is=[{inputs:[{name:"preOpGas",type:"uint256"},{name:"paid",type:"uint256"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"targetSuccess",type:"bool"},{name:"targetResult",type:"bytes"}],name:"ExecutionResult",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"}],name:"ValidationResult",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"},{components:[{name:"aggregator",type:"address"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"stakeInfo",type:"tuple"}],name:"aggregatorInfo",type:"tuple"}],name:"ValidationResultWithAggregation",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[],name:"SIG_VALIDATION_FAILED",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"},{name:"sender",type:"address"},{name:"paymasterAndData",type:"bytes"}],name:"_validateSenderAndPaymaster",outputs:[],stateMutability:"view",type:"function"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"op",type:"tuple"},{name:"target",type:"address"},{name:"targetCallData",type:"bytes"}],name:"simulateHandleOp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"simulateValidation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],xs=[{inputs:[{name:"success",type:"bool"},{name:"ret",type:"bytes"}],name:"DelegateAndRevert",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"},{name:"inner",type:"bytes"}],name:"FailedOpWithRevert",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"PostOpReverted",type:"error"},{inputs:[],name:"ReentrancyGuardReentrantCall",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"PostOpRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"}],name:"UserOperationPrefundTooLow",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"target",type:"address"},{name:"data",type:"bytes"}],name:"delegateAndRevert",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint256"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint256"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"paymasterVerificationGasLimit",type:"uint256"},{name:"paymasterPostOpGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];function Ia(e,t={}){const{forHash:a}=t,{authorization:n,factory:r,factoryData:p}=e;return a&&(r==="0x7702"||r==="0x7702000000000000000000000000000000000000")?n?j([n.address,p??"0x"]):"0x7702000000000000000000000000000000000000":r?j([r,p??"0x"]):"0x"}const Jt="0x22e325a297439656";function xa(e,t={}){const{callGasLimit:a,callData:n,maxPriorityFeePerGas:r,maxFeePerGas:p,paymaster:i,paymasterData:u,paymasterPostOpGasLimit:s,paymasterSignature:y,paymasterVerificationGasLimit:o,sender:m,signature:w="0x",verificationGasLimit:A}=e,d=j([M(N(A||0n),{size:16}),M(N(a||0n),{size:16})]),l=Ia(e,t),b=j([M(N(r||0n),{size:16}),M(N(p||0n),{size:16})]),P=e.nonce??0n,G=i?j([i,M(N(o||0n),{size:16}),M(N(s||0n),{size:16}),u||"0x",...y?t.forHash?[Jt]:[y,M(N(Fa(y)),{size:2}),Jt]:[]]):"0x",R=e.preVerificationGas??0n;return{accountGasLimits:d,callData:n,initCode:l,gasFees:b,nonce:P,paymasterAndData:G,preVerificationGas:R,sender:m,signature:w}}const wr={PackedUserOperation:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"}]};function Ir(e){const{chainId:t,entryPointAddress:a,userOperation:n}=e,r=xa(n,{forHash:!0});return{types:wr,primaryType:"PackedUserOperation",domain:{name:"ERC4337",version:"1",chainId:t,verifyingContract:a},message:r}}function Os(e){const{chainId:t,entryPointAddress:a,entryPointVersion:n}=e,r=e.userOperation,{authorization:p,callData:i="0x",callGasLimit:u,maxFeePerGas:s,maxPriorityFeePerGas:y,nonce:o,paymasterAndData:m="0x",preVerificationGas:w,sender:A,verificationGasLimit:d}=r;if(n==="0.8"||n==="0.9")return Va(Ir({chainId:t,entryPointAddress:a,userOperation:r}));const l=(()=>{var b,P;if(n==="0.6"){const G=(b=r.initCode)==null?void 0:b.slice(0,42),R=(P=r.initCode)==null?void 0:P.slice(42),F=Ia({authorization:p,factory:G,factoryData:R},{forHash:!0});return re([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[A,o,Y(F),Y(i),u,d,w,s,y,Y(m)])}if(n==="0.7"){const G=xa(r,{forHash:!0});return re([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"}],[G.sender,G.nonce,Y(G.initCode),Y(G.callData),G.accountGasLimits,G.preVerificationGas,G.gasFees,Y(G.paymasterAndData)])}throw new Error(`entryPointVersion "${n}" not supported.`)})();return Y(re([{type:"bytes32"},{type:"address"},{type:"uint256"}],[Y(l),a,BigInt(t)]))}async function Ps(e){const{extend:t,nonceKeyManager:a=wn({source:{get(){return Date.now()},set(){}}}),...n}=e;let r=!1;const p=await e.getAddress();return{...t,...n,address:p,async getFactoryArgs(){return"isDeployed"in this&&await this.isDeployed()?{factory:void 0,factoryData:void 0}:e.getFactoryArgs()},async getNonce(i){const u=(i==null?void 0:i.key)??BigInt(await a.consume({address:p,chainId:e.client.chain.id,client:e.client}));return e.getNonce?await e.getNonce({...i,key:u}):await be(e.client,{abi:ya(["function getNonce(address, uint192) pure returns (uint256)"]),address:e.entryPoint.address,functionName:"getNonce",args:[p,u]})},async isDeployed(){return r?!0:(r=!!await $(e.client,_a,"getCode")({address:p}),r)},...e.sign?{async sign(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.sign(i)]);return u&&s?Xe({address:u,data:s,signature:y}):y}}:{},async signMessage(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.signMessage(i)]);return u&&s&&u!=="0x7702"?Xe({address:u,data:s,signature:y}):y},async signTypedData(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.signTypedData(i)]);return u&&s&&u!=="0x7702"?Xe({address:u,data:s,signature:y}):y},type:"smart"}}function xr(e){if(typeof e=="string"){if(!Ft(e,{strict:!1}))throw new Vt({address:e});return{address:e,type:"json-rpc"}}if(!Ft(e.address,{strict:!1}))throw new Vt({address:e.address});return{address:e.address,nonceManager:e.nonceManager,sign:e.sign,signAuthorization:e.signAuthorization,signMessage:e.signMessage,signTransaction:e.signTransaction,signTypedData:e.signTypedData,source:"custom",type:"local"}}class pt extends I{constructor({cause:t}){super("Smart Account is not deployed.",{cause:t,metaMessages:["This could arise when:","- No `factory`/`factoryData` or `initCode` properties are provided for Smart Account deployment.","- An incorrect `sender` address is provided."],name:"AccountNotDeployedError"})}}Object.defineProperty(pt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa20/});class me extends I{constructor({cause:t,data:a,message:n}={}){var p;const r=(p=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:p.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=a}}Object.defineProperty(me,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32521});Object.defineProperty(me,"message",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class ut extends I{constructor({cause:t}){super("Failed to send funds to beneficiary.",{cause:t,name:"FailedToSendToBeneficiaryError"})}}Object.defineProperty(ut,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa91/});class yt extends I{constructor({cause:t}){super("Gas value overflowed.",{cause:t,metaMessages:["This could arise when:","- one of the gas values exceeded 2**120 (uint120)"].filter(Boolean),name:"GasValuesOverflowError"})}}Object.defineProperty(yt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa94/});class lt extends I{constructor({cause:t}){super("The `handleOps` function was called by the Bundler with a gas limit too low.",{cause:t,name:"HandleOpsOutOfGasError"})}}Object.defineProperty(lt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa95/});class dt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Failed to simulate deployment for Smart Account.",{cause:t,metaMessages:["This could arise when:","- Invalid `factory`/`factoryData` or `initCode` properties are present","- Smart Account deployment execution ran out of gas (low `verificationGasLimit` value)",`- Smart Account deployment execution reverted with an error
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeFailedError"})}}Object.defineProperty(dt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa13/});class ct extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Smart Account initialization implementation did not create an account.",{cause:t,metaMessages:["This could arise when:","- `factory`/`factoryData` or `initCode` properties are invalid",`- Smart Account initialization implementation is incorrect
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeMustCreateSenderError"})}}Object.defineProperty(ct,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa15/});class mt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r,sender:p}){super("Smart Account initialization implementation does not return the expected sender.",{cause:t,metaMessages:["This could arise when:",`Smart Account initialization implementation does not return a sender address
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`,p&&`sender: ${p}`].filter(Boolean),name:"InitCodeMustReturnSenderError"})}}Object.defineProperty(mt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa14/});class ft extends I{constructor({cause:t}){super("Smart Account does not have sufficient funds to execute the User Operation.",{cause:t,metaMessages:["This could arise when:","- the Smart Account does not have sufficient funds to cover the required prefund, or","- a Paymaster was not provided"].filter(Boolean),name:"InsufficientPrefundError"})}}Object.defineProperty(ft,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa21/});class bt extends I{constructor({cause:t}){super("Bundler attempted to call an invalid function on the EntryPoint.",{cause:t,name:"InternalCallOnlyError"})}}Object.defineProperty(bt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa92/});class gt extends I{constructor({cause:t}){super("Bundler used an invalid aggregator for handling aggregated User Operations.",{cause:t,name:"InvalidAggregatorError"})}}Object.defineProperty(gt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa96/});class ht extends I{constructor({cause:t,nonce:a}){super("Invalid Smart Account nonce used for User Operation.",{cause:t,metaMessages:[a&&`nonce: ${a}`].filter(Boolean),name:"InvalidAccountNonceError"})}}Object.defineProperty(ht,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa25/});class Tt extends I{constructor({cause:t}){super("Bundler has not set a beneficiary address.",{cause:t,name:"InvalidBeneficiaryError"})}}Object.defineProperty(Tt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa90/});class Ce extends I{constructor({cause:t}){super("Invalid fields set on User Operation.",{cause:t,name:"InvalidFieldsError"})}}Object.defineProperty(Ce,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Et extends I{constructor({cause:t,paymasterAndData:a}){super("Paymaster properties provided are invalid.",{cause:t,metaMessages:["This could arise when:","- the `paymasterAndData` property is of an incorrect length\n",a&&`paymasterAndData: ${a}`].filter(Boolean),name:"InvalidPaymasterAndDataError"})}}Object.defineProperty(Et,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa93/});class ye extends I{constructor({cause:t}){super("Paymaster deposit for the User Operation is too low.",{cause:t,metaMessages:["This could arise when:","- the Paymaster has deposited less than the expected amount via the `deposit` function"].filter(Boolean),name:"PaymasterDepositTooLowError"})}}Object.defineProperty(ye,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32508});Object.defineProperty(ye,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa31/});class vt extends I{constructor({cause:t}){super("The `validatePaymasterUserOp` function on the Paymaster reverted.",{cause:t,name:"PaymasterFunctionRevertedError"})}}Object.defineProperty(vt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa33/});class wt extends I{constructor({cause:t}){super("The Paymaster contract has not been deployed.",{cause:t,name:"PaymasterNotDeployedError"})}}Object.defineProperty(wt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa30/});class Se extends I{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterRateLimitError"})}}Object.defineProperty(Se,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32504});class Ne extends I{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterStakeTooLowError"})}}Object.defineProperty(Ne,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32505});class It extends I{constructor({cause:t}){super("Paymaster `postOp` function reverted.",{cause:t,name:"PaymasterPostOpFunctionRevertedError"})}}Object.defineProperty(It,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa50/});class xt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Smart Account has already been deployed.",{cause:t,metaMessages:["Remove the following properties and try again:",a&&"`factory`",n&&"`factoryData`",r&&"`initCode`"].filter(Boolean),name:"SenderAlreadyConstructedError"})}}Object.defineProperty(xt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa10/});class Me extends I{constructor({cause:t}){super("UserOperation rejected because account signature check failed (or paymaster signature, if the paymaster uses its data as signature).",{cause:t,name:"SignatureCheckFailedError"})}}Object.defineProperty(Me,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32507});class Ot extends I{constructor({cause:t}){super("The `validateUserOp` function on the Smart Account reverted.",{cause:t,name:"SmartAccountFunctionRevertedError"})}}Object.defineProperty(Ot,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa23/});class $e extends I{constructor({cause:t}){super("UserOperation rejected because account specified unsupported signature aggregator.",{cause:t,name:"UnsupportedSignatureAggregatorError"})}}Object.defineProperty($e,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32506});class Pt extends I{constructor({cause:t}){super("User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validateUserOp` on the Smart Account are not satisfied"].filter(Boolean),name:"UserOperationExpiredError"})}}Object.defineProperty(Pt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa22/});class At extends I{constructor({cause:t}){super("Paymaster for User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validatePaymasterUserOp` on the Paymaster are not satisfied"].filter(Boolean),name:"UserOperationPaymasterExpiredError"})}}Object.defineProperty(At,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa32/});class Dt extends I{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Smart Account"].filter(Boolean),name:"UserOperationSignatureError"})}}Object.defineProperty(Dt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa24/});class Rt extends I{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Paymaster"].filter(Boolean),name:"UserOperationPaymasterSignatureError"})}}Object.defineProperty(Rt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa34/});class Ue extends I{constructor({cause:t}){super("User Operation rejected by EntryPoint's `simulateValidation` during account creation or validation.",{cause:t,name:"UserOperationRejectedByEntryPointError"})}}Object.defineProperty(Ue,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32500});class Fe extends I{constructor({cause:t}){super("User Operation rejected by Paymaster's `validatePaymasterUserOp`.",{cause:t,name:"UserOperationRejectedByPaymasterError"})}}Object.defineProperty(Fe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32501});class Ve extends I{constructor({cause:t}){super("User Operation rejected with op code validation error.",{cause:t,name:"UserOperationRejectedByOpCodeError"})}}Object.defineProperty(Ve,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32502});class _e extends I{constructor({cause:t}){super("UserOperation out of time-range: either wallet or paymaster returned a time-range, and it is already expired (or will expire soon).",{cause:t,name:"UserOperationOutOfTimeRangeError"})}}Object.defineProperty(_e,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32503});class Or extends I{constructor({cause:t}){super(`An error occurred while executing user operation: ${t==null?void 0:t.shortMessage}`,{cause:t,name:"UnknownBundlerError"})}}class Lt extends I{constructor({cause:t}){super("User Operation verification gas limit exceeded.",{cause:t,metaMessages:["This could arise when:","- the gas used for verification exceeded the `verificationGasLimit`"].filter(Boolean),name:"VerificationGasLimitExceededError"})}}Object.defineProperty(Lt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa40/});class Gt extends I{constructor({cause:t}){super("User Operation verification gas limit is too low.",{cause:t,metaMessages:["This could arise when:","- the `verificationGasLimit` is too low to verify the User Operation"].filter(Boolean),name:"VerificationGasLimitTooLowError"})}}Object.defineProperty(Gt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa41/});class Pr extends I{constructor(t,{callData:a,callGasLimit:n,docsPath:r,factory:p,factoryData:i,initCode:u,maxFeePerGas:s,maxPriorityFeePerGas:y,nonce:o,paymaster:m,paymasterAndData:w,paymasterData:A,paymasterPostOpGasLimit:d,paymasterVerificationGasLimit:l,preVerificationGas:b,sender:P,signature:G,verificationGasLimit:R}){const F=ka({callData:a,callGasLimit:n,factory:p,factoryData:i,initCode:u,maxFeePerGas:typeof s<"u"&&`${_t(s)} gwei`,maxPriorityFeePerGas:typeof y<"u"&&`${_t(y)} gwei`,nonce:o,paymaster:m,paymasterAndData:w,paymasterData:A,paymasterPostOpGasLimit:d,paymasterVerificationGasLimit:l,preVerificationGas:b,sender:P,signature:G,verificationGasLimit:R});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",F].filter(Boolean),name:"UserOperationExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}class Ar extends I{constructor({hash:t}){super(`User Operation receipt with hash "${t}" could not be found. The User Operation may not have been processed yet.`,{name:"UserOperationReceiptNotFoundError"})}}class Dr extends I{constructor({hash:t}){super(`User Operation with hash "${t}" could not be found.`,{name:"UserOperationNotFoundError"})}}class ea extends I{constructor({hash:t}){super(`Timed out while waiting for User Operation with hash "${t}" to be confirmed.`,{name:"WaitForUserOperationReceiptTimeoutError"})}}const Rr=[me,Ce,ye,Se,Ne,Me,$e,_e,Ue,Fe,Ve];function Lr(e,t){const a=(e.details||"").toLowerCase();if(pt.message.test(a))return new pt({cause:e});if(ut.message.test(a))return new ut({cause:e});if(yt.message.test(a))return new yt({cause:e});if(lt.message.test(a))return new lt({cause:e});if(dt.message.test(a))return new dt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(ct.message.test(a))return new ct({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(mt.message.test(a))return new mt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode,sender:t.sender});if(ft.message.test(a))return new ft({cause:e});if(bt.message.test(a))return new bt({cause:e});if(ht.message.test(a))return new ht({cause:e,nonce:t.nonce});if(gt.message.test(a))return new gt({cause:e});if(Tt.message.test(a))return new Tt({cause:e});if(Et.message.test(a))return new Et({cause:e});if(ye.message.test(a))return new ye({cause:e});if(vt.message.test(a))return new vt({cause:e});if(wt.message.test(a))return new wt({cause:e});if(It.message.test(a))return new It({cause:e});if(Ot.message.test(a))return new Ot({cause:e});if(xt.message.test(a))return new xt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(Pt.message.test(a))return new Pt({cause:e});if(At.message.test(a))return new At({cause:e});if(Rt.message.test(a))return new Rt({cause:e});if(Dt.message.test(a))return new Dt({cause:e});if(Lt.message.test(a))return new Lt({cause:e});if(Gt.message.test(a))return new Gt({cause:e});const n=e.walk(r=>Rr.some(p=>p.code===r.code));if(n){if(n.code===me.code)return new me({cause:e,data:n.data,message:n.details});if(n.code===Ce.code)return new Ce({cause:e});if(n.code===ye.code)return new ye({cause:e});if(n.code===Se.code)return new Se({cause:e});if(n.code===Ne.code)return new Ne({cause:e});if(n.code===Me.code)return new Me({cause:e});if(n.code===$e.code)return new $e({cause:e});if(n.code===_e.code)return new _e({cause:e});if(n.code===Ue.code)return new Ue({cause:e});if(n.code===Fe.code)return new Fe({cause:e});if(n.code===Ve.code)return new Ve({cause:e})}return new Or({cause:e})}function Oa(e,{calls:t,docsPath:a,...n}){const r=(()=>{const p=Lr(e,n);if(t&&p instanceof me){const i=Gr(p),u=t==null?void 0:t.filter(s=>s.abi);if(i&&u.length>0)return Cr({calls:u,revertData:i})}return p})();return new Pr(r,{docsPath:a,...n})}function Gr(e){let t;return e.walk(a=>{var r,p,i,u;const n=a;if(typeof n.data=="string"||typeof((r=n.data)==null?void 0:r.revertData)=="string"||!(n instanceof I)&&typeof n.message=="string"){const s=(u=(i=((p=n.data)==null?void 0:p.revertData)||n.data||n.message).match)==null?void 0:u.call(i,/(0x[A-Za-z0-9]*)/);if(s)return t=s[1],!0}return!1}),t}function Cr(e){const{calls:t,revertData:a}=e,{abi:n,functionName:r,args:p,to:i}=(()=>{const s=t==null?void 0:t.filter(o=>!!o.abi);if(s.length===1)return s[0];const y=s.filter(o=>{try{return!!Re({abi:o.abi,data:a})}catch{return!1}});return y.length===1?y[0]:{abi:[],functionName:s.reduce((o,m)=>`${o?`${o} | `:""}${m.functionName}`,""),args:void 0,to:void 0}})(),u=a==="0x"?new Ba({functionName:r}):new tt({abi:n,data:a,functionName:r});return new Ha(u,{abi:n,args:p,contractAddress:i,functionName:r})}function Sr(e){const t={};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),t}function je(e){const t={};return typeof e.callData<"u"&&(t.callData=e.callData),typeof e.callGasLimit<"u"&&(t.callGasLimit=N(e.callGasLimit)),typeof e.factory<"u"&&(t.factory=e.factory),typeof e.factoryData<"u"&&(t.factoryData=e.factoryData),typeof e.initCode<"u"&&(t.initCode=e.initCode),typeof e.maxFeePerGas<"u"&&(t.maxFeePerGas=N(e.maxFeePerGas)),typeof e.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=N(e.maxPriorityFeePerGas)),typeof e.nonce<"u"&&(t.nonce=N(e.nonce)),typeof e.paymaster<"u"&&(t.paymaster=e.paymaster),typeof e.paymasterAndData<"u"&&(t.paymasterAndData=e.paymasterAndData||"0x"),typeof e.paymasterData<"u"&&(t.paymasterData=e.paymasterData),typeof e.paymasterPostOpGasLimit<"u"&&(t.paymasterPostOpGasLimit=N(e.paymasterPostOpGasLimit)),typeof e.paymasterSignature<"u"&&(t.paymasterSignature=e.paymasterSignature),typeof e.paymasterVerificationGasLimit<"u"&&(t.paymasterVerificationGasLimit=N(e.paymasterVerificationGasLimit)),typeof e.preVerificationGas<"u"&&(t.preVerificationGas=N(e.preVerificationGas)),typeof e.sender<"u"&&(t.sender=e.sender),typeof e.signature<"u"&&(t.signature=e.signature),typeof e.verificationGasLimit<"u"&&(t.verificationGasLimit=N(e.verificationGasLimit)),typeof e.authorization<"u"&&(t.eip7702Auth=Nr(e.authorization)),t}function Nr(e){return{address:e.address,chainId:N(e.chainId),nonce:N(e.nonce),r:e.r?N(BigInt(e.r),{size:32}):M("0x",{size:32}),s:e.s?N(BigInt(e.s),{size:32}):M("0x",{size:32}),yParity:e.yParity?N(e.yParity,{size:1}):M("0x",{size:32})}}async function Mr(e,t){const{chainId:a,entryPointAddress:n,context:r,...p}=t,i=je(p),{paymasterPostOpGasLimit:u,paymasterVerificationGasLimit:s,...y}=await e.request({method:"pm_getPaymasterData",params:[{...i,callGasLimit:i.callGasLimit??"0x0",verificationGasLimit:i.verificationGasLimit??"0x0",preVerificationGas:i.preVerificationGas??"0x0"},n,N(a),r]});return{...y,...u&&{paymasterPostOpGasLimit:ve(u)},...s&&{paymasterVerificationGasLimit:ve(s)}}}async function $r(e,t){const{chainId:a,entryPointAddress:n,context:r,...p}=t,i=je(p),{paymasterPostOpGasLimit:u,paymasterVerificationGasLimit:s,...y}=await e.request({method:"pm_getPaymasterStubData",params:[{...i,callGasLimit:i.callGasLimit??"0x0",verificationGasLimit:i.verificationGasLimit??"0x0",preVerificationGas:i.preVerificationGas??"0x0"},n,N(a),r]});return{...y,...u&&{paymasterPostOpGasLimit:ve(u)},...s&&{paymasterVerificationGasLimit:ve(s)}}}const Ur=["factory","fees","gas","paymaster","nonce","signature","authorization"];async function fe(e,t){var V,k;const a=t,{account:n=e.account,dataSuffix:r=typeof e.dataSuffix=="string"?e.dataSuffix:(V=e.dataSuffix)==null?void 0:V.value,parameters:p=Ur,stateOverride:i}=a;if(!n)throw new Ct;const u=X(n),s=e,y=a.paymaster??(s==null?void 0:s.paymaster),o=typeof y=="string"?y:void 0,{getPaymasterStubData:m,getPaymasterData:w}=(()=>{if(y===!0)return{getPaymasterStubData:x=>$(s,$r,"getPaymasterStubData")(x),getPaymasterData:x=>$(s,Mr,"getPaymasterData")(x)};if(typeof y=="object"){const{getPaymasterStubData:x,getPaymasterData:L}=y;return{getPaymasterStubData:L&&x?x:L,getPaymasterData:L&&x?L:void 0}}return{getPaymasterStubData:void 0,getPaymasterData:void 0}})(),A=a.paymasterContext?a.paymasterContext:s==null?void 0:s.paymasterContext;let d={...a,paymaster:o,sender:u.address};const[l,b,P,G,R]=await Promise.all([(async()=>a.calls?u.encodeCalls(a.calls.map(x=>{const L=x;return L.abi?{data:H(L),to:L.to,value:L.value}:L})):a.callData)(),(async()=>{if(!p.includes("factory"))return;if(a.initCode)return{initCode:a.initCode};if(a.factory&&a.factoryData)return{factory:a.factory,factoryData:a.factoryData};const{factory:x,factoryData:L}=await u.getFactoryArgs();return u.entryPoint.version==="0.6"?{initCode:x&&L?j([x,L]):void 0}:{factory:x,factoryData:L}})(),(async()=>{var x;if(p.includes("fees")){if(typeof a.maxFeePerGas=="bigint"&&typeof a.maxPriorityFeePerGas=="bigint")return d;if((x=s==null?void 0:s.userOperation)!=null&&x.estimateFeesPerGas){const L=await s.userOperation.estimateFeesPerGas({account:u,bundlerClient:s,userOperation:d});return{...d,...L}}try{const L=s.client??e,W=await $(L,za,"estimateFeesPerGas")({chain:L.chain,type:"eip1559"});return{maxFeePerGas:typeof a.maxFeePerGas=="bigint"?a.maxFeePerGas:BigInt(2n*W.maxFeePerGas),maxPriorityFeePerGas:typeof a.maxPriorityFeePerGas=="bigint"?a.maxPriorityFeePerGas:BigInt(2n*W.maxPriorityFeePerGas)}}catch{return}}})(),(async()=>{if(p.includes("nonce"))return typeof a.nonce=="bigint"?a.nonce:u.getNonce()})(),(async()=>{if(p.includes("authorization")){if(typeof a.authorization=="object")return a.authorization;if(u.authorization&&!await u.isDeployed())return{...await ja(u.client,u.authorization),r:"0xfffffffffffffffffffffffffffffff000000000000000000000000000000000",s:"0x7aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",yParity:1}}})()]);typeof l<"u"&&(d.callData=r?j([l,r]):l),typeof b<"u"&&(d={...d,...b}),typeof P<"u"&&(d={...d,...P}),typeof G<"u"&&(d.nonce=G),typeof R<"u"&&(d.authorization=R),p.includes("signature")&&(typeof a.signature<"u"?d.signature=a.signature:d.signature=await u.getStubSignature(d)),u.entryPoint.version==="0.6"&&!d.initCode&&(d.initCode="0x");let F;async function T(){return F||(e.chain?e.chain.id:(F=await $(e,Ge,"getChainId")({}),F))}let S=!1;if(p.includes("paymaster")&&m&&!o&&!a.paymasterAndData){const{isFinal:x=!1,sponsor:L,...W}=await m({chainId:await T(),entryPointAddress:u.entryPoint.address,context:A,...d});S=x,d={...d,...W}}if(u.entryPoint.version==="0.6"&&!d.paymasterAndData&&(d.paymasterAndData="0x"),p.includes("gas")){if((k=u.userOperation)!=null&&k.estimateGas){const x=await u.userOperation.estimateGas(d);d={...d,...x}}if(typeof d.callGasLimit>"u"||typeof d.preVerificationGas>"u"||typeof d.verificationGasLimit>"u"||d.paymaster&&typeof d.paymasterPostOpGasLimit>"u"||d.paymaster&&typeof d.paymasterVerificationGasLimit>"u"){const x=await $(s,Pa,"estimateUserOperationGas")({account:u,callGasLimit:0n,preVerificationGas:0n,verificationGasLimit:0n,stateOverride:i,...d.paymaster?{paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n}:{},...d});d={...d,callGasLimit:d.callGasLimit??x.callGasLimit,preVerificationGas:d.preVerificationGas??x.preVerificationGas,verificationGasLimit:d.verificationGasLimit??x.verificationGasLimit,paymasterPostOpGasLimit:d.paymasterPostOpGasLimit??x.paymasterPostOpGasLimit,paymasterVerificationGasLimit:d.paymasterVerificationGasLimit??x.paymasterVerificationGasLimit}}}if(p.includes("paymaster")&&w&&!o&&!a.paymasterAndData&&!S){const x=await w({chainId:await T(),entryPointAddress:u.entryPoint.address,context:A,...d});d={...d,...x}}return delete d.calls,delete d.parameters,delete d.paymasterContext,typeof d.paymaster!="string"&&delete d.paymaster,d}async function Pa(e,t){var s;const{account:a=e.account,entryPointAddress:n,stateOverride:r}=t;if(!a&&!t.sender)throw new Ct;const p=a?X(a):void 0,i=Ka(r),u=p?await $(e,fe,"prepareUserOperation")({...t,parameters:["authorization","factory","nonce","paymaster","signature"]}):t;try{const y=[je(u),n??((s=p==null?void 0:p.entryPoint)==null?void 0:s.address)],o=await e.request({method:"eth_estimateUserOperationGas",params:i?[...y,i]:[...y]});return Sr(o)}catch(y){const o=t.calls;throw Oa(y,{...u,...o?{calls:o}:{}})}}function Fr(e){return e.request({method:"eth_supportedEntryPoints"})}function Vr(e){const t={...e};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.maxFeePerGas&&(t.maxFeePerGas=BigInt(e.maxFeePerGas)),e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=BigInt(e.maxPriorityFeePerGas)),e.nonce&&(t.nonce=BigInt(e.nonce)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),t}async function _r(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationByHash",params:[t]},{dedupe:!0});if(!a)throw new Dr({hash:t});const{blockHash:n,blockNumber:r,entryPoint:p,transactionHash:i,userOperation:u}=a;return{blockHash:n,blockNumber:BigInt(r),entryPoint:p,transactionHash:i,userOperation:Vr(u)}}function kr(e){const t={...e};return e.actualGasCost&&(t.actualGasCost=BigInt(e.actualGasCost)),e.actualGasUsed&&(t.actualGasUsed=BigInt(e.actualGasUsed)),e.logs&&(t.logs=e.logs.map(a=>Xa(a))),e.receipt&&(t.receipt=Wa(t.receipt)),t}async function Aa(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationReceipt",params:[t]},{dedupe:!0});if(!a)throw new Ar({hash:t});return kr(a)}async function pe(e,t){var s,y;const{account:a=e.account,entryPointAddress:n}=t;if(!a&&!t.sender)throw new Ct;const r=a?X(a):void 0,p=r?await $(e,fe,"prepareUserOperation")(t):t,i=t.signature||await((s=r==null?void 0:r.signUserOperation)==null?void 0:s.call(r,p)),u=je({...p,signature:i});try{return await e.request({method:"eth_sendUserOperation",params:[u,n??((y=r==null?void 0:r.entryPoint)==null?void 0:y.address)]},{retryCount:0})}catch(o){const m=t.calls;throw Oa(o,{...p,...m?{calls:m}:{},signature:i})}}function Da(e,t){const{hash:a,pollingInterval:n=e.pollingInterval,retryCount:r,timeout:p=12e4}=t;let i=0;const u=Ya(["waitForUserOperationReceipt",e.uid,a]);return new Promise((s,y)=>{const o=qa(u,{resolve:s,reject:y},m=>{const w=l=>{d(),l(),o()},A=p?setTimeout(()=>w(()=>m.reject(new ea({hash:a}))),p):void 0,d=Za(async()=>{r&&i>=r&&(clearTimeout(A),w(()=>m.reject(new ea({hash:a}))));try{const l=await $(e,Aa,"getUserOperationReceipt")({hash:a});clearTimeout(A),w(()=>m.resolve(l))}catch(l){const b=l;b.name!=="UserOperationReceiptNotFoundError"&&(clearTimeout(A),w(()=>m.reject(b)))}i++},{emitOnBegin:!0,interval:n});return d})})}function De(e){return{estimateUserOperationGas:t=>Pa(e,t),getChainId:()=>Ge(e),getSupportedEntryPoints:()=>Fr(e),getUserOperation:t=>_r(e,t),getUserOperationReceipt:t=>Aa(e,t),prepareUserOperation:t=>fe(e,t),sendUserOperation:t=>pe(e,t),waitForUserOperationReceipt:t=>Da(e,t)}}const As=async(e,t)=>{const{address:a,entryPointAddress:n,key:r=BigInt(0)}=t;return await $(e,be,"readContract")({address:n,abi:[{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"}],functionName:"getNonce",args:[a,r]})};class Br extends I{constructor({cause:t,entryPointAddress:a}={}){super(`The entry point address (\`entryPoint\`${a?` = ${a}`:""}) is not a valid entry point. getSenderAddress did not revert with a SenderAddressResult error.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidEntryPointError"})}}const Ds=async(e,t)=>{var i,u,s,y,o,m,w,A;const{initCode:a,entryPointAddress:n,factory:r,factoryData:p}=t;if(!a&&!r&&!p)throw new Error("Either `initCode` or `factory` and `factoryData` must be provided");try{await $(e,Qa,"simulateContract")({address:n,abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"}],functionName:"getSenderAddress",args:[a||j([r,p])]})}catch(d){const l=d.walk(b=>b instanceof tt||b instanceof kt||b instanceof Bt||b instanceof Ht);if(!l){const b=d.cause;if((((i=b==null?void 0:b.data)==null?void 0:i.errorName)??"")==="SenderAddressResult"&&((u=b==null?void 0:b.data)!=null&&u.args)&&((s=b==null?void 0:b.data)!=null&&s.args[0]))return(y=b.data)==null?void 0:y.args[0]}if(l instanceof tt&&(((o=l.data)==null?void 0:o.errorName)??"")==="SenderAddressResult"&&(m=l.data)!=null&&m.args&&(w=l.data)!=null&&w.args[0])return(A=l.data)==null?void 0:A.args[0];if(l instanceof kt){const b=/0x[a-fA-F0-9]+/,P=l.cause.data.match(b);if(!P)throw new Error("Failed to parse revert bytes from RPC response");const G=P[0];return Re({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:G}).args[0]}if(l instanceof Bt){const{data:b}=d instanceof Ja?d:d instanceof I?d.walk(R=>"data"in R)||d.walk():{},P=typeof b=="string"?b:b==null?void 0:b.data;if(P===void 0)throw new Error("Failed to parse revert bytes from RPC response");return Re({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:P}).args[0]}if(l instanceof Ht){const P=JSON.parse(l.cause.body).error.data,G=/0x[a-fA-F0-9]+/,R=P.match(G);if(!R)throw new Error("Failed to parse revert bytes from RPC response");const F=R[0];return Re({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:F}).args[0]}throw d}throw new Br({entryPointAddress:n})},Hr=[{type:"function",name:"isInitialized",inputs:[{name:"smartAccount",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"}],zr=[{inputs:[{internalType:"uint256",name:"moduleType",type:"uint256"},{internalType:"address",name:"module",type:"address"},{internalType:"bytes",name:"initData",type:"bytes"}],stateMutability:"payable",type:"function",name:"installModule"}],jr=[{inputs:[{internalType:"uint256",name:"moduleType",type:"uint256"},{internalType:"address",name:"module",type:"address"},{internalType:"bytes",name:"additionalContext",type:"bytes"}],stateMutability:"view",type:"function",name:"isModuleInstalled",outputs:[{internalType:"bool",name:"",type:"bool"}]}],Rs=async(e,t)=>{const{address:a,plugin:n}=t,{type:r,address:p,data:i="0x"}=n;try{return await $(e,be,"readContract")({address:a,abi:jr,functionName:"isModuleInstalled",args:[BigInt(r),p,i]})}catch{return!1}};var ne;(function(e){e.ERC1271_SIG_WRAPPER="ERC1271_SIG_WRAPPER",e.ERC1271_WITH_VALIDATOR="ERC1271_WITH_VALIDATOR",e.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH="ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH",e.ERC1271_REPLAYABLE="ERC1271_REPLAYABLE"})(ne||(ne={}));const ta={[ne.ERC1271_SIG_WRAPPER]:">=0.2.3 || >=0.3.0-beta",[ne.ERC1271_WITH_VALIDATOR]:">=0.3.0-beta",[ne.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH]:">=0.3.0-beta",[ne.ERC1271_REPLAYABLE]:">=0.3.2"},Je=(e,t)=>e in ta?ce.satisfies(t,ta[e]):!1,Ls=async(e,{gasToken:t,approveAmount:a,entryPoint:n})=>{var p;const r=await e.request({method:"zd_pm_accounts",params:[{chainId:(p=e.chain)==null?void 0:p.id,entryPointAddress:n.address}]});return{to:t,data:H({abi:tn,functionName:"approve",args:[r[0],a]}),value:0n}},Gs=e=>{let t=e;if(!zt(t)&&(t=`0x${t}`,!zt(t)))throw new Error(`Invalid signed data ${e}`);let{r:a,s:n,v:r}=xn(t);return(r===0n||r===1n)&&(r+=27n),en({r:a,s:n,v:r})},aa=({callType:e,execType:t})=>q([e,t,"0x00000000","0x00000000",M("0x00000000",{size:22})]),Kr=(e,t)=>{if(e==="0.6"&&!ce.satisfies(t,">=0.2.2 || <=0.2.4")||e==="0.7"&&!ce.satisfies(t,">=0.3.0"))throw new Error("KernelVersion should be >= 0.2.2 and <= 0.2.4 for EntryPointV0.6 and >= 0.3.0 for EntryPointV0.7")},Cs=(e,t)=>ce.satisfies(e,t);function ke(e){if(typeof e!="function")return e==null||typeof e=="string"||typeof e=="boolean"?e:typeof e=="bigint"||typeof e=="number"?te(e):e._isBigNumber!=null||typeof e!="object"?te(e).replace(/^0x0/,"0x"):Array.isArray(e)?e.map(t=>ke(t)):Object.keys(e).reduce((t,a)=>(t[a]=ke(e[a]),t),{})}async function Ss({signer:e,address:t}){if("type"in e&&(e.type==="local"||e.type==="smart"))return e;let a;if("request"in e&&!(e!=null&&e.account)){if(t||(t=(await Promise.any([e.request({method:"eth_requestAccounts"}),e.request({method:"eth_accounts"})]))[0]),!t)throw new Error("address is required");a=an({account:t,transport:nn(e)})}return a||(a=e),xr({address:a.account.address,async signMessage({message:n}){return on(a,{message:n})},async signTypedData(n){const{primaryType:r,domain:p,message:i,types:u}=n;return sn(a,{primaryType:r,domain:p,message:i,types:u})},async signTransaction(n){throw new Error("Smart account signer doesn't need to sign transactions")},async signAuthorization(n){return rn(a,n)}})}const $t=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Operation",name:"",type:"uint8"}],name:"execute",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct Call[]",name:"calls",type:"tuple[]"}],name:"executeBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"executeDelegateCall",outputs:[],stateMutability:"payable",type:"function"}],Ns=[{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"}],Ra=[{inputs:[{internalType:"contract IEntryPoint",name:"_entryPoint",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyInitialized",type:"error"},{inputs:[],name:"DisabledMode",type:"error"},{inputs:[],name:"NotAuthorizedCaller",type:"error"},{inputs:[],name:"NotEntryPoint",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldValidator",type:"address"},{indexed:!0,internalType:"address",name:"newValidator",type:"address"}],name:"DefaultValidatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes4",name:"selector",type:"bytes4"},{indexed:!0,internalType:"address",name:"executor",type:"address"},{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"ExecutionChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Received",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newImplementation",type:"address"}],name:"Upgraded",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[{internalType:"bytes4",name:"_disableFlag",type:"bytes4"}],name:"disableMode",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"entryPoint",outputs:[{internalType:"contract IEntryPoint",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Operation",name:"",type:"uint8"}],name:"execute",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct Call[]",name:"calls",type:"tuple[]"}],name:"executeBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"executeDelegateCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"getDefaultValidator",outputs:[{internalType:"contract IKernelValidator",name:"validator",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDisabledMode",outputs:[{internalType:"bytes4",name:"disabled",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"_selector",type:"bytes4"}],name:"getExecution",outputs:[{components:[{internalType:"ValidAfter",name:"validAfter",type:"uint48"},{internalType:"ValidUntil",name:"validUntil",type:"uint48"},{internalType:"address",name:"executor",type:"address"},{internalType:"contract IKernelValidator",name:"validator",type:"address"}],internalType:"struct ExecutionDetail",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastDisabledTime",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint192",name:"key",type:"uint192"}],name:"getNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isValidSignature",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155BatchReceived",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"setDefaultValidator",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes4",name:"_selector",type:"bytes4"},{internalType:"address",name:"_executor",type:"address"},{internalType:"contract IKernelValidator",name:"_validator",type:"address"},{internalType:"ValidUntil",name:"_validUntil",type:"uint48"},{internalType:"ValidAfter",name:"_validAfter",type:"uint48"},{internalType:"bytes",name:"_enableData",type:"bytes"}],name:"setExecution",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_newImplementation",type:"address"}],name:"upgradeTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"callData",type:"bytes"},{internalType:"uint256",name:"callGasLimit",type:"uint256"},{internalType:"uint256",name:"verificationGasLimit",type:"uint256"},{internalType:"uint256",name:"preVerificationGas",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"bytes",name:"paymasterAndData",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct UserOperation",name:"_userOp",type:"tuple"},{internalType:"bytes32",name:"userOpHash",type:"bytes32"},{internalType:"uint256",name:"missingAccountFunds",type:"uint256"}],name:"validateUserOp",outputs:[{internalType:"ValidationData",name:"validationData",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Xr=e=>H({abi:$t,functionName:"executeBatch",args:[e.map(t=>({to:t.to,value:t.value||0n,data:t.data||"0x"}))]}),La=e=>H({abi:$t,functionName:"executeDelegateCall",args:[e.to,e.data||"0x"]}),Wr=e=>H({abi:$t,functionName:"execute",args:[e.to,e.value||0n,e.data||"0x",0]}),Yr=async(e,t)=>{if(e.length>1){if(t==="delegatecall")throw new Error("Cannot batch delegatecall");return Xr(e)}const a=e.length===0?void 0:e[0];if(!a)throw new Error("No calls to encode");if(!t||t==="call")return Wr(a);if(t==="delegatecall")return La({to:a.to,data:a.data});throw new Error("Invalid call type")},qr=async({accountAddress:e,enableData:t,executor:a,selector:n,validAfter:r,validUntil:p,validator:i})=>Yr([{to:e,value:0n,data:H({abi:Ra,functionName:"setExecution",args:[n,a,i,p,r,t]})}],"call");var de;(function(e){e.sudo="0x00000000",e.plugin="0x00000001",e.enable="0x00000002"})(de||(de={}));const Ms=[{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"}],et=[{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"}],Te=[{type:"constructor",inputs:[{name:"_entrypoint",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"nonpayable"},{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"accountId",inputs:[],outputs:[{name:"accountImplementationId",type:"string",internalType:"string"}],stateMutability:"pure"},{type:"function",name:"currentNonce",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"entrypoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"view"},{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executorConfig",inputs:[{name:"executor",type:"address",internalType:"contract IExecutor"}],outputs:[{name:"",type:"tuple",internalType:"struct ExecutorManager.ExecutorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"installModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"initData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"installValidations",inputs:[{name:"vIds",type:"bytes21[]",internalType:"ValidationId[]"},{name:"configs",type:"tuple[]",internalType:"struct ValidationManager.ValidationConfig[]",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]},{name:"validationData",type:"bytes[]",internalType:"bytes[]"},{name:"hookData",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"payable"},{type:"function",name:"invalidateNonce",inputs:[{name:"nonce",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"isAllowedSelector",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isModuleInstalled",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"additionalContext",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"permissionConfig",inputs:[{name:"pId",type:"bytes4",internalType:"PermissionId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.PermissionConfig",components:[{name:"permissionFlag",type:"bytes2",internalType:"PassFlag"},{name:"signer",type:"address",internalType:"contract ISigner"},{name:"policyData",type:"bytes22[]",internalType:"PolicyData[]"}]}],stateMutability:"view"},{type:"function",name:"rootValidator",inputs:[],outputs:[{name:"",type:"bytes21",internalType:"ValidationId"}],stateMutability:"view"},{type:"function",name:"selectorConfig",inputs:[{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"tuple",internalType:"struct SelectorManager.SelectorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"},{name:"target",type:"address",internalType:"address"},{name:"callType",type:"bytes1",internalType:"CallType"}]}],stateMutability:"view"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ExecMode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"supportsModule",inputs:[{name:"moduleTypeId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"uninstallModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"deInitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"uninstallValidation",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"deinitData",type:"bytes",internalType:"bytes"},{name:"hookDeinitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"upgradeTo",inputs:[{name:"_newImplementation",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"validNonceFrom",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"ValidationData"}],stateMutability:"payable"},{type:"function",name:"validationConfig",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.ValidationConfig",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"event",name:"ModuleInstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"ModuleUninstallResult",inputs:[{name:"module",type:"address",indexed:!1,internalType:"address"},{name:"result",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"ModuleUninstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"NonceInvalidated",inputs:[{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionInstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionUninstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"}],anonymous:!1},{type:"event",name:"Received",inputs:[{name:"sender",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"RootValidatorUpdated",inputs:[{name:"rootValidator",type:"bytes21",indexed:!1,internalType:"ValidationId"}],anonymous:!1},{type:"event",name:"SelectorSet",inputs:[{name:"selector",type:"bytes4",indexed:!1,internalType:"bytes4"},{name:"vId",type:"bytes21",indexed:!1,internalType:"ValidationId"},{name:"allowed",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"TryExecuteUnsuccessful",inputs:[{name:"batchExecutionindex",type:"uint256",indexed:!1,internalType:"uint256"},{name:"result",type:"bytes",indexed:!1,internalType:"bytes"}],anonymous:!1},{type:"event",name:"Upgraded",inputs:[{name:"implementation",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"ValidatorInstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"ValidatorUninstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"}],anonymous:!1},{type:"error",name:"EnableNotApproved",inputs:[]},{type:"error",name:"ExecutionReverted",inputs:[]},{type:"error",name:"InvalidCallType",inputs:[]},{type:"error",name:"InvalidCaller",inputs:[]},{type:"error",name:"InvalidExecutor",inputs:[]},{type:"error",name:"InvalidFallback",inputs:[]},{type:"error",name:"InvalidMode",inputs:[]},{type:"error",name:"InvalidModuleType",inputs:[]},{type:"error",name:"InvalidNonce",inputs:[]},{type:"error",name:"InvalidSelector",inputs:[]},{type:"error",name:"InvalidSignature",inputs:[]},{type:"error",name:"InvalidValidationType",inputs:[]},{type:"error",name:"InvalidValidator",inputs:[]},{type:"error",name:"NonceInvalidationError",inputs:[]},{type:"error",name:"NotSupportedCallType",inputs:[]},{type:"error",name:"OnlyExecuteUserOp",inputs:[]},{type:"error",name:"PermissionDataLengthMismatch",inputs:[]},{type:"error",name:"PermissionNotAlllowedForSignature",inputs:[]},{type:"error",name:"PermissionNotAlllowedForUserOp",inputs:[]},{type:"error",name:"PolicyDataTooLarge",inputs:[]},{type:"error",name:"PolicyFailed",inputs:[{name:"i",type:"uint256",internalType:"uint256"}]},{type:"error",name:"PolicySignatureOrderError",inputs:[]},{type:"error",name:"RootValidatorCannotBeRemoved",inputs:[]},{type:"error",name:"SignerPrefixNotPresent",inputs:[]}],na=async(e,t)=>{try{const a=await $(e,be,"readContract")({abi:Te,address:t,functionName:"currentNonce",args:[]});return a===0?1:a}catch{return 1}},ra=[{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"data",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"magicValue",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"}],sa=async(e,t,a,n)=>{try{const r=await e.request({method:"eth_call",params:[{to:t,data:H({abi:ra,functionName:"eip712Domain"})},"latest"]});if(r!=="0x"){const p=pn({abi:[...ra],functionName:"eip712Domain",data:r});return{name:p[1],version:p[2],chainId:p[3]}}}catch{}return{name:hn,version:a==="0.3.0"?"0.3.0-beta":a,chainId:BigInt(n??(e.chain?e.chain.id:await e.extend(un).getChainId()))}},ia=e=>{if(e==="0.6")return at(nt({abi:Ra,name:"execute"}));if(e==="0.7")return at(nt({abi:Te,name:"execute"}));throw new Error("Unsupported entry point version")},Zr=async({accountAddress:e,enableSignature:t,action:a,validator:n,validUntil:r,validAfter:p})=>{const i=await n.getEnableData(e),u=i.length/2-1;return j([de.enable,M(te(r,{size:6}),{size:6}),M(te(p),{size:6}),M(n.address,{size:20}),M(a.address,{size:20}),M(te(u),{size:32}),i,M(te(t.length/2-1),{size:32}),t])},Qr=async({accountAddress:e,chainId:t,kernelVersion:a,action:n,validator:r,validUntil:p,validAfter:i})=>({domain:{name:"Kernel",version:a,chainId:t,verifyingContract:e},types:{ValidatorApproved:[{name:"sig",type:"bytes4"},{name:"validatorData",type:"uint256"},{name:"executor",type:"address"},{name:"enableData",type:"bytes"}]},message:{sig:n.selector,validatorData:ve(q([M(te(p??0),{size:6}),M(te(i??0),{size:6}),r.address]),{size:32}),executor:n.address,enableData:await r.getEnableData(e)},primaryType:"ValidatorApproved"}),Jr=async({enableSignature:e,userOpSignature:t,action:a,enableData:n,hook:r})=>{var p;return j([(r==null?void 0:r.getIdentifier())??oe,re(rt("bytes validatorData, bytes hookData, bytes selectorData, bytes enableSig, bytes userOpSig"),[n,await(r==null?void 0:r.getEnableData())??"0x",j([a.selector,a.address,((p=a.hook)==null?void 0:p.address)??oe,re(rt("bytes selectorInitData, bytes hookInitData"),[ge.DELEGATE_CALL,"0x0000"])]),e,t])])},oa=async({accountAddress:e,chainId:t,kernelVersion:a,action:n,hook:r,validator:p,validatorNonce:i})=>{var u;return{domain:{name:"Kernel",version:a==="0.3.0"?"0.3.0-beta":a,chainId:t,verifyingContract:e},types:{Enable:[{name:"validationId",type:"bytes21"},{name:"nonce",type:"uint32"},{name:"hook",type:"address"},{name:"validatorData",type:"bytes"},{name:"hookData",type:"bytes"},{name:"selectorData",type:"bytes"}]},message:{validationId:j([z[p.validatorType],M(p.getIdentifier(),{size:20,dir:"right"})]),nonce:i,hook:(r==null?void 0:r.getIdentifier())??oe,validatorData:await p.getEnableData(e),hookData:await(r==null?void 0:r.getEnableData(e))??"0x",selectorData:j([n.selector,n.address,((u=n.hook)==null?void 0:u.address)??oe,re(rt("bytes selectorInitData, bytes hookInitData"),[ge.DELEGATE_CALL,"0x0000"])])},primaryType:"Enable"}},es=async(e,t,a)=>{try{return await $(e,be,"readContract")({abi:Hr,address:a,functionName:"isInitialized",args:[t]})}catch{}return!1};function $s(e){return(e==null?void 0:e.getPluginEnableSignature)!==void 0}async function Us(e,{sudo:t,regular:a,hook:n,pluginEnableSignature:r,validatorInitData:p,action:i,validAfter:u=0,validUntil:s=0,entryPoint:y,kernelVersion:o,chainId:m,isPreInstalled:w=!1}){var F;if(t&&!ce.satisfies(o,t==null?void 0:t.supportedKernelVersions)||a&&!ce.satisfies(o,a==null?void 0:a.supportedKernelVersions))throw new Error("Either sudo or/and regular validator version mismatch. Update to latest plugin package and use the proper plugin version");let A=w;const d=a||t;if(!d)throw new Error("One of `sudo` or `regular` validator must be set");if(i={selector:(i==null?void 0:i.selector)??ia(y.version),address:(i==null?void 0:i.address)??oe},y.version==="0.7"&&(i.address.toLowerCase()!==oe.toLowerCase()||i.selector.toLowerCase()!==ia(y.version).toLowerCase())&&o==="0.3.0"&&(i.hook={address:((F=i.hook)==null?void 0:F.address)??Tn}),!i)throw new Error("Action data must be set");const l=async(T,S,V="0x")=>{if(!i)throw new Error("Action data must be set");if(y.version==="0.6")if(a){if(A||await b(T,S))return de.plugin;const k=await P(T);if(!k)throw new Error("Enable signature not set");return Zr({accountAddress:T,enableSignature:k,action:i,validator:a,validUntil:s,validAfter:u})}else{if(t)return de.sudo;throw new Error("One of `sudo` or `regular` validator must be set")}if(a){if(A||await b(T,i.selector))return V;const k=await P(T);return Jr({enableSignature:k,userOpSignature:V,action:i,enableData:await a.getEnableData(T),hook:n})}else{if(t)return V;throw new Error("One of `sudo` or `regular` validator must be set")}},b=async(T,S,V)=>{const k=!!V,x=V??a;if(w&&!k)return!0;if(!i)throw new Error("Action data must be set");if(!x)throw new Error("regular validator not set");if(y.version==="0.6")return x.isEnabled(T,S);const L=await x.isEnabled(T,i.selector)||await es(e,T,x.address);return L&&!k&&(A=!0),L},P=async(T,S)=>{var Ie;const V=!!S,k=S??a;if(!i)throw new Error("Action data must be set");if(r&&!V)return r;if(!t)throw new Error("sudo validator not set -- need it to enable the validator");if(!k)throw new Error("regular validator not set");const{version:x}=await sa(e,T,o);m||(m=((Ie=e.chain)==null?void 0:Ie.id)??await Ge(e));let L;if(y.version==="0.6"){const f=await Qr({accountAddress:T,chainId:m,kernelVersion:x??o,action:i,validator:k,validUntil:s,validAfter:u});return L=await t.signTypedData(f),V||(r=L),L}const W=await na(e,T),Ke=await oa({accountAddress:T,chainId:m,kernelVersion:x,action:i,hook:n,validator:k,validatorNonce:W});return L=await t.signTypedData(Ke),V||(r=L),L},G=(T=!1)=>{const S=(T?t:a)??d;return j([z[S.validatorType],S.getIdentifier()])};return{sudoValidator:t,regularValidator:a,activeValidatorMode:t&&!a?"sudo":"regular",...d,hook:n,getIdentifier:G,encodeModuleInstallCallData:async T=>{if(!i)throw new Error("Action data must be set");if(!a)throw new Error("regular validator not set");if(y.version==="0.6")return await qr({accountAddress:T,selector:i.selector,executor:i.address,validator:a==null?void 0:a.address,validUntil:s,validAfter:u,enableData:await a.getEnableData(T)});throw new Error("EntryPoint v0.7 not supported yet")},signUserOperation:async T=>{const S=await d.signUserOperation(T);return y.version==="0.6"?q([await l(T.sender,T.callData.toString().slice(0,10)),S]):await l(T.sender,T.callData.toString().slice(0,10),S)},getAction:()=>{if(!i)throw new Error("Action data must be set");return i},getValidityData:()=>({validAfter:u,validUntil:s}),getStubSignature:async T=>{const S=await d.getStubSignature(T);return y.version==="0.6"?q([await l(T.sender,T.callData.toString().slice(0,10)),S]):await l(T.sender,T.callData.toString().slice(0,10),S)},getNonceKey:async(T=oe,S=0n)=>{if(!i)throw new Error("Action data must be set");if(y.version==="0.6"){if(S>yn)throw new Error("Custom nonce key must be equal or less than maxUint192 for 0.6");return await d.getNonceKey(T,S)}if(S>ln)throw new Error("Custom nonce key must be equal or less than 2 bytes(maxUint16) for v0.7");const V=!a||await b(T,i.selector)?jt.DEFAULT:jt.ENABLE,k=a?z[a.validatorType]:z.SUDO,x=M(q([V,k,M(d.getIdentifier(),{size:20,dir:"right"}),M(te(await d.getNonceKey(T,S)),{size:2})]),{size:24});return BigInt(x)},isPluginEnabled:b,getPluginEnableSignature:P,getPluginsEnableTypedData:async(T,S)=>{var W;const V=S??a;if(!i)throw new Error("Action data must be set");if(!t)throw new Error("sudo validator not set -- need it to enable the validator");if(!V)throw new Error("regular validator not set");const{version:k}=await sa(e,T,o),x=await na(e,T);return m||(m=((W=e.chain)==null?void 0:W.id)??await Ge(e)),await oa({accountAddress:T,chainId:m,kernelVersion:k,action:i,validator:V,validatorNonce:x})},getValidatorInitData:async()=>p||{validatorAddress:(t==null?void 0:t.address)??d.address,enableData:await(t==null?void 0:t.getEnableData())??await d.getEnableData(),identifier:M(G(!0),{size:21,dir:"right"})},signUserOperationWithActiveValidator:async T=>d.signUserOperation(T)}}const Fs=[{type:"constructor",inputs:[{name:"_owner",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"approveFactory",inputs:[{name:"factory",type:"address",internalType:"contract KernelFactory"},{name:"approval",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"payable"},{type:"function",name:"approved",inputs:[{name:"",type:"address",internalType:"contract KernelFactory"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"cancelOwnershipHandover",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"completeOwnershipHandover",inputs:[{name:"pendingOwner",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"deployWithFactory",inputs:[{name:"factory",type:"address",internalType:"contract KernelFactory"},{name:"createData",type:"bytes",internalType:"bytes"},{name:"salt",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"payable"},{type:"function",name:"owner",inputs:[],outputs:[{name:"result",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"ownershipHandoverExpiresAt",inputs:[{name:"pendingOwner",type:"address",internalType:"address"}],outputs:[{name:"result",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"renounceOwnership",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"requestOwnershipHandover",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"stake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"},{name:"unstakeDelay",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"transferOwnership",inputs:[{name:"newOwner",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"unlockStake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"}],outputs:[],stateMutability:"payable"},{type:"function",name:"withdrawStake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"},{name:"recipient",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"payable"},{type:"event",name:"OwnershipHandoverCanceled",inputs:[{name:"pendingOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"OwnershipHandoverRequested",inputs:[{name:"pendingOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"OwnershipTransferred",inputs:[{name:"oldOwner",type:"address",indexed:!0,internalType:"address"},{name:"newOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"error",name:"AlreadyInitialized",inputs:[]},{type:"error",name:"NewOwnerIsZeroAddress",inputs:[]},{type:"error",name:"NoHandoverRequest",inputs:[]},{type:"error",name:"NotApprovedFactory",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}],pa=[{type:"constructor",inputs:[{name:"_entrypoint",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"nonpayable"},{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"accountId",inputs:[],outputs:[{name:"accountImplementationId",type:"string",internalType:"string"}],stateMutability:"pure"},{type:"function",name:"changeRootValidator",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"currentNonce",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"entrypoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"view"},{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executorConfig",inputs:[{name:"executor",type:"address",internalType:"contract IExecutor"}],outputs:[{name:"",type:"tuple",internalType:"struct ExecutorManager.ExecutorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"},{name:"initConfig",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"installModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"initData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"installValidations",inputs:[{name:"vIds",type:"bytes21[]",internalType:"ValidationId[]"},{name:"configs",type:"tuple[]",internalType:"struct ValidationManager.ValidationConfig[]",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]},{name:"validationData",type:"bytes[]",internalType:"bytes[]"},{name:"hookData",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"payable"},{type:"function",name:"invalidateNonce",inputs:[{name:"nonce",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"isAllowedSelector",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isModuleInstalled",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"additionalContext",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"onERC1155BatchReceived",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"onERC1155Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"onERC721Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"permissionConfig",inputs:[{name:"pId",type:"bytes4",internalType:"PermissionId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.PermissionConfig",components:[{name:"permissionFlag",type:"bytes2",internalType:"PassFlag"},{name:"signer",type:"address",internalType:"contract ISigner"},{name:"policyData",type:"bytes22[]",internalType:"PolicyData[]"}]}],stateMutability:"view"},{type:"function",name:"rootValidator",inputs:[],outputs:[{name:"",type:"bytes21",internalType:"ValidationId"}],stateMutability:"view"},{type:"function",name:"selectorConfig",inputs:[{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"tuple",internalType:"struct SelectorManager.SelectorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"},{name:"target",type:"address",internalType:"address"},{name:"callType",type:"bytes1",internalType:"CallType"}]}],stateMutability:"view"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ExecMode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"supportsModule",inputs:[{name:"moduleTypeId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"uninstallModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"deInitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"uninstallValidation",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"deinitData",type:"bytes",internalType:"bytes"},{name:"hookDeinitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"upgradeTo",inputs:[{name:"_newImplementation",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"validNonceFrom",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"ValidationData"}],stateMutability:"payable"},{type:"function",name:"validationConfig",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.ValidationConfig",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"event",name:"ModuleInstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"ModuleUninstallResult",inputs:[{name:"module",type:"address",indexed:!1,internalType:"address"},{name:"result",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"ModuleUninstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"NonceInvalidated",inputs:[{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionInstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionUninstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"}],anonymous:!1},{type:"event",name:"Received",inputs:[{name:"sender",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"RootValidatorUpdated",inputs:[{name:"rootValidator",type:"bytes21",indexed:!1,internalType:"ValidationId"}],anonymous:!1},{type:"event",name:"SelectorSet",inputs:[{name:"selector",type:"bytes4",indexed:!1,internalType:"bytes4"},{name:"vId",type:"bytes21",indexed:!1,internalType:"ValidationId"},{name:"allowed",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"TryExecuteUnsuccessful",inputs:[{name:"batchExecutionindex",type:"uint256",indexed:!1,internalType:"uint256"},{name:"result",type:"bytes",indexed:!1,internalType:"bytes"}],anonymous:!1},{type:"event",name:"Upgraded",inputs:[{name:"implementation",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"ValidatorInstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"ValidatorUninstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"}],anonymous:!1},{type:"error",name:"EnableNotApproved",inputs:[]},{type:"error",name:"ExecutionReverted",inputs:[]},{type:"error",name:"InitConfigError",inputs:[{name:"idx",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidCallType",inputs:[]},{type:"error",name:"InvalidCaller",inputs:[]},{type:"error",name:"InvalidExecutor",inputs:[]},{type:"error",name:"InvalidFallback",inputs:[]},{type:"error",name:"InvalidMode",inputs:[]},{type:"error",name:"InvalidModuleType",inputs:[]},{type:"error",name:"InvalidNonce",inputs:[]},{type:"error",name:"InvalidSelector",inputs:[]},{type:"error",name:"InvalidSignature",inputs:[]},{type:"error",name:"InvalidValidationType",inputs:[]},{type:"error",name:"InvalidValidator",inputs:[]},{type:"error",name:"NonceInvalidationError",inputs:[]},{type:"error",name:"NotSupportedCallType",inputs:[]},{type:"error",name:"OnlyExecuteUserOp",inputs:[]},{type:"error",name:"PermissionDataLengthMismatch",inputs:[]},{type:"error",name:"PermissionNotAlllowedForSignature",inputs:[]},{type:"error",name:"PermissionNotAlllowedForUserOp",inputs:[]},{type:"error",name:"PolicyDataTooLarge",inputs:[]},{type:"error",name:"PolicyFailed",inputs:[{name:"i",type:"uint256",internalType:"uint256"}]},{type:"error",name:"PolicySignatureOrderError",inputs:[]},{type:"error",name:"RootValidatorCannotBeRemoved",inputs:[]},{type:"error",name:"SignerPrefixNotPresent",inputs:[]}],ts=ya(["function performCreate(uint256 value, bytes memory deploymentData) public returns (address newContract)","function performCreate2(uint256 value, bytes memory deploymentData, bytes32 salt) public returns (address newContract)"]),Ga=e=>H({abi:ts,functionName:"performCreate",args:e}),Vs=e=>{const t={to:da,data:Ga([0n,la(e)])};return La(t)},Ut=(e,t,a=!1)=>{let n;"calldata"in e?n=e.calldata:n=q([e.to,t.callType!==ge.DELEGATE_CALL?te(e.value||0n,{size:32}):"0x",e.data||"0x"]);const r=at(nt({abi:et,name:"executeUserOp"}));return a?q([r,H({abi:et,functionName:"execute",args:[aa(t),n]})]):H({abi:et,functionName:"execute",args:[aa(t),n]})},as=(e,t,a)=>{const n=re([{name:"executionBatch",type:"tuple[]",components:[{name:"target",type:"address"},{name:"value",type:"uint256"},{name:"callData",type:"bytes"}]}],[e.map(r=>({target:r.to,value:r.value||0n,callData:r.data||"0x"}))]);return Ut({calldata:n},{callType:ge.BATCH,execType:t.execType},a)},Ca=(e,t,a)=>Ut(e,{callType:ge.DELEGATE_CALL,execType:t.execType},a),ns=(e,t,a)=>Ut(e,{callType:ge.SINGLE,execType:t.execType},a),_s=async(e,t,a,n=ca.DEFAULT)=>{if(e.length>1){if(t==="delegatecall")throw new Error("Cannot batch delegatecall");return as(e,{execType:n},a)}const r=e.length===0?void 0:e[0];if(!r)throw new Error("No calls to encode");if(!t||t==="call")return ns(r,{execType:n},a);if(t==="delegatecall")return Ca({to:r.to,data:r.data},{execType:n},a);throw new Error("Invalid call type")},ks=e=>{const t={to:da,data:Ga([0n,la(e)])};return Ca(t,{execType:ca.DEFAULT})},rs=e=>Y(re([{type:"bytes32"},{type:"bytes32"}],[Y(dn("Kernel(bytes32 hash)")),e])),Bs=async(e,t,a)=>{const{name:n,version:r,chainId:p,verifyingContract:i}=t;if(!Je(ne.ERC1271_SIG_WRAPPER,r))return e;const u=Je(ne.ERC1271_REPLAYABLE,r)&&a?0:p,s=cn({domain:{name:n,version:r,chainId:u,verifyingContract:i}});let y=e;return Je(ne.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH,r)&&(y=rs(y)),Y(q(["0x1901",s,y]))},Hs=(e,t)=>{const a=H({abi:zr,functionName:"installModule",args:[t.type,t.address,t.data]});return{to:e,data:a}},ss=async(e,t)=>{var o;const{userOperation:{chainId:a,entryPointAddress:n,context:r,calls:p,account:i,...u}}=t,s=await e.request({method:"zd_sponsorUserOperation",params:[{chainId:(o=e.chain)==null?void 0:o.id,userOp:ke(u),entryPointAddress:n,gasTokenData:t.gasToken&&{tokenAddress:t.gasToken},shouldOverrideFee:t.shouldOverrideFee??!1,shouldConsume:t.shouldConsume??!0}]});if(mn(n,ma))return{paymasterAndData:s.paymasterAndData,preVerificationGas:BigInt(s.preVerificationGas),verificationGasLimit:BigInt(s.verificationGasLimit),callGasLimit:BigInt(s.callGasLimit),maxFeePerGas:s.maxFeePerGas?BigInt(s.maxFeePerGas):t.userOperation.maxFeePerGas,maxPriorityFeePerGas:s.maxPriorityFeePerGas?BigInt(s.maxPriorityFeePerGas):t.userOperation.maxPriorityFeePerGas};const y=s;return{callGasLimit:BigInt(y.callGasLimit),verificationGasLimit:BigInt(y.verificationGasLimit),preVerificationGas:BigInt(y.preVerificationGas),paymaster:y.paymaster,paymasterVerificationGasLimit:BigInt(y.paymasterVerificationGasLimit),paymasterPostOpGasLimit:BigInt(y.paymasterPostOpGasLimit),paymasterData:y.paymasterData,maxFeePerGas:s.maxFeePerGas?BigInt(s.maxFeePerGas):t.userOperation.maxFeePerGas,maxPriorityFeePerGas:s.maxPriorityFeePerGas?BigInt(s.maxPriorityFeePerGas):t.userOperation.maxPriorityFeePerGas}};function is(e,t){Kr(e.entryPoint.version,t);const a=fa[t].accountImplementationAddress;return{to:e.address,data:H({abi:Te,functionName:"upgradeTo",args:[a]}),value:0n}}class ie extends I{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class zs extends I{constructor(){super("Smart account signer doesn't need to sign transactions",{name:"SignTransactionNotSupportedError"})}}async function os(e,t){const{account:a=e.account,kernelVersion:n}=t;if(!a)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const r=X(a),p=is(r,n);return await $(e,pe,"sendUserOperation")({...t,calls:[p],account:r})}async function ps(e,t){const{sudoValidator:a,hook:n,...r}=t,p=r.account??e.account;if(!p)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const i=X(p);let u;if([z.PERMISSION,z.SECONDARY,z.EIP7702].includes(z[a.validatorType]))u=q([z[a.validatorType],M(a.getIdentifier(),{size:20,dir:"right"})]);else throw new Error(`Cannot change sudo validator to type ${a.validatorType}`);const s=await a.getEnableData(i.address),y=(n==null?void 0:n.getIdentifier())??oe,o=await(n==null?void 0:n.getEnableData(i.address))??"0x";return i.kernelVersion===En?await $(e,pe,"sendUserOperation")({...r,callData:await i.encodeCalls([{to:fa[vn].accountImplementationAddress,value:0n,data:H({abi:pa,functionName:"changeRootValidator",args:[u,y,s,o]})}],"delegatecall")}):await $(e,pe,"sendUserOperation")({...r,callData:await i.encodeCalls([{to:i.address,value:0n,data:H({abi:pa,functionName:"changeRootValidator",args:[u,y,s,o]})}])})}async function us(e,t){const{account:a=e.account,nonceToSet:n}=t;if(!a)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const r=X(a);return await $(e,pe,"sendUserOperation")({...t,calls:[{to:r.address,data:H({abi:Te,functionName:"invalidateNonce",args:[n]}),value:0n}],account:r})}async function ys(e,t){const{account:a=e.account,plugin:n,hook:r,...p}=t;if(!a)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const i=X(a);let u;if([z.PERMISSION,z.SECONDARY,z.EIP7702].includes(z[n.validatorType]))u=q([z[n.validatorType],M(n.getIdentifier(),{size:20,dir:"right"})]);else throw new Error(`Cannot uninstall ${n.validatorType} plugin`);const s=await n.getEnableData(i.address),y=await(r==null?void 0:r.getEnableData(i.address))??"0x";return await $(e,pe,"sendUserOperation")({...p,calls:[{to:i.address,data:H({abi:Te,functionName:"uninstallValidation",args:[u,s,y]}),value:0n}],account:i})}async function ls(e,t){const{account:a=e.account}=t;if(!a)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const n=X(a),r=await $(e,fe,"prepareUserOperation")({...t,account:n});return r.signature=await n.signUserOperation(r),r}async function ds(e){const t=e.account;if(!t)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const a=X(t);try{return await $(e,be,"readContract")({abi:Te,address:a.address,functionName:"currentNonce",args:[]})}catch{return 1}}const Sa=async e=>{const t=await e.request({method:"zd_getUserOperationGasPrice",params:[]});return{maxFeePerGas:BigInt(t.standard.maxFeePerGas),maxPriorityFeePerGas:BigInt(t.standard.maxPriorityFeePerGas)}};async function Na(e,t){let a;if("to"in t){const{account:r=e.account,data:p,maxFeePerGas:i,maxPriorityFeePerGas:u,to:s,value:y,nonce:o}=t;if(!r)throw new ie({docsPath:"/docs/actions/wallet/sendTransaction"});const m=X(r);if(!s)throw new Error("Missing to address");a=await $(e,pe,"sendUserOperation")({calls:[{to:s,value:y||BigInt(0),data:p||"0x"}],account:m,maxFeePerGas:i,maxPriorityFeePerGas:u,nonce:o?BigInt(o):void 0})}else a=await $(e,pe,"sendUserOperation")({...t});const n=await $(e,Da,"waitForUserOperationReceipt")({hash:a});return n==null?void 0:n.receipt.transactionHash}async function cs(e,{account:t=e.account,message:a}){if(!t)throw new ie({docsPath:"/docs/actions/wallet/signMessage"});return X(t).signMessage({message:a})}async function ms(e,{account:t=e.account,domain:a,message:n,primaryType:r,types:p}){if(!t)throw new ie({docsPath:"/docs/actions/wallet/signMessage"});const i=X(t),u={EIP712Domain:fn({domain:a}),...p};return bn({domain:a,message:n,primaryType:r,types:u}),i.signTypedData({domain:a,primaryType:r,types:u,message:n})}async function fs(e,{abi:t,address:a,args:n,dataSuffix:r,functionName:p,...i}){const u=H({abi:t,args:n,functionName:p});return await $(e,Na,"sendTransaction")({data:`${u}${r?r.replace("0x",""):""}`,to:a,...i})}const bs=async(e,t)=>{var p;const a=await e.request({method:"stackup_getERC20TokenQuotes",params:[{chainId:(p=e.chain)==null?void 0:p.id,userOp:{...ke(t.userOperation),initCode:t.userOperation.initCode||"0x"},tokenAddress:t.gasTokenAddress,entryPointAddress:t.entryPoint??ma}]}),n={maxGasCostToken:a.maxGasCostToken,tokenDecimals:a.tokenDecimals};return{amount:Number(n.maxGasCostToken)/10**Number(n.tokenDecimals)}},js=()=>e=>({sponsorUserOperation:async t=>ss(e,{...t}),estimateGasInERC20:async t=>bs(e,t)});function ua(){return e=>({signUserOperation:t=>ls(e,t),getUserOperationGasPrice:async()=>Sa(e),uninstallPlugin:async t=>ys(e,t),changeSudoValidator:async t=>ps(e,t),invalidateNonce:async t=>us(e,t),getKernelV3ModuleCurrentNonce:async()=>ds(e),upgradeKernel:async t=>os(e,t),sendTransaction:t=>Na(e,t),signMessage:t=>cs(e,t),signTypedData:t=>ms(e,t),writeContract:t=>fs(e,t)})}function Ks(e){var y,o;const{client:t,key:a="Account",name:n="Kernel Account Client",paymaster:r,paymasterContext:p,bundlerTransport:i,userOperation:u}=e,s=Object.assign(gn({...e,chain:e.chain??(t==null?void 0:t.chain),transport:i,key:a,name:n,type:"kernelAccountClient",pollingInterval:e.pollingInterval??1e3}),{client:t,paymaster:r,paymasterContext:p,userOperation:u});if((y=e.userOperation)!=null&&y.prepareUserOperation){const m=e.userOperation.prepareUserOperation;return s.extend(De).extend(w=>({prepareUserOperation:A=>m(w,A)})).extend(De).extend(w=>({prepareUserOperation:A=>m(w,A)})).extend(ua())}return(o=s.userOperation)!=null&&o.estimateFeesPerGas||(s.userOperation={...s.userOperation,estimateFeesPerGas:async({bundlerClient:m})=>await Sa(m)}),s.extend(De).extend(m=>({prepareUserOperation:async w=>{var d,l,b;let A=w;if((d=m.account)!=null&&d.authorization){const P=w.authorization||await((b=(l=m.account)==null?void 0:l.eip7702Authorization)==null?void 0:b.call(l));A={...w,authorization:P}}return await fe(m,A)}})).extend(De).extend(m=>({prepareUserOperation:async w=>{var d,l,b;let A=w;if((d=m.account)!=null&&d.authorization){const P=w.authorization||await((b=(l=m.account)==null?void 0:l.eip7702Authorization)==null?void 0:b.call(l));A={...w,authorization:P}}return await fe(m,A)}})).extend(ua())}export{ls as $,ks as A,sa as B,Te as C,et as D,js as E,Cs as F,ia as G,Ks as H,ie as I,ra as J,Fs as K,ta as L,Ra as M,ps as N,ke as O,Gs as P,Ls as Q,Jr as R,zs as S,aa as T,na as U,oa as V,is as W,Sa as X,us as Y,es as Z,ua as _,Mr as a,ss as a0,ys as a1,os as a2,fe as a3,Ss as b,Os as c,Us as d,Ds as e,Is as f,$r as g,xs as h,$s as i,Ps as j,wn as k,Rs as l,Ns as m,Ms as n,pa as o,As as p,Bs as q,Je as r,ce as s,xr as t,ne as u,Kr as v,Hs as w,_s as x,Yr as y,Vs as z};
