import{as as wa,C as Y,a7 as ee,at as va,au as Ia,J as N,av as xa,a4 as z,E as M,aw as Oa,_ as Pa,ad as W,T as $,aa as ue,ab as ea,a0 as Aa,D as Dt,I as Rt,ax as I,ay as Da,az as Gt,aA as ve,aB as Ra,aC as Xe,aD as Ga,ag as me,aE as vt,V as B,aF as La,aG as Ca,aH as K,O as Ie,aI as Sa,aJ as Na,aK as Ma,aL as $a,aM as Ua,aN as Fa,ah as Va,aO as Lt,aP as Ct,aQ as St,aR as _a,W as J,aq as Nt,aS as ka,aT as Ba,aU as Ha,aV as za,a1 as ja,aW as Ka,P as Xa,aX as Wa,aY as Ya,a5 as We,a6 as Ye,Q as ae,a8 as qe,aZ as qa,ar as Za,ac as ta,F as Ja,a_ as Qa,R as en,X as tn,Y as an,ae as nn}from"./index-BZqhspvt.js";import{f as rn,C as ye,V as H,O as sn,d as Mt,s as aa,E as na,a as ra,K as sa,g as on,h as pn}from"./constants-BAStHJRZ.js";function un(e){const{source:t}=e,a=new Map,n=new wa(8192),r=new Map,p=({address:i,chainId:u})=>`${i}.${u}`;return{async consume({address:i,chainId:u,client:s}){const y=p({address:i,chainId:u}),o=this.get({address:i,chainId:u,client:s});this.increment({address:i,chainId:u});const m=await o;return await t.set({address:i,chainId:u},m),n.set(y,m),m},async increment({address:i,chainId:u}){const s=p({address:i,chainId:u}),y=a.get(s)??0;a.set(s,y+1)},async get({address:i,chainId:u,client:s}){const y=p({address:i,chainId:u});let o=r.get(y);return o||(o=(async()=>{try{const v=await t.get({address:i,chainId:u,client:s}),A=n.get(y)??0;return A>0&&v<=A?A+1:(n.delete(y),v)}finally{this.reset({address:i,chainId:u})}})(),r.set(y,o)),(a.get(y)??0)+await o},reset({address:i,chainId:u}){const s=p({address:i,chainId:u});a.delete(s),r.delete(s)}}}const yn="0x6492649264926492649264926492649264926492649264926492649264926492";function Ve(e){const{address:t,data:a,signature:n,to:r="hex"}=e,p=Y([ee([{type:"address"},{type:"bytes"},{type:"bytes"}],[t,a,n]),yn]);return r==="hex"?p:va(p)}function ln(e){const{r:t,s:a}=Ia.Signature.fromCompact(e.slice(2,130)),n=+`0x${e.slice(130)}`,[r,p]=(()=>{if(n===0||n===1)return[void 0,n];if(n===27)return[BigInt(n),0];if(n===28)return[BigInt(n),1];throw new Error("Invalid yParityOrV value")})();return typeof r<"u"?{r:N(t,{size:32}),s:N(a,{size:32}),v:r,yParity:p}:{r:N(t,{size:32}),s:N(a,{size:32}),yParity:p}}var Ze={exports:{}};const dn="2.0.0",ia=256,cn=Number.MAX_SAFE_INTEGER||9007199254740991,mn=16,fn=ia-6,bn=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Ne={MAX_LENGTH:ia,MAX_SAFE_COMPONENT_LENGTH:mn,MAX_SAFE_BUILD_LENGTH:fn,MAX_SAFE_INTEGER:cn,RELEASE_TYPES:bn,SEMVER_SPEC_VERSION:dn,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},_e={};const gn=typeof xa=="object"&&_e&&_e.NODE_DEBUG&&/\bsemver\b/i.test(_e.NODE_DEBUG)?(...e)=>console.error("SEMVER",...e):()=>{};var Me=gn;(function(e,t){const{MAX_SAFE_COMPONENT_LENGTH:a,MAX_SAFE_BUILD_LENGTH:n,MAX_LENGTH:r}=Ne,p=Me;t=e.exports={};const i=t.re=[],u=t.safeRe=[],s=t.src=[],y=t.safeSrc=[],o=t.t={};let m=0;const v="[a-zA-Z0-9-]",A=[["\\s",1],["\\d",r],[v,n]],d=b=>{for(const[P,L]of A)b=b.split(`${P}*`).join(`${P}{0,${L}}`).split(`${P}+`).join(`${P}{1,${L}}`);return b},l=(b,P,L)=>{const R=d(P),F=m++;p(b,F,P),o[b]=F,s[F]=P,y[F]=R,i[F]=new RegExp(P,L?"g":void 0),u[F]=new RegExp(R,L?"g":void 0)};l("NUMERICIDENTIFIER","0|[1-9]\\d*"),l("NUMERICIDENTIFIERLOOSE","\\d+"),l("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${v}*`),l("MAINVERSION",`(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})\\.(${s[o.NUMERICIDENTIFIER]})`),l("MAINVERSIONLOOSE",`(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})\\.(${s[o.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASEIDENTIFIER",`(?:${s[o.NONNUMERICIDENTIFIER]}|${s[o.NUMERICIDENTIFIER]})`),l("PRERELEASEIDENTIFIERLOOSE",`(?:${s[o.NONNUMERICIDENTIFIER]}|${s[o.NUMERICIDENTIFIERLOOSE]})`),l("PRERELEASE",`(?:-(${s[o.PRERELEASEIDENTIFIER]}(?:\\.${s[o.PRERELEASEIDENTIFIER]})*))`),l("PRERELEASELOOSE",`(?:-?(${s[o.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${s[o.PRERELEASEIDENTIFIERLOOSE]})*))`),l("BUILDIDENTIFIER",`${v}+`),l("BUILD",`(?:\\+(${s[o.BUILDIDENTIFIER]}(?:\\.${s[o.BUILDIDENTIFIER]})*))`),l("FULLPLAIN",`v?${s[o.MAINVERSION]}${s[o.PRERELEASE]}?${s[o.BUILD]}?`),l("FULL",`^${s[o.FULLPLAIN]}$`),l("LOOSEPLAIN",`[v=\\s]*${s[o.MAINVERSIONLOOSE]}${s[o.PRERELEASELOOSE]}?${s[o.BUILD]}?`),l("LOOSE",`^${s[o.LOOSEPLAIN]}$`),l("GTLT","((?:<|>)?=?)"),l("XRANGEIDENTIFIERLOOSE",`${s[o.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),l("XRANGEIDENTIFIER",`${s[o.NUMERICIDENTIFIER]}|x|X|\\*`),l("XRANGEPLAIN",`[v=\\s]*(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:\\.(${s[o.XRANGEIDENTIFIER]})(?:${s[o.PRERELEASE]})?${s[o.BUILD]}?)?)?`),l("XRANGEPLAINLOOSE",`[v=\\s]*(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:\\.(${s[o.XRANGEIDENTIFIERLOOSE]})(?:${s[o.PRERELEASELOOSE]})?${s[o.BUILD]}?)?)?`),l("XRANGE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAIN]}$`),l("XRANGELOOSE",`^${s[o.GTLT]}\\s*${s[o.XRANGEPLAINLOOSE]}$`),l("COERCEPLAIN",`(^|[^\\d])(\\d{1,${a}})(?:\\.(\\d{1,${a}}))?(?:\\.(\\d{1,${a}}))?`),l("COERCE",`${s[o.COERCEPLAIN]}(?:$|[^\\d])`),l("COERCEFULL",s[o.COERCEPLAIN]+`(?:${s[o.PRERELEASE]})?(?:${s[o.BUILD]})?(?:$|[^\\d])`),l("COERCERTL",s[o.COERCE],!0),l("COERCERTLFULL",s[o.COERCEFULL],!0),l("LONETILDE","(?:~>?)"),l("TILDETRIM",`(\\s*)${s[o.LONETILDE]}\\s+`,!0),t.tildeTrimReplace="$1~",l("TILDE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAIN]}$`),l("TILDELOOSE",`^${s[o.LONETILDE]}${s[o.XRANGEPLAINLOOSE]}$`),l("LONECARET","(?:\\^)"),l("CARETTRIM",`(\\s*)${s[o.LONECARET]}\\s+`,!0),t.caretTrimReplace="$1^",l("CARET",`^${s[o.LONECARET]}${s[o.XRANGEPLAIN]}$`),l("CARETLOOSE",`^${s[o.LONECARET]}${s[o.XRANGEPLAINLOOSE]}$`),l("COMPARATORLOOSE",`^${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]})$|^$`),l("COMPARATOR",`^${s[o.GTLT]}\\s*(${s[o.FULLPLAIN]})$|^$`),l("COMPARATORTRIM",`(\\s*)${s[o.GTLT]}\\s*(${s[o.LOOSEPLAIN]}|${s[o.XRANGEPLAIN]})`,!0),t.comparatorTrimReplace="$1$2$3",l("HYPHENRANGE",`^\\s*(${s[o.XRANGEPLAIN]})\\s+-\\s+(${s[o.XRANGEPLAIN]})\\s*$`),l("HYPHENRANGELOOSE",`^\\s*(${s[o.XRANGEPLAINLOOSE]})\\s+-\\s+(${s[o.XRANGEPLAINLOOSE]})\\s*$`),l("STAR","(<|>)?=?\\s*\\*"),l("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),l("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(Ze,Ze.exports);var fe=Ze.exports;const hn=Object.freeze({loose:!0}),Tn=Object.freeze({}),En=e=>e?typeof e!="object"?hn:e:Tn;var It=En;const $t=/^[0-9]+$/,oa=(e,t)=>{if(typeof e=="number"&&typeof t=="number")return e===t?0:e<t?-1:1;const a=$t.test(e),n=$t.test(t);return a&&n&&(e=+e,t=+t),e===t?0:a&&!n?-1:n&&!a?1:e<t?-1:1},wn=(e,t)=>oa(t,e);var pa={compareIdentifiers:oa,rcompareIdentifiers:wn};const ge=Me,{MAX_LENGTH:Ut,MAX_SAFE_INTEGER:he}=Ne,{safeRe:Te,t:Ee}=fe,vn=It,{compareIdentifiers:ke}=pa;let In=class Z{constructor(t,a){if(a=vn(a),t instanceof Z){if(t.loose===!!a.loose&&t.includePrerelease===!!a.includePrerelease)return t;t=t.version}else if(typeof t!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof t}".`);if(t.length>Ut)throw new TypeError(`version is longer than ${Ut} characters`);ge("SemVer",t,a),this.options=a,this.loose=!!a.loose,this.includePrerelease=!!a.includePrerelease;const n=t.trim().match(a.loose?Te[Ee.LOOSE]:Te[Ee.FULL]);if(!n)throw new TypeError(`Invalid Version: ${t}`);if(this.raw=t,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>he||this.major<0)throw new TypeError("Invalid major version");if(this.minor>he||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>he||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(r=>{if(/^[0-9]+$/.test(r)){const p=+r;if(p>=0&&p<he)return p}return r}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(t){if(ge("SemVer.compare",this.version,this.options,t),!(t instanceof Z)){if(typeof t=="string"&&t===this.version)return 0;t=new Z(t,this.options)}return t.version===this.version?0:this.compareMain(t)||this.comparePre(t)}compareMain(t){return t instanceof Z||(t=new Z(t,this.options)),this.major<t.major?-1:this.major>t.major?1:this.minor<t.minor?-1:this.minor>t.minor?1:this.patch<t.patch?-1:this.patch>t.patch?1:0}comparePre(t){if(t instanceof Z||(t=new Z(t,this.options)),this.prerelease.length&&!t.prerelease.length)return-1;if(!this.prerelease.length&&t.prerelease.length)return 1;if(!this.prerelease.length&&!t.prerelease.length)return 0;let a=0;do{const n=this.prerelease[a],r=t.prerelease[a];if(ge("prerelease compare",a,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return ke(n,r)}while(++a)}compareBuild(t){t instanceof Z||(t=new Z(t,this.options));let a=0;do{const n=this.build[a],r=t.build[a];if(ge("build compare",a,n,r),n===void 0&&r===void 0)return 0;if(r===void 0)return 1;if(n===void 0)return-1;if(n===r)continue;return ke(n,r)}while(++a)}inc(t,a,n){if(t.startsWith("pre")){if(!a&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(a){const r=`-${a}`.match(this.options.loose?Te[Ee.PRERELEASELOOSE]:Te[Ee.PRERELEASE]);if(!r||r[1]!==a)throw new Error(`invalid identifier: ${a}`)}}switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",a,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",a,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",a,n),this.inc("pre",a,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",a,n),this.inc("pre",a,n);break;case"release":if(this.prerelease.length===0)throw new Error(`version ${this.raw} is not a prerelease`);this.prerelease.length=0;break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const r=Number(n)?1:0;if(this.prerelease.length===0)this.prerelease=[r];else{let p=this.prerelease.length;for(;--p>=0;)typeof this.prerelease[p]=="number"&&(this.prerelease[p]++,p=-2);if(p===-1){if(a===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(r)}}if(a){let p=[a,r];n===!1&&(p=[a]),ke(this.prerelease[0],a)===0?isNaN(this.prerelease[1])&&(this.prerelease=p):this.prerelease=p}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var xt=In;const Ft=xt,xn=(e,t,a)=>new Ft(e,a).compare(new Ft(t,a));var le=xn;const On=le,Pn=(e,t,a)=>On(e,t,a)>0;var An=Pn;const Dn=le,Rn=(e,t,a)=>Dn(e,t,a)<0;var Gn=Rn;const Ln=le,Cn=(e,t,a)=>Ln(e,t,a)===0;var Sn=Cn;const Nn=le,Mn=(e,t,a)=>Nn(e,t,a)!==0;var $n=Mn;const Un=le,Fn=(e,t,a)=>Un(e,t,a)>=0;var Vn=Fn;const _n=le,kn=(e,t,a)=>_n(e,t,a)<=0;var Bn=kn;const Hn=Sn,zn=$n,jn=An,Kn=Vn,Xn=Gn,Wn=Bn,Yn=(e,t,a,n)=>{switch(t){case"===":return typeof e=="object"&&(e=e.version),typeof a=="object"&&(a=a.version),e===a;case"!==":return typeof e=="object"&&(e=e.version),typeof a=="object"&&(a=a.version),e!==a;case"":case"=":case"==":return Hn(e,a,n);case"!=":return zn(e,a,n);case">":return jn(e,a,n);case">=":return Kn(e,a,n);case"<":return Xn(e,a,n);case"<=":return Wn(e,a,n);default:throw new TypeError(`Invalid operator: ${t}`)}};var qn=Yn;const{safeRe:ts,t:as}=fe;class Zn{constructor(){this.max=1e3,this.map=new Map}get(t){const a=this.map.get(t);if(a!==void 0)return this.map.delete(t),this.map.set(t,a),a}delete(t){return this.map.delete(t)}set(t,a){if(!this.delete(t)&&a!==void 0){if(this.map.size>=this.max){const r=this.map.keys().next().value;this.delete(r)}this.map.set(t,a)}return this}}var Jn=Zn,Be,Vt;function q(){if(Vt)return Be;Vt=1;const e=/\s+/g;class t{constructor(c,E){if(E=r(E),c instanceof t)return c.loose===!!E.loose&&c.includePrerelease===!!E.includePrerelease?c:new t(c.raw,E);if(c instanceof p)return this.raw=c.value,this.set=[[c]],this.formatted=void 0,this;if(this.options=E,this.loose=!!E.loose,this.includePrerelease=!!E.includePrerelease,this.raw=c.trim().replace(e," "),this.set=this.raw.split("||").map(g=>this.parseRange(g.trim())).filter(g=>g.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const g=this.set[0];if(this.set=this.set.filter(w=>!l(w[0])),this.set.length===0)this.set=[g];else if(this.set.length>1){for(const w of this.set)if(w.length===1&&b(w[0])){this.set=[w];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let c=0;c<this.set.length;c++){c>0&&(this.formatted+="||");const E=this.set[c];for(let g=0;g<E.length;g++)g>0&&(this.formatted+=" "),this.formatted+=E[g].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(c){const g=((this.options.includePrerelease&&A)|(this.options.loose&&d))+":"+c,w=n.get(g);if(w)return w;const h=this.options.loose,O=h?s[y.HYPHENRANGELOOSE]:s[y.HYPHENRANGE];c=c.replace(O,Fe(this.options.includePrerelease)),i("hyphen replace",c),c=c.replace(s[y.COMPARATORTRIM],o),i("comparator trim",c),c=c.replace(s[y.TILDETRIM],m),i("tilde trim",c),c=c.replace(s[y.CARETTRIM],v),i("caret trim",c);let C=c.split(" ").map(k=>L(k,this.options)).join(" ").split(/\s+/).map(k=>X(k,this.options));h&&(C=C.filter(k=>(i("loose invalid filter",k,this.options),!!k.match(s[y.COMPARATORLOOSE])))),i("range list",C);const D=new Map,U=C.map(k=>new p(k,this.options));for(const k of U){if(l(k))return[k];D.set(k.value,k)}D.size>1&&D.has("")&&D.delete("");const j=[...D.values()];return n.set(g,j),j}intersects(c,E){if(!(c instanceof t))throw new TypeError("a Range is required");return this.set.some(g=>P(g,E)&&c.set.some(w=>P(w,E)&&g.every(h=>w.every(O=>h.intersects(O,E)))))}test(c){if(!c)return!1;if(typeof c=="string")try{c=new u(c,this.options)}catch{return!1}for(let E=0;E<this.set.length;E++)if(be(this.set[E],c,this.options))return!0;return!1}}Be=t;const a=Jn,n=new a,r=It,p=$e(),i=Me,u=xt,{safeRe:s,t:y,comparatorTrimReplace:o,tildeTrimReplace:m,caretTrimReplace:v}=fe,{FLAG_INCLUDE_PRERELEASE:A,FLAG_LOOSE:d}=Ne,l=f=>f.value==="<0.0.0-0",b=f=>f.value==="",P=(f,c)=>{let E=!0;const g=f.slice();let w=g.pop();for(;E&&g.length;)E=g.every(h=>w.intersects(h,c)),w=g.pop();return E},L=(f,c)=>(f=f.replace(s[y.BUILD],""),i("comp",f,c),f=S(f,c),i("caret",f),f=F(f,c),i("tildes",f),f=_(f,c),i("xrange",f),f=G(f,c),i("stars",f),f),R=f=>!f||f.toLowerCase()==="x"||f==="*",F=(f,c)=>f.trim().split(/\s+/).map(E=>T(E,c)).join(" "),T=(f,c)=>{const E=c.loose?s[y.TILDELOOSE]:s[y.TILDE];return f.replace(E,(g,w,h,O,C)=>{i("tilde",f,g,w,h,O,C);let D;return R(w)?D="":R(h)?D=`>=${w}.0.0 <${+w+1}.0.0-0`:R(O)?D=`>=${w}.${h}.0 <${w}.${+h+1}.0-0`:C?(i("replaceTilde pr",C),D=`>=${w}.${h}.${O}-${C} <${w}.${+h+1}.0-0`):D=`>=${w}.${h}.${O} <${w}.${+h+1}.0-0`,i("tilde return",D),D})},S=(f,c)=>f.trim().split(/\s+/).map(E=>V(E,c)).join(" "),V=(f,c)=>{i("caret",f,c);const E=c.loose?s[y.CARETLOOSE]:s[y.CARET],g=c.includePrerelease?"-0":"";return f.replace(E,(w,h,O,C,D)=>{i("caret",f,w,h,O,C,D);let U;return R(h)?U="":R(O)?U=`>=${h}.0.0${g} <${+h+1}.0.0-0`:R(C)?h==="0"?U=`>=${h}.${O}.0${g} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.0${g} <${+h+1}.0.0-0`:D?(i("replaceCaret pr",D),h==="0"?O==="0"?U=`>=${h}.${O}.${C}-${D} <${h}.${O}.${+C+1}-0`:U=`>=${h}.${O}.${C}-${D} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.${C}-${D} <${+h+1}.0.0-0`):(i("no pr"),h==="0"?O==="0"?U=`>=${h}.${O}.${C}${g} <${h}.${O}.${+C+1}-0`:U=`>=${h}.${O}.${C}${g} <${h}.${+O+1}.0-0`:U=`>=${h}.${O}.${C} <${+h+1}.0.0-0`),i("caret return",U),U})},_=(f,c)=>(i("replaceXRanges",f,c),f.split(/\s+/).map(E=>x(E,c)).join(" ")),x=(f,c)=>{f=f.trim();const E=c.loose?s[y.XRANGELOOSE]:s[y.XRANGE];return f.replace(E,(g,w,h,O,C,D)=>{i("xRange",f,g,w,h,O,C,D);const U=R(h),j=U||R(O),k=j||R(C),ce=k;return w==="="&&ce&&(w=""),D=c.includePrerelease?"-0":"",U?w===">"||w==="<"?g="<0.0.0-0":g="*":w&&ce?(j&&(O=0),C=0,w===">"?(w=">=",j?(h=+h+1,O=0,C=0):(O=+O+1,C=0)):w==="<="&&(w="<",j?h=+h+1:O=+O+1),w==="<"&&(D="-0"),g=`${w+h}.${O}.${C}${D}`):j?g=`>=${h}.0.0${D} <${+h+1}.0.0-0`:k&&(g=`>=${h}.${O}.0${D} <${h}.${+O+1}.0-0`),i("xRange return",g),g})},G=(f,c)=>(i("replaceStars",f,c),f.trim().replace(s[y.STAR],"")),X=(f,c)=>(i("replaceGTE0",f,c),f.trim().replace(s[c.includePrerelease?y.GTE0PRE:y.GTE0],"")),Fe=f=>(c,E,g,w,h,O,C,D,U,j,k,ce)=>(R(g)?E="":R(w)?E=`>=${g}.0.0${f?"-0":""}`:R(h)?E=`>=${g}.${w}.0${f?"-0":""}`:O?E=`>=${E}`:E=`>=${E}${f?"-0":""}`,R(U)?D="":R(j)?D=`<${+U+1}.0.0-0`:R(k)?D=`<${U}.${+j+1}.0-0`:ce?D=`<=${U}.${j}.${k}-${ce}`:f?D=`<${U}.${j}.${+k+1}-0`:D=`<=${D}`,`${E} ${D}`.trim()),be=(f,c,E)=>{for(let g=0;g<f.length;g++)if(!f[g].test(c))return!1;if(c.prerelease.length&&!E.includePrerelease){for(let g=0;g<f.length;g++)if(i(f[g].semver),f[g].semver!==p.ANY&&f[g].semver.prerelease.length>0){const w=f[g].semver;if(w.major===c.major&&w.minor===c.minor&&w.patch===c.patch)return!0}return!1}return!0};return Be}var He,_t;function $e(){if(_t)return He;_t=1;const e=Symbol("SemVer ANY");class t{static get ANY(){return e}constructor(o,m){if(m=a(m),o instanceof t){if(o.loose===!!m.loose)return o;o=o.value}o=o.trim().split(/\s+/).join(" "),i("comparator",o,m),this.options=m,this.loose=!!m.loose,this.parse(o),this.semver===e?this.value="":this.value=this.operator+this.semver.version,i("comp",this)}parse(o){const m=this.options.loose?n[r.COMPARATORLOOSE]:n[r.COMPARATOR],v=o.match(m);if(!v)throw new TypeError(`Invalid comparator: ${o}`);this.operator=v[1]!==void 0?v[1]:"",this.operator==="="&&(this.operator=""),v[2]?this.semver=new u(v[2],this.options.loose):this.semver=e}toString(){return this.value}test(o){if(i("Comparator.test",o,this.options.loose),this.semver===e||o===e)return!0;if(typeof o=="string")try{o=new u(o,this.options)}catch{return!1}return p(o,this.operator,this.semver,this.options)}intersects(o,m){if(!(o instanceof t))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new s(o.value,m).test(this.value):o.operator===""?o.value===""?!0:new s(this.value,m).test(o.semver):(m=a(m),m.includePrerelease&&(this.value==="<0.0.0-0"||o.value==="<0.0.0-0")||!m.includePrerelease&&(this.value.startsWith("<0.0.0")||o.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&o.operator.startsWith(">")||this.operator.startsWith("<")&&o.operator.startsWith("<")||this.semver.version===o.semver.version&&this.operator.includes("=")&&o.operator.includes("=")||p(this.semver,"<",o.semver,m)&&this.operator.startsWith(">")&&o.operator.startsWith("<")||p(this.semver,">",o.semver,m)&&this.operator.startsWith("<")&&o.operator.startsWith(">")))}}He=t;const a=It,{safeRe:n,t:r}=fe,p=qn,i=Me,u=xt,s=q();return He}const Qn=q(),er=(e,t,a)=>{try{t=new Qn(t,a)}catch{return!1}return t.test(e)};var tr=er;q();q();q();q();q();const ar=$e(),{ANY:ns}=ar;q();q();q();const Ot=$e(),{ANY:rs}=Ot;new Ot(">=0.0.0-0");new Ot(">=0.0.0");const ze=fe,kt=Ne,Bt=pa;$e();q();const nr=tr;var ie={satisfies:nr,re:ze.re,src:ze.src,tokens:ze.t,SEMVER_SPEC_VERSION:kt.SEMVER_SPEC_VERSION,RELEASE_TYPES:kt.RELEASE_TYPES,compareIdentifiers:Bt.compareIdentifiers,rcompareIdentifiers:Bt.rcompareIdentifiers};const ss=[{inputs:[{name:"preOpGas",type:"uint256"},{name:"paid",type:"uint256"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"targetSuccess",type:"bool"},{name:"targetResult",type:"bytes"}],name:"ExecutionResult",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"}],name:"ValidationResult",type:"error"},{inputs:[{components:[{name:"preOpGas",type:"uint256"},{name:"prefund",type:"uint256"},{name:"sigFailed",type:"bool"},{name:"validAfter",type:"uint48"},{name:"validUntil",type:"uint48"},{name:"paymasterContext",type:"bytes"}],name:"returnInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"senderInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"factoryInfo",type:"tuple"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"paymasterInfo",type:"tuple"},{components:[{name:"aggregator",type:"address"},{components:[{name:"stake",type:"uint256"},{name:"unstakeDelaySec",type:"uint256"}],name:"stakeInfo",type:"tuple"}],name:"aggregatorInfo",type:"tuple"}],name:"ValidationResultWithAggregation",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[],name:"SIG_VALIDATION_FAILED",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"},{name:"sender",type:"address"},{name:"paymasterAndData",type:"bytes"}],name:"_validateSenderAndPaymaster",outputs:[],stateMutability:"view",type:"function"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint112"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"op",type:"tuple"},{name:"target",type:"address"},{name:"targetCallData",type:"bytes"}],name:"simulateHandleOp",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"callGasLimit",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"simulateValidation",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}],is=[{inputs:[{name:"success",type:"bool"},{name:"ret",type:"bytes"}],name:"DelegateAndRevert",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"}],name:"FailedOp",type:"error"},{inputs:[{name:"opIndex",type:"uint256"},{name:"reason",type:"string"},{name:"inner",type:"bytes"}],name:"FailedOpWithRevert",type:"error"},{inputs:[{name:"returnData",type:"bytes"}],name:"PostOpReverted",type:"error"},{inputs:[],name:"ReentrancyGuardReentrantCall",type:"error"},{inputs:[{name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{name:"aggregator",type:"address"}],name:"SignatureValidationFailed",type:"error"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"factory",type:"address"},{indexed:!1,name:"paymaster",type:"address"}],name:"AccountDeployed",type:"event"},{anonymous:!1,inputs:[],name:"BeforeExecution",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalDeposit",type:"uint256"}],name:"Deposited",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"PostOpRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"aggregator",type:"address"}],name:"SignatureAggregatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"totalStaked",type:"uint256"},{indexed:!1,name:"unstakeDelaySec",type:"uint256"}],name:"StakeLocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawTime",type:"uint256"}],name:"StakeUnlocked",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"StakeWithdrawn",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!0,name:"paymaster",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"success",type:"bool"},{indexed:!1,name:"actualGasCost",type:"uint256"},{indexed:!1,name:"actualGasUsed",type:"uint256"}],name:"UserOperationEvent",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"}],name:"UserOperationPrefundTooLow",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"userOpHash",type:"bytes32"},{indexed:!0,name:"sender",type:"address"},{indexed:!1,name:"nonce",type:"uint256"},{indexed:!1,name:"revertReason",type:"bytes"}],name:"UserOperationRevertReason",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"account",type:"address"},{indexed:!1,name:"withdrawAddress",type:"address"},{indexed:!1,name:"amount",type:"uint256"}],name:"Withdrawn",type:"event"},{inputs:[{name:"unstakeDelaySec",type:"uint32"}],name:"addStake",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"balanceOf",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"target",type:"address"},{name:"data",type:"bytes"}],name:"delegateAndRevert",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"account",type:"address"}],name:"depositTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{name:"",type:"address"}],name:"deposits",outputs:[{name:"deposit",type:"uint256"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{name:"account",type:"address"}],name:"getDepositInfo",outputs:[{components:[{name:"deposit",type:"uint256"},{name:"staked",type:"bool"},{name:"stake",type:"uint112"},{name:"unstakeDelaySec",type:"uint32"},{name:"withdrawTime",type:"uint48"}],name:"info",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOp",type:"tuple"}],name:"getUserOpHash",outputs:[{name:"",type:"bytes32"}],stateMutability:"view",type:"function"},{inputs:[{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"userOps",type:"tuple[]"},{name:"aggregator",type:"address"},{name:"signature",type:"bytes"}],name:"opsPerAggregator",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleAggregatedOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"initCode",type:"bytes"},{name:"callData",type:"bytes"},{name:"accountGasLimits",type:"bytes32"},{name:"preVerificationGas",type:"uint256"},{name:"gasFees",type:"bytes32"},{name:"paymasterAndData",type:"bytes"},{name:"signature",type:"bytes"}],name:"ops",type:"tuple[]"},{name:"beneficiary",type:"address"}],name:"handleOps",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"key",type:"uint192"}],name:"incrementNonce",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"callData",type:"bytes"},{components:[{components:[{name:"sender",type:"address"},{name:"nonce",type:"uint256"},{name:"verificationGasLimit",type:"uint256"},{name:"callGasLimit",type:"uint256"},{name:"paymasterVerificationGasLimit",type:"uint256"},{name:"paymasterPostOpGasLimit",type:"uint256"},{name:"preVerificationGas",type:"uint256"},{name:"paymaster",type:"address"},{name:"maxFeePerGas",type:"uint256"},{name:"maxPriorityFeePerGas",type:"uint256"}],name:"mUserOp",type:"tuple"},{name:"userOpHash",type:"bytes32"},{name:"prefund",type:"uint256"},{name:"contextOffset",type:"uint256"},{name:"preOpGas",type:"uint256"}],name:"opInfo",type:"tuple"},{name:"context",type:"bytes"}],name:"innerHandleOp",outputs:[{name:"actualGasCost",type:"uint256"}],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"",type:"address"},{name:"",type:"uint192"}],name:"nonceSequenceNumber",outputs:[{name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{name:"interfaceId",type:"bytes4"}],name:"supportsInterface",outputs:[{name:"",type:"bool"}],stateMutability:"view",type:"function"},{inputs:[],name:"unlockStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"}],name:"withdrawStake",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{name:"withdrawAddress",type:"address"},{name:"withdrawAmount",type:"uint256"}],name:"withdrawTo",outputs:[],stateMutability:"nonpayable",type:"function"},{stateMutability:"payable",type:"receive"}];function ua(e,t={}){const{forHash:a}=t,{authorization:n,factory:r,factoryData:p}=e;return a&&(r==="0x7702"||r==="0x7702000000000000000000000000000000000000")?n?z([n.address,p??"0x"]):"0x7702000000000000000000000000000000000000":r?z([r,p??"0x"]):"0x"}const Ht="0x22e325a297439656";function ya(e,t={}){const{callGasLimit:a,callData:n,maxPriorityFeePerGas:r,maxFeePerGas:p,paymaster:i,paymasterData:u,paymasterPostOpGasLimit:s,paymasterSignature:y,paymasterVerificationGasLimit:o,sender:m,signature:v="0x",verificationGasLimit:A}=e,d=z([M(N(A||0n),{size:16}),M(N(a||0n),{size:16})]),l=ua(e,t),b=z([M(N(r||0n),{size:16}),M(N(p||0n),{size:16})]),P=e.nonce??0n,L=i?z([i,M(N(o||0n),{size:16}),M(N(s||0n),{size:16}),u||"0x",...y?t.forHash?[Ht]:[y,M(N(Oa(y)),{size:2}),Ht]:[]]):"0x",R=e.preVerificationGas??0n;return{accountGasLimits:d,callData:n,initCode:l,gasFees:b,nonce:P,paymasterAndData:L,preVerificationGas:R,sender:m,signature:v}}const rr={PackedUserOperation:[{type:"address",name:"sender"},{type:"uint256",name:"nonce"},{type:"bytes",name:"initCode"},{type:"bytes",name:"callData"},{type:"bytes32",name:"accountGasLimits"},{type:"uint256",name:"preVerificationGas"},{type:"bytes32",name:"gasFees"},{type:"bytes",name:"paymasterAndData"}]};function sr(e){const{chainId:t,entryPointAddress:a,userOperation:n}=e,r=ya(n,{forHash:!0});return{types:rr,primaryType:"PackedUserOperation",domain:{name:"ERC4337",version:"1",chainId:t,verifyingContract:a},message:r}}function os(e){const{chainId:t,entryPointAddress:a,entryPointVersion:n}=e,r=e.userOperation,{authorization:p,callData:i="0x",callGasLimit:u,maxFeePerGas:s,maxPriorityFeePerGas:y,nonce:o,paymasterAndData:m="0x",preVerificationGas:v,sender:A,verificationGasLimit:d}=r;if(n==="0.8"||n==="0.9")return Pa(sr({chainId:t,entryPointAddress:a,userOperation:r}));const l=(()=>{var b,P;if(n==="0.6"){const L=(b=r.initCode)==null?void 0:b.slice(0,42),R=(P=r.initCode)==null?void 0:P.slice(42),F=ua({authorization:p,factory:L,factoryData:R},{forHash:!0});return ee([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"uint256"},{type:"bytes32"}],[A,o,W(F),W(i),u,d,v,s,y,W(m)])}if(n==="0.7"){const L=ya(r,{forHash:!0});return ee([{type:"address"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"},{type:"bytes32"},{type:"uint256"},{type:"bytes32"},{type:"bytes32"}],[L.sender,L.nonce,W(L.initCode),W(L.callData),L.accountGasLimits,L.preVerificationGas,L.gasFees,W(L.paymasterAndData)])}throw new Error(`entryPointVersion "${n}" not supported.`)})();return W(ee([{type:"bytes32"},{type:"address"},{type:"uint256"}],[W(l),a,BigInt(t)]))}async function ps(e){const{extend:t,nonceKeyManager:a=un({source:{get(){return Date.now()},set(){}}}),...n}=e;let r=!1;const p=await e.getAddress();return{...t,...n,address:p,async getFactoryArgs(){return"isDeployed"in this&&await this.isDeployed()?{factory:void 0,factoryData:void 0}:e.getFactoryArgs()},async getNonce(i){const u=(i==null?void 0:i.key)??BigInt(await a.consume({address:p,chainId:e.client.chain.id,client:e.client}));return e.getNonce?await e.getNonce({...i,key:u}):await ue(e.client,{abi:ea(["function getNonce(address, uint192) pure returns (uint256)"]),address:e.entryPoint.address,functionName:"getNonce",args:[p,u]})},async isDeployed(){return r?!0:(r=!!await $(e.client,Aa,"getCode")({address:p}),r)},...e.sign?{async sign(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.sign(i)]);return u&&s?Ve({address:u,data:s,signature:y}):y}}:{},async signMessage(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.signMessage(i)]);return u&&s&&u!=="0x7702"?Ve({address:u,data:s,signature:y}):y},async signTypedData(i){const[{factory:u,factoryData:s},y]=await Promise.all([this.getFactoryArgs(),e.signTypedData(i)]);return u&&s&&u!=="0x7702"?Ve({address:u,data:s,signature:y}):y},type:"smart"}}function ir(e){if(typeof e=="string"){if(!Dt(e,{strict:!1}))throw new Rt({address:e});return{address:e,type:"json-rpc"}}if(!Dt(e.address,{strict:!1}))throw new Rt({address:e.address});return{address:e.address,nonceManager:e.nonceManager,sign:e.sign,signAuthorization:e.signAuthorization,signMessage:e.signMessage,signTransaction:e.signTransaction,signTypedData:e.signTypedData,source:"custom",type:"local"}}class Je extends I{constructor({cause:t}){super("Smart Account is not deployed.",{cause:t,metaMessages:["This could arise when:","- No `factory`/`factoryData` or `initCode` properties are provided for Smart Account deployment.","- An incorrect `sender` address is provided."],name:"AccountNotDeployedError"})}}Object.defineProperty(Je,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa20/});class oe extends I{constructor({cause:t,data:a,message:n}={}){var p;const r=(p=n==null?void 0:n.replace("execution reverted: ",""))==null?void 0:p.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:t,name:"ExecutionRevertedError"}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=a}}Object.defineProperty(oe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32521});Object.defineProperty(oe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted/});class Qe extends I{constructor({cause:t}){super("Failed to send funds to beneficiary.",{cause:t,name:"FailedToSendToBeneficiaryError"})}}Object.defineProperty(Qe,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa91/});class et extends I{constructor({cause:t}){super("Gas value overflowed.",{cause:t,metaMessages:["This could arise when:","- one of the gas values exceeded 2**120 (uint120)"].filter(Boolean),name:"GasValuesOverflowError"})}}Object.defineProperty(et,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa94/});class tt extends I{constructor({cause:t}){super("The `handleOps` function was called by the Bundler with a gas limit too low.",{cause:t,name:"HandleOpsOutOfGasError"})}}Object.defineProperty(tt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa95/});class at extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Failed to simulate deployment for Smart Account.",{cause:t,metaMessages:["This could arise when:","- Invalid `factory`/`factoryData` or `initCode` properties are present","- Smart Account deployment execution ran out of gas (low `verificationGasLimit` value)",`- Smart Account deployment execution reverted with an error
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeFailedError"})}}Object.defineProperty(at,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa13/});class nt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Smart Account initialization implementation did not create an account.",{cause:t,metaMessages:["This could arise when:","- `factory`/`factoryData` or `initCode` properties are invalid",`- Smart Account initialization implementation is incorrect
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`].filter(Boolean),name:"InitCodeMustCreateSenderError"})}}Object.defineProperty(nt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa15/});class rt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r,sender:p}){super("Smart Account initialization implementation does not return the expected sender.",{cause:t,metaMessages:["This could arise when:",`Smart Account initialization implementation does not return a sender address
`,a&&`factory: ${a}`,n&&`factoryData: ${n}`,r&&`initCode: ${r}`,p&&`sender: ${p}`].filter(Boolean),name:"InitCodeMustReturnSenderError"})}}Object.defineProperty(rt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa14/});class st extends I{constructor({cause:t}){super("Smart Account does not have sufficient funds to execute the User Operation.",{cause:t,metaMessages:["This could arise when:","- the Smart Account does not have sufficient funds to cover the required prefund, or","- a Paymaster was not provided"].filter(Boolean),name:"InsufficientPrefundError"})}}Object.defineProperty(st,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa21/});class it extends I{constructor({cause:t}){super("Bundler attempted to call an invalid function on the EntryPoint.",{cause:t,name:"InternalCallOnlyError"})}}Object.defineProperty(it,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa92/});class ot extends I{constructor({cause:t}){super("Bundler used an invalid aggregator for handling aggregated User Operations.",{cause:t,name:"InvalidAggregatorError"})}}Object.defineProperty(ot,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa96/});class pt extends I{constructor({cause:t,nonce:a}){super("Invalid Smart Account nonce used for User Operation.",{cause:t,metaMessages:[a&&`nonce: ${a}`].filter(Boolean),name:"InvalidAccountNonceError"})}}Object.defineProperty(pt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa25/});class ut extends I{constructor({cause:t}){super("Bundler has not set a beneficiary address.",{cause:t,name:"InvalidBeneficiaryError"})}}Object.defineProperty(ut,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa90/});class xe extends I{constructor({cause:t}){super("Invalid fields set on User Operation.",{cause:t,name:"InvalidFieldsError"})}}Object.defineProperty(xe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class yt extends I{constructor({cause:t,paymasterAndData:a}){super("Paymaster properties provided are invalid.",{cause:t,metaMessages:["This could arise when:","- the `paymasterAndData` property is of an incorrect length\n",a&&`paymasterAndData: ${a}`].filter(Boolean),name:"InvalidPaymasterAndDataError"})}}Object.defineProperty(yt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa93/});class re extends I{constructor({cause:t}){super("Paymaster deposit for the User Operation is too low.",{cause:t,metaMessages:["This could arise when:","- the Paymaster has deposited less than the expected amount via the `deposit` function"].filter(Boolean),name:"PaymasterDepositTooLowError"})}}Object.defineProperty(re,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32508});Object.defineProperty(re,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa31/});class lt extends I{constructor({cause:t}){super("The `validatePaymasterUserOp` function on the Paymaster reverted.",{cause:t,name:"PaymasterFunctionRevertedError"})}}Object.defineProperty(lt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa33/});class dt extends I{constructor({cause:t}){super("The Paymaster contract has not been deployed.",{cause:t,name:"PaymasterNotDeployedError"})}}Object.defineProperty(dt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa30/});class Oe extends I{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterRateLimitError"})}}Object.defineProperty(Oe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32504});class Pe extends I{constructor({cause:t}){super("UserOperation rejected because paymaster (or signature aggregator) is throttled/banned.",{cause:t,name:"PaymasterStakeTooLowError"})}}Object.defineProperty(Pe,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32505});class ct extends I{constructor({cause:t}){super("Paymaster `postOp` function reverted.",{cause:t,name:"PaymasterPostOpFunctionRevertedError"})}}Object.defineProperty(ct,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa50/});class mt extends I{constructor({cause:t,factory:a,factoryData:n,initCode:r}){super("Smart Account has already been deployed.",{cause:t,metaMessages:["Remove the following properties and try again:",a&&"`factory`",n&&"`factoryData`",r&&"`initCode`"].filter(Boolean),name:"SenderAlreadyConstructedError"})}}Object.defineProperty(mt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa10/});class Ae extends I{constructor({cause:t}){super("UserOperation rejected because account signature check failed (or paymaster signature, if the paymaster uses its data as signature).",{cause:t,name:"SignatureCheckFailedError"})}}Object.defineProperty(Ae,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32507});class ft extends I{constructor({cause:t}){super("The `validateUserOp` function on the Smart Account reverted.",{cause:t,name:"SmartAccountFunctionRevertedError"})}}Object.defineProperty(ft,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa23/});class De extends I{constructor({cause:t}){super("UserOperation rejected because account specified unsupported signature aggregator.",{cause:t,name:"UnsupportedSignatureAggregatorError"})}}Object.defineProperty(De,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32506});class bt extends I{constructor({cause:t}){super("User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validateUserOp` on the Smart Account are not satisfied"].filter(Boolean),name:"UserOperationExpiredError"})}}Object.defineProperty(bt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa22/});class gt extends I{constructor({cause:t}){super("Paymaster for User Operation expired.",{cause:t,metaMessages:["This could arise when:","- the `validAfter` or `validUntil` values returned from `validatePaymasterUserOp` on the Paymaster are not satisfied"].filter(Boolean),name:"UserOperationPaymasterExpiredError"})}}Object.defineProperty(gt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa32/});class ht extends I{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Smart Account"].filter(Boolean),name:"UserOperationSignatureError"})}}Object.defineProperty(ht,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa24/});class Tt extends I{constructor({cause:t}){super("Signature provided for the User Operation is invalid.",{cause:t,metaMessages:["This could arise when:","- the `signature` for the User Operation is incorrectly computed, and unable to be verified by the Paymaster"].filter(Boolean),name:"UserOperationPaymasterSignatureError"})}}Object.defineProperty(Tt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa34/});class Re extends I{constructor({cause:t}){super("User Operation rejected by EntryPoint's `simulateValidation` during account creation or validation.",{cause:t,name:"UserOperationRejectedByEntryPointError"})}}Object.defineProperty(Re,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32500});class Ge extends I{constructor({cause:t}){super("User Operation rejected by Paymaster's `validatePaymasterUserOp`.",{cause:t,name:"UserOperationRejectedByPaymasterError"})}}Object.defineProperty(Ge,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32501});class Le extends I{constructor({cause:t}){super("User Operation rejected with op code validation error.",{cause:t,name:"UserOperationRejectedByOpCodeError"})}}Object.defineProperty(Le,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32502});class Ce extends I{constructor({cause:t}){super("UserOperation out of time-range: either wallet or paymaster returned a time-range, and it is already expired (or will expire soon).",{cause:t,name:"UserOperationOutOfTimeRangeError"})}}Object.defineProperty(Ce,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32503});class or extends I{constructor({cause:t}){super(`An error occurred while executing user operation: ${t==null?void 0:t.shortMessage}`,{cause:t,name:"UnknownBundlerError"})}}class Et extends I{constructor({cause:t}){super("User Operation verification gas limit exceeded.",{cause:t,metaMessages:["This could arise when:","- the gas used for verification exceeded the `verificationGasLimit`"].filter(Boolean),name:"VerificationGasLimitExceededError"})}}Object.defineProperty(Et,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa40/});class wt extends I{constructor({cause:t}){super("User Operation verification gas limit is too low.",{cause:t,metaMessages:["This could arise when:","- the `verificationGasLimit` is too low to verify the User Operation"].filter(Boolean),name:"VerificationGasLimitTooLowError"})}}Object.defineProperty(wt,"message",{enumerable:!0,configurable:!0,writable:!0,value:/aa41/});class pr extends I{constructor(t,{callData:a,callGasLimit:n,docsPath:r,factory:p,factoryData:i,initCode:u,maxFeePerGas:s,maxPriorityFeePerGas:y,nonce:o,paymaster:m,paymasterAndData:v,paymasterData:A,paymasterPostOpGasLimit:d,paymasterVerificationGasLimit:l,preVerificationGas:b,sender:P,signature:L,verificationGasLimit:R}){const F=Da({callData:a,callGasLimit:n,factory:p,factoryData:i,initCode:u,maxFeePerGas:typeof s<"u"&&`${Gt(s)} gwei`,maxPriorityFeePerGas:typeof y<"u"&&`${Gt(y)} gwei`,nonce:o,paymaster:m,paymasterAndData:v,paymasterData:A,paymasterPostOpGasLimit:d,paymasterVerificationGasLimit:l,preVerificationGas:b,sender:P,signature:L,verificationGasLimit:R});super(t.shortMessage,{cause:t,docsPath:r,metaMessages:[...t.metaMessages?[...t.metaMessages," "]:[],"Request Arguments:",F].filter(Boolean),name:"UserOperationExecutionError"}),Object.defineProperty(this,"cause",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cause=t}}class ur extends I{constructor({hash:t}){super(`User Operation receipt with hash "${t}" could not be found. The User Operation may not have been processed yet.`,{name:"UserOperationReceiptNotFoundError"})}}class yr extends I{constructor({hash:t}){super(`User Operation with hash "${t}" could not be found.`,{name:"UserOperationNotFoundError"})}}class zt extends I{constructor({hash:t}){super(`Timed out while waiting for User Operation with hash "${t}" to be confirmed.`,{name:"WaitForUserOperationReceiptTimeoutError"})}}const lr=[oe,xe,re,Oe,Pe,Ae,De,Ce,Re,Ge,Le];function dr(e,t){const a=(e.details||"").toLowerCase();if(Je.message.test(a))return new Je({cause:e});if(Qe.message.test(a))return new Qe({cause:e});if(et.message.test(a))return new et({cause:e});if(tt.message.test(a))return new tt({cause:e});if(at.message.test(a))return new at({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(nt.message.test(a))return new nt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(rt.message.test(a))return new rt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode,sender:t.sender});if(st.message.test(a))return new st({cause:e});if(it.message.test(a))return new it({cause:e});if(pt.message.test(a))return new pt({cause:e,nonce:t.nonce});if(ot.message.test(a))return new ot({cause:e});if(ut.message.test(a))return new ut({cause:e});if(yt.message.test(a))return new yt({cause:e});if(re.message.test(a))return new re({cause:e});if(lt.message.test(a))return new lt({cause:e});if(dt.message.test(a))return new dt({cause:e});if(ct.message.test(a))return new ct({cause:e});if(ft.message.test(a))return new ft({cause:e});if(mt.message.test(a))return new mt({cause:e,factory:t.factory,factoryData:t.factoryData,initCode:t.initCode});if(bt.message.test(a))return new bt({cause:e});if(gt.message.test(a))return new gt({cause:e});if(Tt.message.test(a))return new Tt({cause:e});if(ht.message.test(a))return new ht({cause:e});if(Et.message.test(a))return new Et({cause:e});if(wt.message.test(a))return new wt({cause:e});const n=e.walk(r=>lr.some(p=>p.code===r.code));if(n){if(n.code===oe.code)return new oe({cause:e,data:n.data,message:n.details});if(n.code===xe.code)return new xe({cause:e});if(n.code===re.code)return new re({cause:e});if(n.code===Oe.code)return new Oe({cause:e});if(n.code===Pe.code)return new Pe({cause:e});if(n.code===Ae.code)return new Ae({cause:e});if(n.code===De.code)return new De({cause:e});if(n.code===Ce.code)return new Ce({cause:e});if(n.code===Re.code)return new Re({cause:e});if(n.code===Ge.code)return new Ge({cause:e});if(n.code===Le.code)return new Le({cause:e})}return new or({cause:e})}function la(e,{calls:t,docsPath:a,...n}){const r=(()=>{const p=dr(e,n);if(t&&p instanceof oe){const i=cr(p),u=t==null?void 0:t.filter(s=>s.abi);if(i&&u.length>0)return mr({calls:u,revertData:i})}return p})();return new pr(r,{docsPath:a,...n})}function cr(e){let t;return e.walk(a=>{var r,p,i,u;const n=a;if(typeof n.data=="string"||typeof((r=n.data)==null?void 0:r.revertData)=="string"||!(n instanceof I)&&typeof n.message=="string"){const s=(u=(i=((p=n.data)==null?void 0:p.revertData)||n.data||n.message).match)==null?void 0:u.call(i,/(0x[A-Za-z0-9]*)/);if(s)return t=s[1],!0}return!1}),t}function mr(e){const{calls:t,revertData:a}=e,{abi:n,functionName:r,args:p,to:i}=(()=>{const s=t==null?void 0:t.filter(o=>!!o.abi);if(s.length===1)return s[0];const y=s.filter(o=>{try{return!!ve({abi:o.abi,data:a})}catch{return!1}});return y.length===1?y[0]:{abi:[],functionName:s.reduce((o,m)=>`${o?`${o} | `:""}${m.functionName}`,""),args:void 0,to:void 0}})(),u=a==="0x"?new Ra({functionName:r}):new Xe({abi:n,data:a,functionName:r});return new Ga(u,{abi:n,args:p,contractAddress:i,functionName:r})}function fr(e){const t={};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),t}function Ue(e){const t={};return typeof e.callData<"u"&&(t.callData=e.callData),typeof e.callGasLimit<"u"&&(t.callGasLimit=N(e.callGasLimit)),typeof e.factory<"u"&&(t.factory=e.factory),typeof e.factoryData<"u"&&(t.factoryData=e.factoryData),typeof e.initCode<"u"&&(t.initCode=e.initCode),typeof e.maxFeePerGas<"u"&&(t.maxFeePerGas=N(e.maxFeePerGas)),typeof e.maxPriorityFeePerGas<"u"&&(t.maxPriorityFeePerGas=N(e.maxPriorityFeePerGas)),typeof e.nonce<"u"&&(t.nonce=N(e.nonce)),typeof e.paymaster<"u"&&(t.paymaster=e.paymaster),typeof e.paymasterAndData<"u"&&(t.paymasterAndData=e.paymasterAndData||"0x"),typeof e.paymasterData<"u"&&(t.paymasterData=e.paymasterData),typeof e.paymasterPostOpGasLimit<"u"&&(t.paymasterPostOpGasLimit=N(e.paymasterPostOpGasLimit)),typeof e.paymasterSignature<"u"&&(t.paymasterSignature=e.paymasterSignature),typeof e.paymasterVerificationGasLimit<"u"&&(t.paymasterVerificationGasLimit=N(e.paymasterVerificationGasLimit)),typeof e.preVerificationGas<"u"&&(t.preVerificationGas=N(e.preVerificationGas)),typeof e.sender<"u"&&(t.sender=e.sender),typeof e.signature<"u"&&(t.signature=e.signature),typeof e.verificationGasLimit<"u"&&(t.verificationGasLimit=N(e.verificationGasLimit)),typeof e.authorization<"u"&&(t.eip7702Auth=br(e.authorization)),t}function br(e){return{address:e.address,chainId:N(e.chainId),nonce:N(e.nonce),r:e.r?N(BigInt(e.r),{size:32}):M("0x",{size:32}),s:e.s?N(BigInt(e.s),{size:32}):M("0x",{size:32}),yParity:e.yParity?N(e.yParity,{size:1}):M("0x",{size:32})}}async function gr(e,t){const{chainId:a,entryPointAddress:n,context:r,...p}=t,i=Ue(p),{paymasterPostOpGasLimit:u,paymasterVerificationGasLimit:s,...y}=await e.request({method:"pm_getPaymasterData",params:[{...i,callGasLimit:i.callGasLimit??"0x0",verificationGasLimit:i.verificationGasLimit??"0x0",preVerificationGas:i.preVerificationGas??"0x0"},n,N(a),r]});return{...y,...u&&{paymasterPostOpGasLimit:me(u)},...s&&{paymasterVerificationGasLimit:me(s)}}}async function hr(e,t){const{chainId:a,entryPointAddress:n,context:r,...p}=t,i=Ue(p),{paymasterPostOpGasLimit:u,paymasterVerificationGasLimit:s,...y}=await e.request({method:"pm_getPaymasterStubData",params:[{...i,callGasLimit:i.callGasLimit??"0x0",verificationGasLimit:i.verificationGasLimit??"0x0",preVerificationGas:i.preVerificationGas??"0x0"},n,N(a),r]});return{...y,...u&&{paymasterPostOpGasLimit:me(u)},...s&&{paymasterVerificationGasLimit:me(s)}}}const Tr=["factory","fees","gas","paymaster","nonce","signature","authorization"];async function pe(e,t){var V,_;const a=t,{account:n=e.account,dataSuffix:r=typeof e.dataSuffix=="string"?e.dataSuffix:(V=e.dataSuffix)==null?void 0:V.value,parameters:p=Tr,stateOverride:i}=a;if(!n)throw new vt;const u=K(n),s=e,y=a.paymaster??(s==null?void 0:s.paymaster),o=typeof y=="string"?y:void 0,{getPaymasterStubData:m,getPaymasterData:v}=(()=>{if(y===!0)return{getPaymasterStubData:x=>$(s,hr,"getPaymasterStubData")(x),getPaymasterData:x=>$(s,gr,"getPaymasterData")(x)};if(typeof y=="object"){const{getPaymasterStubData:x,getPaymasterData:G}=y;return{getPaymasterStubData:G&&x?x:G,getPaymasterData:G&&x?G:void 0}}return{getPaymasterStubData:void 0,getPaymasterData:void 0}})(),A=a.paymasterContext?a.paymasterContext:s==null?void 0:s.paymasterContext;let d={...a,paymaster:o,sender:u.address};const[l,b,P,L,R]=await Promise.all([(async()=>a.calls?u.encodeCalls(a.calls.map(x=>{const G=x;return G.abi?{data:B(G),to:G.to,value:G.value}:G})):a.callData)(),(async()=>{if(!p.includes("factory"))return;if(a.initCode)return{initCode:a.initCode};if(a.factory&&a.factoryData)return{factory:a.factory,factoryData:a.factoryData};const{factory:x,factoryData:G}=await u.getFactoryArgs();return u.entryPoint.version==="0.6"?{initCode:x&&G?z([x,G]):void 0}:{factory:x,factoryData:G}})(),(async()=>{var x;if(p.includes("fees")){if(typeof a.maxFeePerGas=="bigint"&&typeof a.maxPriorityFeePerGas=="bigint")return d;if((x=s==null?void 0:s.userOperation)!=null&&x.estimateFeesPerGas){const G=await s.userOperation.estimateFeesPerGas({account:u,bundlerClient:s,userOperation:d});return{...d,...G}}try{const G=s.client??e,X=await $(G,La,"estimateFeesPerGas")({chain:G.chain,type:"eip1559"});return{maxFeePerGas:typeof a.maxFeePerGas=="bigint"?a.maxFeePerGas:BigInt(2n*X.maxFeePerGas),maxPriorityFeePerGas:typeof a.maxPriorityFeePerGas=="bigint"?a.maxPriorityFeePerGas:BigInt(2n*X.maxPriorityFeePerGas)}}catch{return}}})(),(async()=>{if(p.includes("nonce"))return typeof a.nonce=="bigint"?a.nonce:u.getNonce()})(),(async()=>{if(p.includes("authorization")){if(typeof a.authorization=="object")return a.authorization;if(u.authorization&&!await u.isDeployed())return{...await Ca(u.client,u.authorization),r:"0xfffffffffffffffffffffffffffffff000000000000000000000000000000000",s:"0x7aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa",yParity:1}}})()]);typeof l<"u"&&(d.callData=r?z([l,r]):l),typeof b<"u"&&(d={...d,...b}),typeof P<"u"&&(d={...d,...P}),typeof L<"u"&&(d.nonce=L),typeof R<"u"&&(d.authorization=R),p.includes("signature")&&(typeof a.signature<"u"?d.signature=a.signature:d.signature=await u.getStubSignature(d)),u.entryPoint.version==="0.6"&&!d.initCode&&(d.initCode="0x");let F;async function T(){return F||(e.chain?e.chain.id:(F=await $(e,Ie,"getChainId")({}),F))}let S=!1;if(p.includes("paymaster")&&m&&!o&&!a.paymasterAndData){const{isFinal:x=!1,sponsor:G,...X}=await m({chainId:await T(),entryPointAddress:u.entryPoint.address,context:A,...d});S=x,d={...d,...X}}if(u.entryPoint.version==="0.6"&&!d.paymasterAndData&&(d.paymasterAndData="0x"),p.includes("gas")){if((_=u.userOperation)!=null&&_.estimateGas){const x=await u.userOperation.estimateGas(d);d={...d,...x}}if(typeof d.callGasLimit>"u"||typeof d.preVerificationGas>"u"||typeof d.verificationGasLimit>"u"||d.paymaster&&typeof d.paymasterPostOpGasLimit>"u"||d.paymaster&&typeof d.paymasterVerificationGasLimit>"u"){const x=await $(s,da,"estimateUserOperationGas")({account:u,callGasLimit:0n,preVerificationGas:0n,verificationGasLimit:0n,stateOverride:i,...d.paymaster?{paymasterPostOpGasLimit:0n,paymasterVerificationGasLimit:0n}:{},...d});d={...d,callGasLimit:d.callGasLimit??x.callGasLimit,preVerificationGas:d.preVerificationGas??x.preVerificationGas,verificationGasLimit:d.verificationGasLimit??x.verificationGasLimit,paymasterPostOpGasLimit:d.paymasterPostOpGasLimit??x.paymasterPostOpGasLimit,paymasterVerificationGasLimit:d.paymasterVerificationGasLimit??x.paymasterVerificationGasLimit}}}if(p.includes("paymaster")&&v&&!o&&!a.paymasterAndData&&!S){const x=await v({chainId:await T(),entryPointAddress:u.entryPoint.address,context:A,...d});d={...d,...x}}return delete d.calls,delete d.parameters,delete d.paymasterContext,typeof d.paymaster!="string"&&delete d.paymaster,d}async function da(e,t){var s;const{account:a=e.account,entryPointAddress:n,stateOverride:r}=t;if(!a&&!t.sender)throw new vt;const p=a?K(a):void 0,i=Sa(r),u=p?await $(e,pe,"prepareUserOperation")({...t,parameters:["authorization","factory","nonce","paymaster","signature"]}):t;try{const y=[Ue(u),n??((s=p==null?void 0:p.entryPoint)==null?void 0:s.address)],o=await e.request({method:"eth_estimateUserOperationGas",params:i?[...y,i]:[...y]});return fr(o)}catch(y){const o=t.calls;throw la(y,{...u,...o?{calls:o}:{}})}}function Er(e){return e.request({method:"eth_supportedEntryPoints"})}function wr(e){const t={...e};return e.callGasLimit&&(t.callGasLimit=BigInt(e.callGasLimit)),e.maxFeePerGas&&(t.maxFeePerGas=BigInt(e.maxFeePerGas)),e.maxPriorityFeePerGas&&(t.maxPriorityFeePerGas=BigInt(e.maxPriorityFeePerGas)),e.nonce&&(t.nonce=BigInt(e.nonce)),e.paymasterPostOpGasLimit&&(t.paymasterPostOpGasLimit=BigInt(e.paymasterPostOpGasLimit)),e.paymasterVerificationGasLimit&&(t.paymasterVerificationGasLimit=BigInt(e.paymasterVerificationGasLimit)),e.preVerificationGas&&(t.preVerificationGas=BigInt(e.preVerificationGas)),e.verificationGasLimit&&(t.verificationGasLimit=BigInt(e.verificationGasLimit)),t}async function vr(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationByHash",params:[t]},{dedupe:!0});if(!a)throw new yr({hash:t});const{blockHash:n,blockNumber:r,entryPoint:p,transactionHash:i,userOperation:u}=a;return{blockHash:n,blockNumber:BigInt(r),entryPoint:p,transactionHash:i,userOperation:wr(u)}}function Ir(e){const t={...e};return e.actualGasCost&&(t.actualGasCost=BigInt(e.actualGasCost)),e.actualGasUsed&&(t.actualGasUsed=BigInt(e.actualGasUsed)),e.logs&&(t.logs=e.logs.map(a=>Na(a))),e.receipt&&(t.receipt=Ma(t.receipt)),t}async function ca(e,{hash:t}){const a=await e.request({method:"eth_getUserOperationReceipt",params:[t]},{dedupe:!0});if(!a)throw new ur({hash:t});return Ir(a)}async function ne(e,t){var s,y;const{account:a=e.account,entryPointAddress:n}=t;if(!a&&!t.sender)throw new vt;const r=a?K(a):void 0,p=r?await $(e,pe,"prepareUserOperation")(t):t,i=t.signature||await((s=r==null?void 0:r.signUserOperation)==null?void 0:s.call(r,p)),u=Ue({...p,signature:i});try{return await e.request({method:"eth_sendUserOperation",params:[u,n??((y=r==null?void 0:r.entryPoint)==null?void 0:y.address)]},{retryCount:0})}catch(o){const m=t.calls;throw la(o,{...p,...m?{calls:m}:{},signature:i})}}function ma(e,t){const{hash:a,pollingInterval:n=e.pollingInterval,retryCount:r,timeout:p=12e4}=t;let i=0;const u=$a(["waitForUserOperationReceipt",e.uid,a]);return new Promise((s,y)=>{const o=Ua(u,{resolve:s,reject:y},m=>{const v=l=>{d(),l(),o()},A=p?setTimeout(()=>v(()=>m.reject(new zt({hash:a}))),p):void 0,d=Fa(async()=>{r&&i>=r&&(clearTimeout(A),v(()=>m.reject(new zt({hash:a}))));try{const l=await $(e,ca,"getUserOperationReceipt")({hash:a});clearTimeout(A),v(()=>m.resolve(l))}catch(l){const b=l;b.name!=="UserOperationReceiptNotFoundError"&&(clearTimeout(A),v(()=>m.reject(b)))}i++},{emitOnBegin:!0,interval:n});return d})})}function we(e){return{estimateUserOperationGas:t=>da(e,t),getChainId:()=>Ie(e),getSupportedEntryPoints:()=>Er(e),getUserOperation:t=>vr(e,t),getUserOperationReceipt:t=>ca(e,t),prepareUserOperation:t=>pe(e,t),sendUserOperation:t=>ne(e,t),waitForUserOperationReceipt:t=>ma(e,t)}}const us=async(e,t)=>{const{address:a,entryPointAddress:n,key:r=BigInt(0)}=t;return await $(e,ue,"readContract")({address:n,abi:[{inputs:[{name:"sender",type:"address"},{name:"key",type:"uint192"}],name:"getNonce",outputs:[{name:"nonce",type:"uint256"}],stateMutability:"view",type:"function"}],functionName:"getNonce",args:[a,r]})};class xr extends I{constructor({cause:t,entryPointAddress:a}={}){super(`The entry point address (\`entryPoint\`${a?` = ${a}`:""}) is not a valid entry point. getSenderAddress did not revert with a SenderAddressResult error.`,{cause:t}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"InvalidEntryPointError"})}}const ys=async(e,t)=>{var i,u,s,y,o,m,v,A;const{initCode:a,entryPointAddress:n,factory:r,factoryData:p}=t;if(!a&&!r&&!p)throw new Error("Either `initCode` or `factory` and `factoryData` must be provided");try{await $(e,Va,"simulateContract")({address:n,abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"},{inputs:[{internalType:"bytes",name:"initCode",type:"bytes"}],name:"getSenderAddress",outputs:[],stateMutability:"nonpayable",type:"function"}],functionName:"getSenderAddress",args:[a||z([r,p])]})}catch(d){const l=d.walk(b=>b instanceof Xe||b instanceof Lt||b instanceof Ct||b instanceof St);if(!l){const b=d.cause;if((((i=b==null?void 0:b.data)==null?void 0:i.errorName)??"")==="SenderAddressResult"&&((u=b==null?void 0:b.data)!=null&&u.args)&&((s=b==null?void 0:b.data)!=null&&s.args[0]))return(y=b.data)==null?void 0:y.args[0]}if(l instanceof Xe&&(((o=l.data)==null?void 0:o.errorName)??"")==="SenderAddressResult"&&(m=l.data)!=null&&m.args&&(v=l.data)!=null&&v.args[0])return(A=l.data)==null?void 0:A.args[0];if(l instanceof Lt){const b=/0x[a-fA-F0-9]+/,P=l.cause.data.match(b);if(!P)throw new Error("Failed to parse revert bytes from RPC response");const L=P[0];return ve({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:L}).args[0]}if(l instanceof Ct){const{data:b}=d instanceof _a?d:d instanceof I?d.walk(R=>"data"in R)||d.walk():{},P=typeof b=="string"?b:b==null?void 0:b.data;if(P===void 0)throw new Error("Failed to parse revert bytes from RPC response");return ve({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:P}).args[0]}if(l instanceof St){const P=JSON.parse(l.cause.body).error.data,L=/0x[a-fA-F0-9]+/,R=P.match(L);if(!R)throw new Error("Failed to parse revert bytes from RPC response");const F=R[0];return ve({abi:[{inputs:[{internalType:"address",name:"sender",type:"address"}],name:"SenderAddressResult",type:"error"}],data:F}).args[0]}throw d}throw new xr({entryPointAddress:n})},Or=[{type:"function",name:"isInitialized",inputs:[{name:"smartAccount",type:"address",internalType:"address"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"}],Pr=[{inputs:[{internalType:"uint256",name:"moduleType",type:"uint256"},{internalType:"address",name:"module",type:"address"},{internalType:"bytes",name:"initData",type:"bytes"}],stateMutability:"payable",type:"function",name:"installModule"}],Ar=[{inputs:[{internalType:"uint256",name:"moduleType",type:"uint256"},{internalType:"address",name:"module",type:"address"},{internalType:"bytes",name:"additionalContext",type:"bytes"}],stateMutability:"view",type:"function",name:"isModuleInstalled",outputs:[{internalType:"bool",name:"",type:"bool"}]}],ls=async(e,t)=>{const{address:a,plugin:n}=t,{type:r,address:p,data:i="0x"}=n;try{return await $(e,ue,"readContract")({address:a,abi:Ar,functionName:"isModuleInstalled",args:[BigInt(r),p,i]})}catch{return!1}};var Q;(function(e){e.ERC1271_SIG_WRAPPER="ERC1271_SIG_WRAPPER",e.ERC1271_WITH_VALIDATOR="ERC1271_WITH_VALIDATOR",e.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH="ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH",e.ERC1271_REPLAYABLE="ERC1271_REPLAYABLE"})(Q||(Q={}));const jt={[Q.ERC1271_SIG_WRAPPER]:">=0.2.3 || >=0.3.0-beta",[Q.ERC1271_WITH_VALIDATOR]:">=0.3.0-beta",[Q.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH]:">=0.3.0-beta",[Q.ERC1271_REPLAYABLE]:">=0.3.2"},je=(e,t)=>e in jt?ie.satisfies(t,jt[e]):!1,ds=async(e,{gasToken:t,approveAmount:a,entryPoint:n})=>{var p;const r=await e.request({method:"zd_pm_accounts",params:[{chainId:(p=e.chain)==null?void 0:p.id,entryPointAddress:n.address}]});return{to:t,data:B({abi:Ba,functionName:"approve",args:[r[0],a]}),value:0n}},cs=e=>{let t=e;if(!Nt(t)&&(t=`0x${t}`,!Nt(t)))throw new Error(`Invalid signed data ${e}`);let{r:a,s:n,v:r}=ln(t);return(r===0n||r===1n)&&(r+=27n),ka({r:a,s:n,v:r})},Kt=({callType:e,execType:t})=>Y([e,t,"0x00000000","0x00000000",M("0x00000000",{size:22})]),Dr=(e,t)=>{if(e==="0.6"&&!ie.satisfies(t,">=0.2.2 || <=0.2.4")||e==="0.7"&&!ie.satisfies(t,">=0.3.0"))throw new Error("KernelVersion should be >= 0.2.2 and <= 0.2.4 for EntryPointV0.6 and >= 0.3.0 for EntryPointV0.7")},ms=(e,t)=>ie.satisfies(e,t);function Se(e){if(typeof e!="function")return e==null||typeof e=="string"||typeof e=="boolean"?e:typeof e=="bigint"||typeof e=="number"?J(e):e._isBigNumber!=null||typeof e!="object"?J(e).replace(/^0x0/,"0x"):Array.isArray(e)?e.map(t=>Se(t)):Object.keys(e).reduce((t,a)=>(t[a]=Se(e[a]),t),{})}async function fs({signer:e,address:t}){if("type"in e&&(e.type==="local"||e.type==="smart"))return e;let a;if("request"in e&&!(e!=null&&e.account)){if(t||(t=(await Promise.any([e.request({method:"eth_requestAccounts"}),e.request({method:"eth_accounts"})]))[0]),!t)throw new Error("address is required");a=Ha({account:t,transport:za(e)})}return a||(a=e),ir({address:a.account.address,async signMessage({message:n}){return Xa(a,{message:n})},async signTypedData(n){const{primaryType:r,domain:p,message:i,types:u}=n;return Ka(a,{primaryType:r,domain:p,message:i,types:u})},async signTransaction(n){throw new Error("Smart account signer doesn't need to sign transactions")},async signAuthorization(n){return ja(a,n)}})}const Pt=[{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Operation",name:"",type:"uint8"}],name:"execute",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct Call[]",name:"calls",type:"tuple[]"}],name:"executeBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"executeDelegateCall",outputs:[],stateMutability:"payable",type:"function"}],bs=[{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"}],fa=[{inputs:[{internalType:"contract IEntryPoint",name:"_entryPoint",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{inputs:[],name:"AlreadyInitialized",type:"error"},{inputs:[],name:"DisabledMode",type:"error"},{inputs:[],name:"NotAuthorizedCaller",type:"error"},{inputs:[],name:"NotEntryPoint",type:"error"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"oldValidator",type:"address"},{indexed:!0,internalType:"address",name:"newValidator",type:"address"}],name:"DefaultValidatorChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"bytes4",name:"selector",type:"bytes4"},{indexed:!0,internalType:"address",name:"executor",type:"address"},{indexed:!0,internalType:"address",name:"validator",type:"address"}],name:"ExecutionChanged",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"address",name:"sender",type:"address"},{indexed:!1,internalType:"uint256",name:"amount",type:"uint256"}],name:"Received",type:"event"},{anonymous:!1,inputs:[{indexed:!0,internalType:"address",name:"newImplementation",type:"address"}],name:"Upgraded",type:"event"},{stateMutability:"payable",type:"fallback"},{inputs:[{internalType:"bytes4",name:"_disableFlag",type:"bytes4"}],name:"disableMode",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"eip712Domain",outputs:[{internalType:"bytes1",name:"fields",type:"bytes1"},{internalType:"string",name:"name",type:"string"},{internalType:"string",name:"version",type:"string"},{internalType:"uint256",name:"chainId",type:"uint256"},{internalType:"address",name:"verifyingContract",type:"address"},{internalType:"bytes32",name:"salt",type:"bytes32"},{internalType:"uint256[]",name:"extensions",type:"uint256[]"}],stateMutability:"view",type:"function"},{inputs:[],name:"entryPoint",outputs:[{internalType:"contract IEntryPoint",name:"",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"},{internalType:"enum Operation",name:"",type:"uint8"}],name:"execute",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"to",type:"address"},{internalType:"uint256",name:"value",type:"uint256"},{internalType:"bytes",name:"data",type:"bytes"}],internalType:"struct Call[]",name:"calls",type:"tuple[]"}],name:"executeBatch",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"to",type:"address"},{internalType:"bytes",name:"data",type:"bytes"}],name:"executeDelegateCall",outputs:[],stateMutability:"payable",type:"function"},{inputs:[],name:"getDefaultValidator",outputs:[{internalType:"contract IKernelValidator",name:"validator",type:"address"}],stateMutability:"view",type:"function"},{inputs:[],name:"getDisabledMode",outputs:[{internalType:"bytes4",name:"disabled",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"bytes4",name:"_selector",type:"bytes4"}],name:"getExecution",outputs:[{components:[{internalType:"ValidAfter",name:"validAfter",type:"uint48"},{internalType:"ValidUntil",name:"validUntil",type:"uint48"},{internalType:"address",name:"executor",type:"address"},{internalType:"contract IKernelValidator",name:"validator",type:"address"}],internalType:"struct ExecutionDetail",name:"",type:"tuple"}],stateMutability:"view",type:"function"},{inputs:[],name:"getLastDisabledTime",outputs:[{internalType:"uint48",name:"",type:"uint48"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint192",name:"key",type:"uint192"}],name:"getNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"getNonce",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"initialize",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes32",name:"hash",type:"bytes32"},{internalType:"bytes",name:"signature",type:"bytes"}],name:"isValidSignature",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"view",type:"function"},{inputs:[],name:"name",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"uint256[]",name:"",type:"uint256[]"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155BatchReceived",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC1155Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"address",name:"",type:"address"},{internalType:"address",name:"",type:"address"},{internalType:"uint256",name:"",type:"uint256"},{internalType:"bytes",name:"",type:"bytes"}],name:"onERC721Received",outputs:[{internalType:"bytes4",name:"",type:"bytes4"}],stateMutability:"pure",type:"function"},{inputs:[{internalType:"contract IKernelValidator",name:"_defaultValidator",type:"address"},{internalType:"bytes",name:"_data",type:"bytes"}],name:"setDefaultValidator",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"bytes4",name:"_selector",type:"bytes4"},{internalType:"address",name:"_executor",type:"address"},{internalType:"contract IKernelValidator",name:"_validator",type:"address"},{internalType:"ValidUntil",name:"_validUntil",type:"uint48"},{internalType:"ValidAfter",name:"_validAfter",type:"uint48"},{internalType:"bytes",name:"_enableData",type:"bytes"}],name:"setExecution",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{internalType:"address",name:"_newImplementation",type:"address"}],name:"upgradeTo",outputs:[],stateMutability:"payable",type:"function"},{inputs:[{components:[{internalType:"address",name:"sender",type:"address"},{internalType:"uint256",name:"nonce",type:"uint256"},{internalType:"bytes",name:"initCode",type:"bytes"},{internalType:"bytes",name:"callData",type:"bytes"},{internalType:"uint256",name:"callGasLimit",type:"uint256"},{internalType:"uint256",name:"verificationGasLimit",type:"uint256"},{internalType:"uint256",name:"preVerificationGas",type:"uint256"},{internalType:"uint256",name:"maxFeePerGas",type:"uint256"},{internalType:"uint256",name:"maxPriorityFeePerGas",type:"uint256"},{internalType:"bytes",name:"paymasterAndData",type:"bytes"},{internalType:"bytes",name:"signature",type:"bytes"}],internalType:"struct UserOperation",name:"_userOp",type:"tuple"},{internalType:"bytes32",name:"userOpHash",type:"bytes32"},{internalType:"uint256",name:"missingAccountFunds",type:"uint256"}],name:"validateUserOp",outputs:[{internalType:"ValidationData",name:"validationData",type:"uint256"}],stateMutability:"payable",type:"function"},{inputs:[],name:"version",outputs:[{internalType:"string",name:"",type:"string"}],stateMutability:"view",type:"function"},{stateMutability:"payable",type:"receive"}],Rr=e=>B({abi:Pt,functionName:"executeBatch",args:[e.map(t=>({to:t.to,value:t.value||0n,data:t.data||"0x"}))]}),ba=e=>B({abi:Pt,functionName:"executeDelegateCall",args:[e.to,e.data||"0x"]}),Gr=e=>B({abi:Pt,functionName:"execute",args:[e.to,e.value||0n,e.data||"0x",0]}),Lr=async(e,t)=>{if(e.length>1){if(t==="delegatecall")throw new Error("Cannot batch delegatecall");return Rr(e)}const a=e.length===0?void 0:e[0];if(!a)throw new Error("No calls to encode");if(!t||t==="call")return Gr(a);if(t==="delegatecall")return ba({to:a.to,data:a.data});throw new Error("Invalid call type")},Cr=async({accountAddress:e,enableData:t,executor:a,selector:n,validAfter:r,validUntil:p,validator:i})=>Lr([{to:e,value:0n,data:B({abi:fa,functionName:"setExecution",args:[n,a,i,p,r,t]})}],"call");var se;(function(e){e.sudo="0x00000000",e.plugin="0x00000001",e.enable="0x00000002"})(se||(se={}));const gs=[{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"}],Ke=[{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"}],de=[{type:"constructor",inputs:[{name:"_entrypoint",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"nonpayable"},{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"accountId",inputs:[],outputs:[{name:"accountImplementationId",type:"string",internalType:"string"}],stateMutability:"pure"},{type:"function",name:"currentNonce",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"entrypoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"view"},{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executorConfig",inputs:[{name:"executor",type:"address",internalType:"contract IExecutor"}],outputs:[{name:"",type:"tuple",internalType:"struct ExecutorManager.ExecutorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"installModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"initData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"installValidations",inputs:[{name:"vIds",type:"bytes21[]",internalType:"ValidationId[]"},{name:"configs",type:"tuple[]",internalType:"struct ValidationManager.ValidationConfig[]",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]},{name:"validationData",type:"bytes[]",internalType:"bytes[]"},{name:"hookData",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"payable"},{type:"function",name:"invalidateNonce",inputs:[{name:"nonce",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"isAllowedSelector",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isModuleInstalled",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"additionalContext",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"permissionConfig",inputs:[{name:"pId",type:"bytes4",internalType:"PermissionId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.PermissionConfig",components:[{name:"permissionFlag",type:"bytes2",internalType:"PassFlag"},{name:"signer",type:"address",internalType:"contract ISigner"},{name:"policyData",type:"bytes22[]",internalType:"PolicyData[]"}]}],stateMutability:"view"},{type:"function",name:"rootValidator",inputs:[],outputs:[{name:"",type:"bytes21",internalType:"ValidationId"}],stateMutability:"view"},{type:"function",name:"selectorConfig",inputs:[{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"tuple",internalType:"struct SelectorManager.SelectorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"},{name:"target",type:"address",internalType:"address"},{name:"callType",type:"bytes1",internalType:"CallType"}]}],stateMutability:"view"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ExecMode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"supportsModule",inputs:[{name:"moduleTypeId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"uninstallModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"deInitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"uninstallValidation",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"deinitData",type:"bytes",internalType:"bytes"},{name:"hookDeinitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"upgradeTo",inputs:[{name:"_newImplementation",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"validNonceFrom",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"ValidationData"}],stateMutability:"payable"},{type:"function",name:"validationConfig",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.ValidationConfig",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"event",name:"ModuleInstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"ModuleUninstallResult",inputs:[{name:"module",type:"address",indexed:!1,internalType:"address"},{name:"result",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"ModuleUninstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"NonceInvalidated",inputs:[{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionInstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionUninstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"}],anonymous:!1},{type:"event",name:"Received",inputs:[{name:"sender",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"RootValidatorUpdated",inputs:[{name:"rootValidator",type:"bytes21",indexed:!1,internalType:"ValidationId"}],anonymous:!1},{type:"event",name:"SelectorSet",inputs:[{name:"selector",type:"bytes4",indexed:!1,internalType:"bytes4"},{name:"vId",type:"bytes21",indexed:!1,internalType:"ValidationId"},{name:"allowed",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"TryExecuteUnsuccessful",inputs:[{name:"batchExecutionindex",type:"uint256",indexed:!1,internalType:"uint256"},{name:"result",type:"bytes",indexed:!1,internalType:"bytes"}],anonymous:!1},{type:"event",name:"Upgraded",inputs:[{name:"implementation",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"ValidatorInstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"ValidatorUninstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"}],anonymous:!1},{type:"error",name:"EnableNotApproved",inputs:[]},{type:"error",name:"ExecutionReverted",inputs:[]},{type:"error",name:"InvalidCallType",inputs:[]},{type:"error",name:"InvalidCaller",inputs:[]},{type:"error",name:"InvalidExecutor",inputs:[]},{type:"error",name:"InvalidFallback",inputs:[]},{type:"error",name:"InvalidMode",inputs:[]},{type:"error",name:"InvalidModuleType",inputs:[]},{type:"error",name:"InvalidNonce",inputs:[]},{type:"error",name:"InvalidSelector",inputs:[]},{type:"error",name:"InvalidSignature",inputs:[]},{type:"error",name:"InvalidValidationType",inputs:[]},{type:"error",name:"InvalidValidator",inputs:[]},{type:"error",name:"NonceInvalidationError",inputs:[]},{type:"error",name:"NotSupportedCallType",inputs:[]},{type:"error",name:"OnlyExecuteUserOp",inputs:[]},{type:"error",name:"PermissionDataLengthMismatch",inputs:[]},{type:"error",name:"PermissionNotAlllowedForSignature",inputs:[]},{type:"error",name:"PermissionNotAlllowedForUserOp",inputs:[]},{type:"error",name:"PolicyDataTooLarge",inputs:[]},{type:"error",name:"PolicyFailed",inputs:[{name:"i",type:"uint256",internalType:"uint256"}]},{type:"error",name:"PolicySignatureOrderError",inputs:[]},{type:"error",name:"RootValidatorCannotBeRemoved",inputs:[]},{type:"error",name:"SignerPrefixNotPresent",inputs:[]}],Xt=async(e,t)=>{try{const a=await $(e,ue,"readContract")({abi:de,address:t,functionName:"currentNonce",args:[]});return a===0?1:a}catch{return 1}},Wt=[{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"data",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"magicValue",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"}],Yt=async(e,t,a,n)=>{try{const r=await e.request({method:"eth_call",params:[{to:t,data:B({abi:Wt,functionName:"eip712Domain"})},"latest"]});if(r!=="0x"){const p=Wa({abi:[...Wt],functionName:"eip712Domain",data:r});return{name:p[1],version:p[2],chainId:p[3]}}}catch{}return{name:rn,version:a==="0.3.0"?"0.3.0-beta":a,chainId:BigInt(n??(e.chain?e.chain.id:await e.extend(Ya).getChainId()))}},qt=e=>{if(e==="0.6")return We(Ye({abi:fa,name:"execute"}));if(e==="0.7")return We(Ye({abi:de,name:"execute"}));throw new Error("Unsupported entry point version")},Sr=async({accountAddress:e,enableSignature:t,action:a,validator:n,validUntil:r,validAfter:p})=>{const i=await n.getEnableData(e),u=i.length/2-1;return z([se.enable,M(J(r,{size:6}),{size:6}),M(J(p),{size:6}),M(n.address,{size:20}),M(a.address,{size:20}),M(J(u),{size:32}),i,M(J(t.length/2-1),{size:32}),t])},Nr=async({accountAddress:e,chainId:t,kernelVersion:a,action:n,validator:r,validUntil:p,validAfter:i})=>({domain:{name:"Kernel",version:a,chainId:t,verifyingContract:e},types:{ValidatorApproved:[{name:"sig",type:"bytes4"},{name:"validatorData",type:"uint256"},{name:"executor",type:"address"},{name:"enableData",type:"bytes"}]},message:{sig:n.selector,validatorData:me(Y([M(J(p??0),{size:6}),M(J(i??0),{size:6}),r.address]),{size:32}),executor:n.address,enableData:await r.getEnableData(e)},primaryType:"ValidatorApproved"}),Mr=async({enableSignature:e,userOpSignature:t,action:a,enableData:n,hook:r})=>{var p;return z([(r==null?void 0:r.getIdentifier())??ae,ee(qe("bytes validatorData, bytes hookData, bytes selectorData, bytes enableSig, bytes userOpSig"),[n,await(r==null?void 0:r.getEnableData())??"0x",z([a.selector,a.address,((p=a.hook)==null?void 0:p.address)??ae,ee(qe("bytes selectorInitData, bytes hookInitData"),[ye.DELEGATE_CALL,"0x0000"])]),e,t])])},Zt=async({accountAddress:e,chainId:t,kernelVersion:a,action:n,hook:r,validator:p,validatorNonce:i})=>{var u;return{domain:{name:"Kernel",version:a==="0.3.0"?"0.3.0-beta":a,chainId:t,verifyingContract:e},types:{Enable:[{name:"validationId",type:"bytes21"},{name:"nonce",type:"uint32"},{name:"hook",type:"address"},{name:"validatorData",type:"bytes"},{name:"hookData",type:"bytes"},{name:"selectorData",type:"bytes"}]},message:{validationId:z([H[p.validatorType],M(p.getIdentifier(),{size:20,dir:"right"})]),nonce:i,hook:(r==null?void 0:r.getIdentifier())??ae,validatorData:await p.getEnableData(e),hookData:await(r==null?void 0:r.getEnableData(e))??"0x",selectorData:z([n.selector,n.address,((u=n.hook)==null?void 0:u.address)??ae,ee(qe("bytes selectorInitData, bytes hookInitData"),[ye.DELEGATE_CALL,"0x0000"])])},primaryType:"Enable"}},$r=async(e,t,a)=>{try{return await $(e,ue,"readContract")({abi:Or,address:a,functionName:"isInitialized",args:[t]})}catch{}return!1};function hs(e){return(e==null?void 0:e.getPluginEnableSignature)!==void 0}async function Ts(e,{sudo:t,regular:a,hook:n,pluginEnableSignature:r,validatorInitData:p,action:i,validAfter:u=0,validUntil:s=0,entryPoint:y,kernelVersion:o,chainId:m,isPreInstalled:v=!1}){var F;if(t&&!ie.satisfies(o,t==null?void 0:t.supportedKernelVersions)||a&&!ie.satisfies(o,a==null?void 0:a.supportedKernelVersions))throw new Error("Either sudo or/and regular validator version mismatch. Update to latest plugin package and use the proper plugin version");let A=v;const d=a||t;if(!d)throw new Error("One of `sudo` or `regular` validator must be set");if(i={selector:(i==null?void 0:i.selector)??qt(y.version),address:(i==null?void 0:i.address)??ae},y.version==="0.7"&&(i.address.toLowerCase()!==ae.toLowerCase()||i.selector.toLowerCase()!==qt(y.version).toLowerCase())&&o==="0.3.0"&&(i.hook={address:((F=i.hook)==null?void 0:F.address)??sn}),!i)throw new Error("Action data must be set");const l=async(T,S,V="0x")=>{if(!i)throw new Error("Action data must be set");if(y.version==="0.6")if(a){if(A||await b(T,S))return se.plugin;const _=await P(T);if(!_)throw new Error("Enable signature not set");return Sr({accountAddress:T,enableSignature:_,action:i,validator:a,validUntil:s,validAfter:u})}else{if(t)return se.sudo;throw new Error("One of `sudo` or `regular` validator must be set")}if(a){if(A||await b(T,i.selector))return V;const _=await P(T);return Mr({enableSignature:_,userOpSignature:V,action:i,enableData:await a.getEnableData(T),hook:n})}else{if(t)return V;throw new Error("One of `sudo` or `regular` validator must be set")}},b=async(T,S,V)=>{const _=!!V,x=V??a;if(v&&!_)return!0;if(!i)throw new Error("Action data must be set");if(!x)throw new Error("regular validator not set");if(y.version==="0.6")return x.isEnabled(T,S);const G=await x.isEnabled(T,i.selector)||await $r(e,T,x.address);return G&&!_&&(A=!0),G},P=async(T,S)=>{var be;const V=!!S,_=S??a;if(!i)throw new Error("Action data must be set");if(r&&!V)return r;if(!t)throw new Error("sudo validator not set -- need it to enable the validator");if(!_)throw new Error("regular validator not set");const{version:x}=await Yt(e,T,o);m||(m=((be=e.chain)==null?void 0:be.id)??await Ie(e));let G;if(y.version==="0.6"){const f=await Nr({accountAddress:T,chainId:m,kernelVersion:x??o,action:i,validator:_,validUntil:s,validAfter:u});return G=await t.signTypedData(f),V||(r=G),G}const X=await Xt(e,T),Fe=await Zt({accountAddress:T,chainId:m,kernelVersion:x,action:i,hook:n,validator:_,validatorNonce:X});return G=await t.signTypedData(Fe),V||(r=G),G},L=(T=!1)=>{const S=(T?t:a)??d;return z([H[S.validatorType],S.getIdentifier()])};return{sudoValidator:t,regularValidator:a,activeValidatorMode:t&&!a?"sudo":"regular",...d,hook:n,getIdentifier:L,encodeModuleInstallCallData:async T=>{if(!i)throw new Error("Action data must be set");if(!a)throw new Error("regular validator not set");if(y.version==="0.6")return await Cr({accountAddress:T,selector:i.selector,executor:i.address,validator:a==null?void 0:a.address,validUntil:s,validAfter:u,enableData:await a.getEnableData(T)});throw new Error("EntryPoint v0.7 not supported yet")},signUserOperation:async T=>{const S=await d.signUserOperation(T);return y.version==="0.6"?Y([await l(T.sender,T.callData.toString().slice(0,10)),S]):await l(T.sender,T.callData.toString().slice(0,10),S)},getAction:()=>{if(!i)throw new Error("Action data must be set");return i},getValidityData:()=>({validAfter:u,validUntil:s}),getStubSignature:async T=>{const S=await d.getStubSignature(T);return y.version==="0.6"?Y([await l(T.sender,T.callData.toString().slice(0,10)),S]):await l(T.sender,T.callData.toString().slice(0,10),S)},getNonceKey:async(T=ae,S=0n)=>{if(!i)throw new Error("Action data must be set");if(y.version==="0.6"){if(S>qa)throw new Error("Custom nonce key must be equal or less than maxUint192 for 0.6");return await d.getNonceKey(T,S)}if(S>Za)throw new Error("Custom nonce key must be equal or less than 2 bytes(maxUint16) for v0.7");const V=!a||await b(T,i.selector)?Mt.DEFAULT:Mt.ENABLE,_=a?H[a.validatorType]:H.SUDO,x=M(Y([V,_,M(d.getIdentifier(),{size:20,dir:"right"}),M(J(await d.getNonceKey(T,S)),{size:2})]),{size:24});return BigInt(x)},isPluginEnabled:b,getPluginEnableSignature:P,getPluginsEnableTypedData:async(T,S)=>{var X;const V=S??a;if(!i)throw new Error("Action data must be set");if(!t)throw new Error("sudo validator not set -- need it to enable the validator");if(!V)throw new Error("regular validator not set");const{version:_}=await Yt(e,T,o),x=await Xt(e,T);return m||(m=((X=e.chain)==null?void 0:X.id)??await Ie(e)),await Zt({accountAddress:T,chainId:m,kernelVersion:_,action:i,validator:V,validatorNonce:x})},getValidatorInitData:async()=>p||{validatorAddress:(t==null?void 0:t.address)??d.address,enableData:await(t==null?void 0:t.getEnableData())??await d.getEnableData(),identifier:M(L(!0),{size:21,dir:"right"})},signUserOperationWithActiveValidator:async T=>d.signUserOperation(T)}}const Es=[{type:"constructor",inputs:[{name:"_owner",type:"address",internalType:"address"}],stateMutability:"nonpayable"},{type:"function",name:"approveFactory",inputs:[{name:"factory",type:"address",internalType:"contract KernelFactory"},{name:"approval",type:"bool",internalType:"bool"}],outputs:[],stateMutability:"payable"},{type:"function",name:"approved",inputs:[{name:"",type:"address",internalType:"contract KernelFactory"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"cancelOwnershipHandover",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"completeOwnershipHandover",inputs:[{name:"pendingOwner",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"deployWithFactory",inputs:[{name:"factory",type:"address",internalType:"contract KernelFactory"},{name:"createData",type:"bytes",internalType:"bytes"},{name:"salt",type:"bytes32",internalType:"bytes32"}],outputs:[{name:"",type:"address",internalType:"address"}],stateMutability:"payable"},{type:"function",name:"owner",inputs:[],outputs:[{name:"result",type:"address",internalType:"address"}],stateMutability:"view"},{type:"function",name:"ownershipHandoverExpiresAt",inputs:[{name:"pendingOwner",type:"address",internalType:"address"}],outputs:[{name:"result",type:"uint256",internalType:"uint256"}],stateMutability:"view"},{type:"function",name:"renounceOwnership",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"requestOwnershipHandover",inputs:[],outputs:[],stateMutability:"payable"},{type:"function",name:"stake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"},{name:"unstakeDelay",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"transferOwnership",inputs:[{name:"newOwner",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"unlockStake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"}],outputs:[],stateMutability:"payable"},{type:"function",name:"withdrawStake",inputs:[{name:"entryPoint",type:"address",internalType:"contract IEntryPoint"},{name:"recipient",type:"address",internalType:"address payable"}],outputs:[],stateMutability:"payable"},{type:"event",name:"OwnershipHandoverCanceled",inputs:[{name:"pendingOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"OwnershipHandoverRequested",inputs:[{name:"pendingOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"OwnershipTransferred",inputs:[{name:"oldOwner",type:"address",indexed:!0,internalType:"address"},{name:"newOwner",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"error",name:"AlreadyInitialized",inputs:[]},{type:"error",name:"NewOwnerIsZeroAddress",inputs:[]},{type:"error",name:"NoHandoverRequest",inputs:[]},{type:"error",name:"NotApprovedFactory",inputs:[]},{type:"error",name:"Unauthorized",inputs:[]}],Jt=[{type:"constructor",inputs:[{name:"_entrypoint",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"nonpayable"},{type:"fallback",stateMutability:"payable"},{type:"receive",stateMutability:"payable"},{type:"function",name:"accountId",inputs:[],outputs:[{name:"accountImplementationId",type:"string",internalType:"string"}],stateMutability:"pure"},{type:"function",name:"changeRootValidator",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"currentNonce",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"eip712Domain",inputs:[],outputs:[{name:"fields",type:"bytes1",internalType:"bytes1"},{name:"name",type:"string",internalType:"string"},{name:"version",type:"string",internalType:"string"},{name:"chainId",type:"uint256",internalType:"uint256"},{name:"verifyingContract",type:"address",internalType:"address"},{name:"salt",type:"bytes32",internalType:"bytes32"},{name:"extensions",type:"uint256[]",internalType:"uint256[]"}],stateMutability:"view"},{type:"function",name:"entrypoint",inputs:[],outputs:[{name:"",type:"address",internalType:"contract IEntryPoint"}],stateMutability:"view"},{type:"function",name:"execute",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executeFromExecutor",inputs:[{name:"execMode",type:"bytes32",internalType:"ExecMode"},{name:"executionCalldata",type:"bytes",internalType:"bytes"}],outputs:[{name:"returnData",type:"bytes[]",internalType:"bytes[]"}],stateMutability:"payable"},{type:"function",name:"executeUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"executorConfig",inputs:[{name:"executor",type:"address",internalType:"contract IExecutor"}],outputs:[{name:"",type:"tuple",internalType:"struct ExecutorManager.ExecutorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"function",name:"initialize",inputs:[{name:"_rootValidator",type:"bytes21",internalType:"ValidationId"},{name:"hook",type:"address",internalType:"contract IHook"},{name:"validatorData",type:"bytes",internalType:"bytes"},{name:"hookData",type:"bytes",internalType:"bytes"},{name:"initConfig",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"nonpayable"},{type:"function",name:"installModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"initData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"installValidations",inputs:[{name:"vIds",type:"bytes21[]",internalType:"ValidationId[]"},{name:"configs",type:"tuple[]",internalType:"struct ValidationManager.ValidationConfig[]",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]},{name:"validationData",type:"bytes[]",internalType:"bytes[]"},{name:"hookData",type:"bytes[]",internalType:"bytes[]"}],outputs:[],stateMutability:"payable"},{type:"function",name:"invalidateNonce",inputs:[{name:"nonce",type:"uint32",internalType:"uint32"}],outputs:[],stateMutability:"payable"},{type:"function",name:"isAllowedSelector",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isModuleInstalled",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"additionalContext",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"view"},{type:"function",name:"isValidSignature",inputs:[{name:"hash",type:"bytes32",internalType:"bytes32"},{name:"signature",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"view"},{type:"function",name:"onERC1155BatchReceived",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"uint256[]",internalType:"uint256[]"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"onERC1155Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"onERC721Received",inputs:[{name:"",type:"address",internalType:"address"},{name:"",type:"address",internalType:"address"},{name:"",type:"uint256",internalType:"uint256"},{name:"",type:"bytes",internalType:"bytes"}],outputs:[{name:"",type:"bytes4",internalType:"bytes4"}],stateMutability:"pure"},{type:"function",name:"permissionConfig",inputs:[{name:"pId",type:"bytes4",internalType:"PermissionId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.PermissionConfig",components:[{name:"permissionFlag",type:"bytes2",internalType:"PassFlag"},{name:"signer",type:"address",internalType:"contract ISigner"},{name:"policyData",type:"bytes22[]",internalType:"PolicyData[]"}]}],stateMutability:"view"},{type:"function",name:"rootValidator",inputs:[],outputs:[{name:"",type:"bytes21",internalType:"ValidationId"}],stateMutability:"view"},{type:"function",name:"selectorConfig",inputs:[{name:"selector",type:"bytes4",internalType:"bytes4"}],outputs:[{name:"",type:"tuple",internalType:"struct SelectorManager.SelectorConfig",components:[{name:"hook",type:"address",internalType:"contract IHook"},{name:"target",type:"address",internalType:"address"},{name:"callType",type:"bytes1",internalType:"CallType"}]}],stateMutability:"view"},{type:"function",name:"supportsExecutionMode",inputs:[{name:"mode",type:"bytes32",internalType:"ExecMode"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"supportsModule",inputs:[{name:"moduleTypeId",type:"uint256",internalType:"uint256"}],outputs:[{name:"",type:"bool",internalType:"bool"}],stateMutability:"pure"},{type:"function",name:"uninstallModule",inputs:[{name:"moduleType",type:"uint256",internalType:"uint256"},{name:"module",type:"address",internalType:"address"},{name:"deInitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"uninstallValidation",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"},{name:"deinitData",type:"bytes",internalType:"bytes"},{name:"hookDeinitData",type:"bytes",internalType:"bytes"}],outputs:[],stateMutability:"payable"},{type:"function",name:"upgradeTo",inputs:[{name:"_newImplementation",type:"address",internalType:"address"}],outputs:[],stateMutability:"payable"},{type:"function",name:"validNonceFrom",inputs:[],outputs:[{name:"",type:"uint32",internalType:"uint32"}],stateMutability:"view"},{type:"function",name:"validateUserOp",inputs:[{name:"userOp",type:"tuple",internalType:"struct PackedUserOperation",components:[{name:"sender",type:"address",internalType:"address"},{name:"nonce",type:"uint256",internalType:"uint256"},{name:"initCode",type:"bytes",internalType:"bytes"},{name:"callData",type:"bytes",internalType:"bytes"},{name:"accountGasLimits",type:"bytes32",internalType:"bytes32"},{name:"preVerificationGas",type:"uint256",internalType:"uint256"},{name:"gasFees",type:"bytes32",internalType:"bytes32"},{name:"paymasterAndData",type:"bytes",internalType:"bytes"},{name:"signature",type:"bytes",internalType:"bytes"}]},{name:"userOpHash",type:"bytes32",internalType:"bytes32"},{name:"missingAccountFunds",type:"uint256",internalType:"uint256"}],outputs:[{name:"validationData",type:"uint256",internalType:"ValidationData"}],stateMutability:"payable"},{type:"function",name:"validationConfig",inputs:[{name:"vId",type:"bytes21",internalType:"ValidationId"}],outputs:[{name:"",type:"tuple",internalType:"struct ValidationManager.ValidationConfig",components:[{name:"nonce",type:"uint32",internalType:"uint32"},{name:"hook",type:"address",internalType:"contract IHook"}]}],stateMutability:"view"},{type:"event",name:"ModuleInstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"ModuleUninstallResult",inputs:[{name:"module",type:"address",indexed:!1,internalType:"address"},{name:"result",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"ModuleUninstalled",inputs:[{name:"moduleTypeId",type:"uint256",indexed:!1,internalType:"uint256"},{name:"module",type:"address",indexed:!1,internalType:"address"}],anonymous:!1},{type:"event",name:"NonceInvalidated",inputs:[{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionInstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"PermissionUninstalled",inputs:[{name:"permission",type:"bytes4",indexed:!1,internalType:"PermissionId"}],anonymous:!1},{type:"event",name:"Received",inputs:[{name:"sender",type:"address",indexed:!1,internalType:"address"},{name:"amount",type:"uint256",indexed:!1,internalType:"uint256"}],anonymous:!1},{type:"event",name:"RootValidatorUpdated",inputs:[{name:"rootValidator",type:"bytes21",indexed:!1,internalType:"ValidationId"}],anonymous:!1},{type:"event",name:"SelectorSet",inputs:[{name:"selector",type:"bytes4",indexed:!1,internalType:"bytes4"},{name:"vId",type:"bytes21",indexed:!1,internalType:"ValidationId"},{name:"allowed",type:"bool",indexed:!1,internalType:"bool"}],anonymous:!1},{type:"event",name:"TryExecuteUnsuccessful",inputs:[{name:"batchExecutionindex",type:"uint256",indexed:!1,internalType:"uint256"},{name:"result",type:"bytes",indexed:!1,internalType:"bytes"}],anonymous:!1},{type:"event",name:"Upgraded",inputs:[{name:"implementation",type:"address",indexed:!0,internalType:"address"}],anonymous:!1},{type:"event",name:"ValidatorInstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"},{name:"nonce",type:"uint32",indexed:!1,internalType:"uint32"}],anonymous:!1},{type:"event",name:"ValidatorUninstalled",inputs:[{name:"validator",type:"address",indexed:!1,internalType:"contract IValidator"}],anonymous:!1},{type:"error",name:"EnableNotApproved",inputs:[]},{type:"error",name:"ExecutionReverted",inputs:[]},{type:"error",name:"InitConfigError",inputs:[{name:"idx",type:"uint256",internalType:"uint256"}]},{type:"error",name:"InvalidCallType",inputs:[]},{type:"error",name:"InvalidCaller",inputs:[]},{type:"error",name:"InvalidExecutor",inputs:[]},{type:"error",name:"InvalidFallback",inputs:[]},{type:"error",name:"InvalidMode",inputs:[]},{type:"error",name:"InvalidModuleType",inputs:[]},{type:"error",name:"InvalidNonce",inputs:[]},{type:"error",name:"InvalidSelector",inputs:[]},{type:"error",name:"InvalidSignature",inputs:[]},{type:"error",name:"InvalidValidationType",inputs:[]},{type:"error",name:"InvalidValidator",inputs:[]},{type:"error",name:"NonceInvalidationError",inputs:[]},{type:"error",name:"NotSupportedCallType",inputs:[]},{type:"error",name:"OnlyExecuteUserOp",inputs:[]},{type:"error",name:"PermissionDataLengthMismatch",inputs:[]},{type:"error",name:"PermissionNotAlllowedForSignature",inputs:[]},{type:"error",name:"PermissionNotAlllowedForUserOp",inputs:[]},{type:"error",name:"PolicyDataTooLarge",inputs:[]},{type:"error",name:"PolicyFailed",inputs:[{name:"i",type:"uint256",internalType:"uint256"}]},{type:"error",name:"PolicySignatureOrderError",inputs:[]},{type:"error",name:"RootValidatorCannotBeRemoved",inputs:[]},{type:"error",name:"SignerPrefixNotPresent",inputs:[]}],Ur=ea(["function performCreate(uint256 value, bytes memory deploymentData) public returns (address newContract)","function performCreate2(uint256 value, bytes memory deploymentData, bytes32 salt) public returns (address newContract)"]),ga=e=>B({abi:Ur,functionName:"performCreate",args:e}),ws=e=>{const t={to:aa,data:ga([0n,ta(e)])};return ba(t)},At=(e,t,a=!1)=>{let n;"calldata"in e?n=e.calldata:n=Y([e.to,t.callType!==ye.DELEGATE_CALL?J(e.value||0n,{size:32}):"0x",e.data||"0x"]);const r=We(Ye({abi:Ke,name:"executeUserOp"}));return a?Y([r,B({abi:Ke,functionName:"execute",args:[Kt(t),n]})]):B({abi:Ke,functionName:"execute",args:[Kt(t),n]})},Fr=(e,t,a)=>{const n=ee([{name:"executionBatch",type:"tuple[]",components:[{name:"target",type:"address"},{name:"value",type:"uint256"},{name:"callData",type:"bytes"}]}],[e.map(r=>({target:r.to,value:r.value||0n,callData:r.data||"0x"}))]);return At({calldata:n},{callType:ye.BATCH,execType:t.execType},a)},ha=(e,t,a)=>At(e,{callType:ye.DELEGATE_CALL,execType:t.execType},a),Vr=(e,t,a)=>At(e,{callType:ye.SINGLE,execType:t.execType},a),vs=async(e,t,a,n=na.DEFAULT)=>{if(e.length>1){if(t==="delegatecall")throw new Error("Cannot batch delegatecall");return Fr(e,{execType:n},a)}const r=e.length===0?void 0:e[0];if(!r)throw new Error("No calls to encode");if(!t||t==="call")return Vr(r,{execType:n},a);if(t==="delegatecall")return ha({to:r.to,data:r.data},{execType:n},a);throw new Error("Invalid call type")},Is=e=>{const t={to:aa,data:ga([0n,ta(e)])};return ha(t,{execType:na.DEFAULT})},_r=e=>W(ee([{type:"bytes32"},{type:"bytes32"}],[W(Ja("Kernel(bytes32 hash)")),e])),xs=async(e,t,a)=>{const{name:n,version:r,chainId:p,verifyingContract:i}=t;if(!je(Q.ERC1271_SIG_WRAPPER,r))return e;const u=je(Q.ERC1271_REPLAYABLE,r)&&a?0:p,s=Qa({domain:{name:n,version:r,chainId:u,verifyingContract:i}});let y=e;return je(Q.ERC1271_SIG_WRAPPER_WITH_WRAPPED_HASH,r)&&(y=_r(y)),W(Y(["0x1901",s,y]))},Os=(e,t)=>{const a=B({abi:Pr,functionName:"installModule",args:[t.type,t.address,t.data]});return{to:e,data:a}},kr=async(e,t)=>{var o;const{userOperation:{chainId:a,entryPointAddress:n,context:r,calls:p,account:i,...u}}=t,s=await e.request({method:"zd_sponsorUserOperation",params:[{chainId:(o=e.chain)==null?void 0:o.id,userOp:Se(u),entryPointAddress:n,gasTokenData:t.gasToken&&{tokenAddress:t.gasToken},shouldOverrideFee:t.shouldOverrideFee??!1,shouldConsume:t.shouldConsume??!0}]});if(en(n,ra))return{paymasterAndData:s.paymasterAndData,preVerificationGas:BigInt(s.preVerificationGas),verificationGasLimit:BigInt(s.verificationGasLimit),callGasLimit:BigInt(s.callGasLimit),maxFeePerGas:s.maxFeePerGas?BigInt(s.maxFeePerGas):t.userOperation.maxFeePerGas,maxPriorityFeePerGas:s.maxPriorityFeePerGas?BigInt(s.maxPriorityFeePerGas):t.userOperation.maxPriorityFeePerGas};const y=s;return{callGasLimit:BigInt(y.callGasLimit),verificationGasLimit:BigInt(y.verificationGasLimit),preVerificationGas:BigInt(y.preVerificationGas),paymaster:y.paymaster,paymasterVerificationGasLimit:BigInt(y.paymasterVerificationGasLimit),paymasterPostOpGasLimit:BigInt(y.paymasterPostOpGasLimit),paymasterData:y.paymasterData,maxFeePerGas:s.maxFeePerGas?BigInt(s.maxFeePerGas):t.userOperation.maxFeePerGas,maxPriorityFeePerGas:s.maxPriorityFeePerGas?BigInt(s.maxPriorityFeePerGas):t.userOperation.maxPriorityFeePerGas}};function Br(e,t){Dr(e.entryPoint.version,t);const a=sa[t].accountImplementationAddress;return{to:e.address,data:B({abi:de,functionName:"upgradeTo",args:[a]}),value:0n}}class te extends I{constructor({docsPath:t}={}){super(["Could not find an Account to execute with this Action.","Please provide an Account with the `account` argument on the Action, or by supplying an `account` to the Client."].join(`
`),{docsPath:t,docsSlug:"account",name:"AccountNotFoundError"})}}class Ps extends I{constructor(){super("Smart account signer doesn't need to sign transactions",{name:"SignTransactionNotSupportedError"})}}async function Hr(e,t){const{account:a=e.account,kernelVersion:n}=t;if(!a)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const r=K(a),p=Br(r,n);return await $(e,ne,"sendUserOperation")({...t,calls:[p],account:r})}async function zr(e,t){const{sudoValidator:a,hook:n,...r}=t,p=r.account??e.account;if(!p)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const i=K(p);let u;if([H.PERMISSION,H.SECONDARY,H.EIP7702].includes(H[a.validatorType]))u=Y([H[a.validatorType],M(a.getIdentifier(),{size:20,dir:"right"})]);else throw new Error(`Cannot change sudo validator to type ${a.validatorType}`);const s=await a.getEnableData(i.address),y=(n==null?void 0:n.getIdentifier())??ae,o=await(n==null?void 0:n.getEnableData(i.address))??"0x";return i.kernelVersion===on?await $(e,ne,"sendUserOperation")({...r,callData:await i.encodeCalls([{to:sa[pn].accountImplementationAddress,value:0n,data:B({abi:Jt,functionName:"changeRootValidator",args:[u,y,s,o]})}],"delegatecall")}):await $(e,ne,"sendUserOperation")({...r,callData:await i.encodeCalls([{to:i.address,value:0n,data:B({abi:Jt,functionName:"changeRootValidator",args:[u,y,s,o]})}])})}async function jr(e,t){const{account:a=e.account,nonceToSet:n}=t;if(!a)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const r=K(a);return await $(e,ne,"sendUserOperation")({...t,calls:[{to:r.address,data:B({abi:de,functionName:"invalidateNonce",args:[n]}),value:0n}],account:r})}async function Kr(e,t){const{account:a=e.account,plugin:n,hook:r,...p}=t;if(!a)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const i=K(a);let u;if([H.PERMISSION,H.SECONDARY,H.EIP7702].includes(H[n.validatorType]))u=Y([H[n.validatorType],M(n.getIdentifier(),{size:20,dir:"right"})]);else throw new Error(`Cannot uninstall ${n.validatorType} plugin`);const s=await n.getEnableData(i.address),y=await(r==null?void 0:r.getEnableData(i.address))??"0x";return await $(e,ne,"sendUserOperation")({...p,calls:[{to:i.address,data:B({abi:de,functionName:"uninstallValidation",args:[u,s,y]}),value:0n}],account:i})}async function Xr(e,t){const{account:a=e.account}=t;if(!a)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const n=K(a),r=await $(e,pe,"prepareUserOperation")({...t,account:n});return r.signature=await n.signUserOperation(r),r}async function Wr(e){const t=e.account;if(!t)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const a=K(t);try{return await $(e,ue,"readContract")({abi:de,address:a.address,functionName:"currentNonce",args:[]})}catch{return 1}}const Ta=async e=>{const t=await e.request({method:"zd_getUserOperationGasPrice",params:[]});return{maxFeePerGas:BigInt(t.standard.maxFeePerGas),maxPriorityFeePerGas:BigInt(t.standard.maxPriorityFeePerGas)}};async function Ea(e,t){let a;if("to"in t){const{account:r=e.account,data:p,maxFeePerGas:i,maxPriorityFeePerGas:u,to:s,value:y,nonce:o}=t;if(!r)throw new te({docsPath:"/docs/actions/wallet/sendTransaction"});const m=K(r);if(!s)throw new Error("Missing to address");a=await $(e,ne,"sendUserOperation")({calls:[{to:s,value:y||BigInt(0),data:p||"0x"}],account:m,maxFeePerGas:i,maxPriorityFeePerGas:u,nonce:o?BigInt(o):void 0})}else a=await $(e,ne,"sendUserOperation")({...t});const n=await $(e,ma,"waitForUserOperationReceipt")({hash:a});return n==null?void 0:n.receipt.transactionHash}async function Yr(e,{account:t=e.account,message:a}){if(!t)throw new te({docsPath:"/docs/actions/wallet/signMessage"});return K(t).signMessage({message:a})}async function qr(e,{account:t=e.account,domain:a,message:n,primaryType:r,types:p}){if(!t)throw new te({docsPath:"/docs/actions/wallet/signMessage"});const i=K(t),u={EIP712Domain:tn({domain:a}),...p};return an({domain:a,message:n,primaryType:r,types:u}),i.signTypedData({domain:a,primaryType:r,types:u,message:n})}async function Zr(e,{abi:t,address:a,args:n,dataSuffix:r,functionName:p,...i}){const u=B({abi:t,args:n,functionName:p});return await $(e,Ea,"sendTransaction")({data:`${u}${r?r.replace("0x",""):""}`,to:a,...i})}const Jr=async(e,t)=>{var p;const a=await e.request({method:"stackup_getERC20TokenQuotes",params:[{chainId:(p=e.chain)==null?void 0:p.id,userOp:{...Se(t.userOperation),initCode:t.userOperation.initCode||"0x"},tokenAddress:t.gasTokenAddress,entryPointAddress:t.entryPoint??ra}]}),n={maxGasCostToken:a.maxGasCostToken,tokenDecimals:a.tokenDecimals};return{amount:Number(n.maxGasCostToken)/10**Number(n.tokenDecimals)}},As=()=>e=>({sponsorUserOperation:async t=>kr(e,{...t}),estimateGasInERC20:async t=>Jr(e,t)});function Qt(){return e=>({signUserOperation:t=>Xr(e,t),getUserOperationGasPrice:async()=>Ta(e),uninstallPlugin:async t=>Kr(e,t),changeSudoValidator:async t=>zr(e,t),invalidateNonce:async t=>jr(e,t),getKernelV3ModuleCurrentNonce:async()=>Wr(e),upgradeKernel:async t=>Hr(e,t),sendTransaction:t=>Ea(e,t),signMessage:t=>Yr(e,t),signTypedData:t=>qr(e,t),writeContract:t=>Zr(e,t)})}function Ds(e){var y,o;const{client:t,key:a="Account",name:n="Kernel Account Client",paymaster:r,paymasterContext:p,bundlerTransport:i,userOperation:u}=e,s=Object.assign(nn({...e,chain:e.chain??(t==null?void 0:t.chain),transport:i,key:a,name:n,type:"kernelAccountClient",pollingInterval:e.pollingInterval??1e3}),{client:t,paymaster:r,paymasterContext:p,userOperation:u});if((y=e.userOperation)!=null&&y.prepareUserOperation){const m=e.userOperation.prepareUserOperation;return s.extend(we).extend(v=>({prepareUserOperation:A=>m(v,A)})).extend(we).extend(v=>({prepareUserOperation:A=>m(v,A)})).extend(Qt())}return(o=s.userOperation)!=null&&o.estimateFeesPerGas||(s.userOperation={...s.userOperation,estimateFeesPerGas:async({bundlerClient:m})=>await Ta(m)}),s.extend(we).extend(m=>({prepareUserOperation:async v=>{var d,l,b;let A=v;if((d=m.account)!=null&&d.authorization){const P=v.authorization||await((b=(l=m.account)==null?void 0:l.eip7702Authorization)==null?void 0:b.call(l));A={...v,authorization:P}}return await pe(m,A)}})).extend(we).extend(m=>({prepareUserOperation:async v=>{var d,l,b;let A=v;if((d=m.account)!=null&&d.authorization){const P=v.authorization||await((b=(l=m.account)==null?void 0:l.eip7702Authorization)==null?void 0:b.call(l));A={...v,authorization:P}}return await pe(m,A)}})).extend(Qt())}export{Xr as $,Is as A,Yt as B,de as C,Ke as D,As as E,ms as F,qt as G,Ds as H,te as I,Wt as J,Es as K,jt as L,fa as M,zr as N,Se as O,cs as P,ds as Q,Mr as R,Ps as S,Kt as T,Xt as U,Zt as V,Br as W,Ta as X,jr as Y,$r as Z,Qt as _,gr as a,kr as a0,Kr as a1,Hr as a2,pe as a3,fs as b,os as c,Ts as d,ys as e,ss as f,hr as g,is as h,hs as i,ps as j,un as k,ls as l,bs as m,gs as n,Jt as o,us as p,xs as q,je as r,ie as s,ir as t,Q as u,Dr as v,Os as w,vs as x,Lr as y,ws as z};
